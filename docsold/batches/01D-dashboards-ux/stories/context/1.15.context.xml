<?xml version="1.0" encoding="UTF-8"?>
<story-context>
  <metadata>
    <story-id>1.15</story-id>
    <story-title>Settings Dashboard Landing Page</story-title>
    <epic>1 - Foundation &amp; Settings</epic>
    <batch>01D - Dashboards &amp; UX</batch>
    <status>In Progress</status>
    <priority>P0 (Blocker)</priority>
    <story-points>3</story-points>
    <estimated-hours>4-6</estimated-hours>
    <created-date>2025-11-22</created-date>
  </metadata>

  <goal>
    Create a Settings landing page (`/settings`) that provides a visual dashboard overview of all available settings sections, allowing users to easily discover and navigate to different configuration areas.
  </goal>

  <user-story>
    <as-a>system administrator</as-a>
    <i-want>a Settings dashboard that shows all available configuration options</i-want>
    <so-that>I can quickly understand what settings are available and navigate to the section I need</so-that>
  </user-story>

  <problem-statement>
    Currently, when users click "Settings" in the sidebar (`href="/settings"`), there is no landing page - only nested routes exist:
    - `/settings/organization`
    - `/settings/users`
    - `/settings/warehouses`
    - `/settings/locations`
    - `/settings/machines`
    - `/settings/production-lines`
    - `/settings/allergens`
    - `/settings/tax-codes`
    - `/settings/modules`
    - `/settings/wizard`

    This creates a poor UX where:
    1. Users get a 404 or blank page when clicking Settings
    2. Users don't know what settings are available
    3. Navigation requires knowing exact URLs
  </problem-statement>

  <acceptance-criteria>
    <criterion id="AC-015.1">
      <title>Settings Dashboard Page Structure</title>
      <given>I am logged in as any user</given>
      <when>I navigate to `/settings` or click "Settings" in sidebar</when>
      <then>I should see a Settings Dashboard page with:
        - Page title: "Settings"
        - Subtitle: "Configure your MonoPilot system"
        - Grid of setting cards/modules organized by category
      </then>
      <success-criteria>
        - Page loads successfully at `/settings` route
        - Consistent with main dashboard design pattern
        - Responsive layout (grid adapts to screen size)
      </success-criteria>
    </criterion>

    <criterion id="AC-015.2">
      <title>Settings Cards/Modules Display</title>
      <given>I am on the Settings Dashboard</given>
      <then>I should see cards for each settings section organized by category</then>
      <modules>
        <category name="Organization &amp; Users">
          <module>
            <name>Organization Settings</name>
            <icon>Building2</icon>
            <description>Company profile, logo, and basic information</description>
            <link>/settings/organization</link>
            <color>text-blue-600</color>
          </module>
          <module>
            <name>User Management</name>
            <icon>Users</icon>
            <description>Manage users, roles, and permissions</description>
            <link>/settings/users</link>
            <color>text-blue-600</color>
          </module>
        </category>

        <category name="Warehouse &amp; Facilities">
          <module>
            <name>Warehouses</name>
            <icon>Warehouse</icon>
            <description>Configure warehouse locations and sites</description>
            <link>/settings/warehouses</link>
            <color>text-orange-600</color>
          </module>
          <module>
            <name>Locations</name>
            <icon>MapPin</icon>
            <description>Manage storage locations and bins</description>
            <link>/settings/locations</link>
            <color>text-orange-600</color>
          </module>
          <module>
            <name>Machines</name>
            <icon>Cpu</icon>
            <description>Configure production equipment</description>
            <link>/settings/machines</link>
            <color>text-orange-600</color>
          </module>
          <module>
            <name>Production Lines</name>
            <icon>Factory</icon>
            <description>Set up production line configurations</description>
            <link>/settings/production-lines</link>
            <color>text-orange-600</color>
          </module>
        </category>

        <category name="Product Configuration">
          <module>
            <name>Allergens</name>
            <icon>AlertTriangle</icon>
            <description>Manage allergen tags for products</description>
            <link>/settings/allergens</link>
            <color>text-red-600</color>
          </module>
          <module>
            <name>Tax Codes</name>
            <icon>Receipt</icon>
            <description>Configure VAT and tax codes</description>
            <link>/settings/tax-codes</link>
            <color>text-pink-600</color>
          </module>
        </category>

        <category name="System Configuration">
          <module>
            <name>Module Activation</name>
            <icon>Grid</icon>
            <description>Enable/disable system modules</description>
            <link>/settings/modules</link>
            <color>text-purple-600</color>
          </module>
          <module>
            <name>Setup Wizard</name>
            <icon>Wand2</icon>
            <description>Initial system setup assistant</description>
            <link>/settings/wizard</link>
            <color>text-indigo-600</color>
          </module>
        </category>
      </modules>
      <success-criteria>
        - All 10 setting sections displayed as cards
        - Each card has icon, title, description, and clickable link
        - Cards use consistent styling and spacing
        - Hover states provide visual feedback
      </success-criteria>
    </criterion>

    <criterion id="AC-015.3">
      <title>Card Interaction &amp; Navigation</title>
      <given>I am on the Settings Dashboard</given>
      <when>I click on any settings card</when>
      <then>I should be navigated to the corresponding settings page</then>
      <success-criteria>
        - All cards are clickable and navigate correctly
        - Navigation uses Next.js Link component (client-side navigation)
        - Active/hover states provide clear visual feedback
      </success-criteria>
    </criterion>

    <criterion id="AC-015.4">
      <title>Responsive Layout</title>
      <given>I am on the Settings Dashboard</given>
      <when>I view the page on different screen sizes</when>
      <then>the card grid should adapt responsively</then>
      <breakpoints>
        <breakpoint size="mobile" max-width="768px" columns="1"/>
        <breakpoint size="tablet" min-width="768px" max-width="1024px" columns="2"/>
        <breakpoint size="desktop" min-width="1024px" columns="3"/>
      </breakpoints>
      <success-criteria>
        - Grid layout uses Tailwind responsive classes
        - Cards maintain readable spacing on all screen sizes
        - No horizontal scrolling required
      </success-criteria>
    </criterion>

    <criterion id="AC-015.5">
      <title>Consistent Layout with Application</title>
      <given>I am on the Settings Dashboard</given>
      <then>the page should:
        - Use the same layout wrapper as other pages (Sidebar + Topbar)
        - Match the visual design of the main dashboard
        - Use consistent typography, colors, and spacing from design system
      </then>
      <success-criteria>
        - Sidebar is visible on the left
        - Topbar with UserMenu is visible at top
        - Page follows same container/padding pattern as main dashboard
        - Uses shadcn/ui Card component for consistency
      </success-criteria>
    </criterion>
  </acceptance-criteria>

  <technical-implementation>
    <file-structure>
      <new-file path="apps/frontend/app/settings/page.tsx">Settings Dashboard (this story)</new-file>
      <existing-file path="apps/frontend/app/settings/organization/page.tsx">Organization Settings</existing-file>
      <existing-file path="apps/frontend/app/settings/users/page.tsx">User Management</existing-file>
      <existing-file path="apps/frontend/app/settings/warehouses/page.tsx">Warehouses</existing-file>
      <existing-file path="apps/frontend/app/settings/locations/page.tsx">Locations</existing-file>
      <existing-file path="apps/frontend/app/settings/machines/page.tsx">Machines</existing-file>
      <existing-file path="apps/frontend/app/settings/production-lines/page.tsx">Production Lines</existing-file>
      <existing-file path="apps/frontend/app/settings/allergens/page.tsx">Allergens</existing-file>
      <existing-file path="apps/frontend/app/settings/tax-codes/page.tsx">Tax Codes</existing-file>
      <existing-file path="apps/frontend/app/settings/modules/page.tsx">Module Activation</existing-file>
      <existing-file path="apps/frontend/app/settings/wizard/page.tsx">Setup Wizard</existing-file>
    </file-structure>

    <technology-stack>
      <framework>Next.js 15 (App Router)</framework>
      <components>React Server Components</components>
      <styling>Tailwind CSS</styling>
      <ui-library>shadcn/ui (Card, Button)</ui-library>
      <icons>lucide-react</icons>
    </technology-stack>

    <component-structure>
      <component name="SettingsPage" file="apps/frontend/app/settings/page.tsx">
        <description>Main settings dashboard page component</description>
        <implementation-pattern>
          <![CDATA[
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'
import Link from 'next/link'
import { Building2, Users, Warehouse, MapPin, Cpu, Factory, AlertTriangle, Receipt, Grid, Wand2 } from 'lucide-react'

// Settings module definitions
const settingsModules = [
  {
    name: 'Organization Settings',
    description: 'Company profile, logo, and basic information',
    icon: Building2,
    href: '/settings/organization',
    color: 'text-blue-600',
  },
  // ... rest of modules
]

export default function SettingsPage() {
  return (
    <div className="container mx-auto p-6">
      <div className="mb-8">
        <h1 className="text-3xl font-bold tracking-tight">Settings</h1>
        <p className="text-muted-foreground">Configure your MonoPilot system</p>
      </div>

      <div className="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
        {settingsModules.map((module) => (
          <Link key={module.href} href={module.href}>
            <Card className="hover:shadow-lg transition-shadow cursor-pointer">
              <CardHeader>
                <div className="flex items-start gap-4">
                  <module.icon className={`h-10 w-10 ${module.color}`} />
                  <div className="flex-1">
                    <CardTitle className="text-lg">{module.name}</CardTitle>
                    <CardDescription>{module.description}</CardDescription>
                  </div>
                </div>
              </CardHeader>
            </Card>
          </Link>
        ))}
      </div>
    </div>
  )
}
          ]]>
        </implementation-pattern>
      </component>
    </component-structure>
  </technical-implementation>

  <ui-ux-specifications>
    <visual-design>
      <card-component>
        <base>shadcn/ui Card with CardHeader, CardTitle, CardDescription</base>
        <icon-size>h-10 w-10 (40x40px)</icon-size>
        <hover-effect>hover:shadow-lg transition-shadow</hover-effect>
        <cursor>cursor-pointer</cursor>
      </card-component>

      <grid-layout>
        <gap>gap-6</gap>
        <responsive>grid-cols-1 md:grid-cols-2 lg:grid-cols-3</responsive>
      </grid-layout>

      <typography>
        <page-title>text-3xl font-bold tracking-tight</page-title>
        <subtitle>text-muted-foreground</subtitle>
        <card-title>text-lg</card-title>
        <card-description>Default CardDescription styling</card-description>
      </typography>
    </visual-design>

    <color-palette>
      <category name="Organization &amp; Users" color="Blue (text-blue-600)">
        Administrative and user management functions
      </category>
      <category name="Warehouse &amp; Facilities" color="Orange/Amber (text-orange-600)">
        Logistics and facility configuration
      </category>
      <category name="Product Configuration" color="Red/Pink (text-red-600, text-pink-600)">
        Product-related settings
      </category>
      <category name="System Configuration" color="Purple/Indigo (text-purple-600, text-indigo-600)">
        System-level settings
      </category>
    </color-palette>

    <design-consistency>
      <reference-design>Main Dashboard (Story 1.13)</reference-design>
      <shared-patterns>
        - Responsive grid layout with gap-6
        - Card component with hover effects
        - Icon-driven navigation
        - Consistent typography hierarchy
        - Color-coded categories
      </shared-patterns>
    </design-consistency>
  </ui-ux-specifications>

  <testing-strategy>
    <manual-testing>
      <test>Navigate to `/settings` - page loads without errors</test>
      <test>All 10 setting cards are displayed</test>
      <test>Each card shows correct icon, title, and description</test>
      <test>Clicking each card navigates to correct sub-page</test>
      <test>Responsive layout works on mobile, tablet, desktop</test>
      <test>Hover effects work correctly</test>
      <test>Sidebar and topbar are visible</test>
      <test>Back button returns to dashboard correctly</test>
    </manual-testing>

    <accessibility-testing>
      <test>All interactive elements are keyboard accessible</test>
      <test>Focus states are visible</test>
      <test>Screen reader announces card titles and descriptions</test>
      <test>Semantic HTML structure is correct</test>
    </accessibility-testing>

    <browser-testing>
      <browser>Chrome/Edge (latest)</browser>
      <browser>Firefox (latest)</browser>
      <browser>Safari (latest)</browser>
      <browser>Mobile browsers (iOS Safari, Chrome Mobile)</browser>
    </browser-testing>

    <e2e-testing>
      <framework>Playwright</framework>
      <test-file>tests/e2e/settings-dashboard.spec.ts</test-file>
      <test-cases>
        <case>Navigate to `/settings` → page loads without errors</case>
        <case>All 10 setting cards displayed</case>
        <case>Click each card → navigate to correct sub-page</case>
        <case>Responsive layout (mobile, tablet, desktop)</case>
      </test-cases>
    </e2e-testing>
  </testing-strategy>

  <dependencies>
    <required-before>
      <dependency completed="true">All existing settings pages (Stories 1.1 - 1.12)</dependency>
      <dependency completed="true">shadcn/ui Card component installed</dependency>
      <dependency completed="true">Sidebar component with Settings link</dependency>
    </required-before>

    <blocked-stories>
      <none>This is a polish/UX improvement with no blocking dependencies</none>
    </blocked-stories>
  </dependencies>

  <notes>
    <rationale>
      <discovery>During Epic 1 implementation, individual settings pages were created but the landing page was overlooked</discovery>
      <impact>Without this page, Settings link in sidebar leads to 404/blank page</impact>
      <priority>Marked P0 as it blocks basic navigation and creates poor first impression</priority>
    </rationale>

    <future-enhancements scope="not-in-mvp">
      <enhancement>Search/filter settings cards</enhancement>
      <enhancement>Quick actions on cards (e.g., "Add User" directly from card)</enhancement>
      <enhancement>Stats on each card (e.g., "15 users", "3 warehouses")</enhancement>
      <enhancement>Categorization/grouping of cards with section headers</enhancement>
      <enhancement>Settings navigation breadcrumbs</enhancement>
    </future-enhancements>
  </notes>

  <definition-of-done>
    <task completed="false">Settings Dashboard page created at `/settings/page.tsx`</task>
    <task completed="false">All 10 setting modules displayed as cards</task>
    <task completed="false">Responsive grid layout implemented</task>
    <task completed="false">Navigation to all sub-pages works correctly</task>
    <task completed="false">Consistent styling with main dashboard</task>
    <task completed="false">Manual testing completed</task>
    <task completed="false">Code review approved</task>
    <task completed="false">Story documentation committed to repo</task>
    <task completed="false">sprint-status.yaml updated with Story 1.15</task>
  </definition-of-done>

  <estimation-breakdown>
    <total-story-points>3</total-story-points>
    <total-hours>4-6 hours</total-hours>
    <breakdown>
      <task name="Create page component" hours="1"/>
      <task name="Define all 10 setting modules" hours="1"/>
      <task name="Implement responsive grid layout" hours="1"/>
      <task name="Styling and polish" hours="1"/>
      <task name="Testing and fixes" hours="1-2"/>
      <task name="Documentation" hours="0.5" completed="true"/>
    </breakdown>
  </estimation-breakdown>
</story-context>
