<?xml version="1.0" encoding="UTF-8"?>
<story>
  <metadata>
    <id>2.21</id>
    <title>Genealogy Tree View</title>
    <batch>02D-1</batch>
    <points>5</points>
    <effort_hours>6-8</effort_hours>
    <status>pending</status>
  </metadata>

  <description>Interactive tree diagram visualization with react-flow, color-coded nodes, expand/collapse, and lazy loading.</description>

  <dependencies>
    <requires>
      <story id="2.18">Forward Traceability</story>
      <story id="2.19">Backward Traceability</story>
    </requires>
  </dependencies>

  <technical_context>
    <api_endpoints>
      <endpoint method="GET" path="/api/technical/tracing/genealogy/:lp_id">
        <query>direction=forward|backward|both, max_depth=10</query>
        <response>nodes: TreeNode[], edges: TreeEdge[], metadata</response>
      </endpoint>
    </api_endpoints>

    <visualization>
      <library>react-flow</library>
      <node_colors>
        <color status="available">green</color>
        <color status="consumed">blue</color>
        <color status="shipped">gray</color>
        <color status="quarantine">orange</color>
      </node_colors>
      <features>pan, zoom, drag, expand/collapse, minimap</features>
      <lazy_loading>Nodes beyond depth 3 loaded on expand</lazy_loading>
    </visualization>

    <components_to_create>
      <component name="GenealogyTree" path="app/technical/tracing/components/GenealogyTree.tsx"/>
      <component name="LPNode" path="app/technical/tracing/components/LPNode.tsx"/>
    </components_to_create>
  </technical_context>

  <acceptance_criteria>
    <ac id="2.21.1">Interactive tree with LP details in nodes</ac>
    <ac id="2.21.2">Color by status</ac>
    <ac id="2.21.3">Expand/collapse nodes</ac>
    <ac id="2.21.4">Zoom in/out</ac>
    <ac id="2.21.5">Click node for LP detail modal</ac>
    <ac id="2.21.6">Lazy load deep nodes</ac>
  </acceptance_criteria>
</story>
