# SHIP-011: Sales Order Cancellation with Inventory Release

**Module**: Shipping Management
**Feature**: Sales Order Cancellation Modal, Reason Selection, Inventory Release
**Scope**: FR-7.17 (SO Cancellation), Inventory allocation release, Customer/warehouse notifications
**Status**: Production-Ready
**Last Updated**: 2025-12-15

---

## Overview

Sales Order cancellation modal enables users to cancel SO in any status except Shipped/Delivered, with automatic inventory release. Modal collects cancellation reason, optional notes, and requires confirmation. Displays impact summary showing allocated LPs to release, pick lists to delete, and notifications to send.

**Key Features:**
- Modal triggered from SO Detail page [ğŸ—‘ Cancel Order] button
- Cancellation reason dropdown (required): Customer Request, Out of Stock, Duplicate Order, Other
- Optional notes field (max 500 chars) for additional context
- Impact summary panel showing what will be released
- Confirmation checkbox requiring explicit user approval
- Responsive: Desktop modal / Mobile full-screen
- WCAG 2.1 AA accessibility
- All 4 states: Loading, Empty, Error, Success
- Undo/grace period: 5-minute window to reverse cancellation (Draft orders) or recover archived order data
- Concurrent edit protection: Version field prevents race conditions

---

## ASCII Wireframe

### Success State (Desktop Modal)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ—‘ Cancel Sales Order                                    [Ã—]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  âš  Cancellation will permanently release allocated inventory     â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Order Details                                               â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ Order Number: SO-2025-001234                                â”‚ â”‚
â”‚  â”‚ Customer: Acme Foods Inc. (CUST-001)                        â”‚ â”‚
â”‚  â”‚ Current Status: ğŸŸ¢ Confirmed                                â”‚ â”‚
â”‚  â”‚ Order Total: $1,512.04                                       â”‚ â”‚
â”‚  â”‚ Order Date: 2025-12-15 | Promised Ship: 2025-12-20          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Cancellation Reason (required)                              â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ [â–¼ Select Reason â–¼]                                          â”‚ â”‚
â”‚  â”‚   â˜‘ Customer Request                                        â”‚ â”‚
â”‚  â”‚   â˜ Out of Stock                                            â”‚ â”‚
â”‚  â”‚   â˜ Duplicate Order                                         â”‚ â”‚
â”‚  â”‚   â˜ Other                                                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Additional Notes (optional, max 500 chars)                  â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ Customer called to cancel due to internal supply change.    â”‚ â”‚
â”‚  â”‚ Promised to reorder next month. (44/500 characters)         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ âš  IMPACT SUMMARY - What will be released                   â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚ Inventory Allocations (3 LPs):                              â”‚ â”‚
â”‚  â”‚ âœ“ LP-2025-0451 (Organic Tomato Sauce, 50 units)            â”‚ â”‚
â”‚  â”‚ âœ“ LP-2025-0452 (Organic Tomato Sauce, 50 units)            â”‚ â”‚
â”‚  â”‚ âœ“ LP-2025-0453 (Fresh Basil, 50 units)                     â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚ Pick Lists (0 active):                                       â”‚ â”‚
â”‚  â”‚ (No active pick lists - no impact on warehouse)             â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚ Notifications to Send (2):                                   â”‚ â”‚
â”‚  â”‚ âœ“ Customer: John Smith (john@acmefoods.com)                 â”‚ â”‚
â”‚  â”‚ âœ“ Warehouse: Shipping Team                                  â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚ Audit Trail:                                                 â”‚ â”‚
â”‚  â”‚ âœ“ Cancellation will be logged with user, timestamp, reason  â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Recovery & Undo Options                                     â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚ â± 5-Minute Grace Period:                                    â”‚ â”‚
â”‚  â”‚ You can undo this cancellation within 5 minutes             â”‚ â”‚
â”‚  â”‚ [âŸ² Undo Cancellation] will restore order to previous state â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚ For Draft orders: Cancellation can be reverted anytime      â”‚ â”‚
â”‚  â”‚ For other statuses: 5-minute window applies                 â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Confirmation                                                â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ [âœ“] I confirm cancellation and understand that:             â”‚ â”‚
â”‚  â”‚     - All allocated inventory will be released              â”‚ â”‚
â”‚  â”‚     - This action cannot be undone after 5 minutes          â”‚ â”‚
â”‚  â”‚     - Customer and warehouse will be notified               â”‚ â”‚
â”‚  â”‚     - I can undo within 5 minutes using [âŸ² Undo]           â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚ [âœ“] I confirm this cancellation is correct                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  [ğŸ—‘ Cancel Order]  [â† Keep Order]                              â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Success State (Desktop Modal with Active Pick Lists)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ—‘ Cancel Sales Order                                    [Ã—]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  âš  Cancellation will permanently release allocated inventory     â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Order Details                                               â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ Order Number: SO-2025-001235                                â”‚ â”‚
â”‚  â”‚ Customer: Best Foods Wholesale (CUST-002)                   â”‚ â”‚
â”‚  â”‚ Current Status: ğŸŸ£ Picking                                  â”‚ â”‚
â”‚  â”‚ Order Total: $1,501.18                                       â”‚ â”‚
â”‚  â”‚ Order Date: 2025-12-14 | Promised Ship: 2025-12-18          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Cancellation Reason (required)                              â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ [â–¼ Select Reason â–¼]                                          â”‚ â”‚
â”‚  â”‚   â˜ Customer Request                                        â”‚ â”‚
â”‚  â”‚   â˜‘ Out of Stock                                            â”‚ â”‚
â”‚  â”‚   â˜ Duplicate Order                                         â”‚ â”‚
â”‚  â”‚   â˜ Other                                                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Additional Notes (optional, max 500 chars)                  â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ [Empty field] (0/500 characters)                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ âš  IMPACT SUMMARY - What will be released                   â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚ Inventory Allocations (2 LPs):                              â”‚ â”‚
â”‚  â”‚ âœ“ LP-2025-0461 (Classic Meatballs, 100 units)              â”‚ â”‚
â”‚  â”‚ âœ“ LP-2025-0463 (Vegetables Mix, 75 units)                  â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚ Pick Lists (1 active):                                       â”‚ â”‚
â”‚  â”‚ âš  PL-2025-001 (Status: In Progress, Assigned to: John D.)  â”‚ â”‚
â”‚  â”‚   Action: Pick list will be CANCELLED                       â”‚ â”‚
â”‚  â”‚   [ğŸ” View Pick List Details]                               â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚ Notifications to Send (3):                                   â”‚ â”‚
â”‚  â”‚ âœ“ Customer: Maria Garcia (maria@bestfoods.com)              â”‚ â”‚
â”‚  â”‚ âœ“ Warehouse: Shipping Team                                  â”‚ â”‚
â”‚  â”‚ âœ“ Picker: John Davis (notify of pick list cancellation)     â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚ Audit Trail:                                                 â”‚ â”‚
â”‚  â”‚ âœ“ Cancellation will be logged with user, timestamp, reason  â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Recovery & Undo Options                                     â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚ â± 5-Minute Grace Period:                                    â”‚ â”‚
â”‚  â”‚ You can undo this cancellation within 5 minutes             â”‚ â”‚
â”‚  â”‚ NOTE: Undo will restore order AND re-activate pick lists    â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚ For Picking/Packing orders: 5-minute undo window applies    â”‚ â”‚
â”‚  â”‚ Pick lists can be re-activated if still reversible          â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Confirmation                                                â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ [âœ“] I confirm cancellation and understand that:             â”‚ â”‚
â”‚  â”‚     - All allocated inventory will be released              â”‚ â”‚
â”‚  â”‚     - Pick list PL-2025-001 will be cancelled               â”‚ â”‚
â”‚  â”‚     - This action cannot be undone after 5 minutes          â”‚ â”‚
â”‚  â”‚     - I can undo within 5 minutes using [âŸ² Undo]           â”‚ â”‚
â”‚  â”‚     - Customer and warehouse will be notified               â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚ [âœ“] I confirm this cancellation is correct                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  [ğŸ—‘ Cancel Order]  [â† Keep Order]                              â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Tablet State (Responsive Modal - 768-1024px)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ—‘ Cancel Sales Order                         [Ã—]      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  âš  Cancellation will release allocated inventory       â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Order Details                                    â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ Order: SO-2025-001234                           â”‚  â”‚
â”‚  â”‚ Customer: Acme Foods Inc. (CUST-001)            â”‚  â”‚
â”‚  â”‚ Status: ğŸŸ¢ Confirmed                            â”‚  â”‚
â”‚  â”‚ Total: $1,512.04                                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Reason (required)                                â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ [â–¼ Select Reason â–¼]                              â”‚  â”‚
â”‚  â”‚   â˜‘ Customer Request                           â”‚  â”‚
â”‚  â”‚   â˜ Out of Stock                               â”‚  â”‚
â”‚  â”‚   â˜ Duplicate Order                            â”‚  â”‚
â”‚  â”‚   â˜ Other                                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Notes (optional, max 500 chars)                  â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ Customer called to cancel...  (35/500 chars)    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                         â”‚
â”‚  [+ Expand Impact Summary]                             â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Impact Summary (Collapsible)                     â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ âœ“ 3 LPs will be released (180 units)            â”‚  â”‚
â”‚  â”‚ âœ“ 0 active pick lists                           â”‚  â”‚
â”‚  â”‚ âœ“ 2 recipients will be notified                 â”‚  â”‚
â”‚  â”‚ [ğŸ” View Details] [âŸ² Undo Grace Period Info]    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Confirmation                                     â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ [âœ“] I confirm cancellation                      â”‚  â”‚
â”‚  â”‚ [âœ“] Cancellation is correct                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                         â”‚
â”‚  [ğŸ—‘ Cancel] [â† Keep]                                  â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Mobile State (Full Screen Modal)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ—‘ Cancel Order                                [Ã—]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                       â”‚
â”‚  âš  Cancellation will permanently release allocated   â”‚
â”‚    inventory. This action cannot be undone after     â”‚
â”‚    5 minutes (grace period applies).                 â”‚
â”‚                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Order Details                                  â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ Order: SO-2025-001234                         â”‚  â”‚
â”‚  â”‚ Customer: Acme Foods Inc.                     â”‚  â”‚
â”‚  â”‚ Status: ğŸŸ¢ Confirmed                          â”‚  â”‚
â”‚  â”‚ Total: $1,512.04                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Reason (required)                              â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ [â–¼ Select Reason â–¼]                           â”‚  â”‚
â”‚  â”‚   â˜‘ Customer Request                         â”‚  â”‚
â”‚  â”‚   â˜ Out of Stock                             â”‚  â”‚
â”‚  â”‚   â˜ Duplicate Order                          â”‚  â”‚
â”‚  â”‚   â˜ Other                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Notes (optional)                               â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ [Empty field] (0/500 characters)              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ âš  Impact Summary                              â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚                                                 â”‚  â”‚
â”‚  â”‚ Inventory:                                     â”‚  â”‚
â”‚  â”‚ 3 license plates will be released             â”‚  â”‚
â”‚  â”‚ (180 units total)                             â”‚  â”‚
â”‚  â”‚                                                 â”‚  â”‚
â”‚  â”‚ Pick Lists:                                    â”‚  â”‚
â”‚  â”‚ 0 active pick lists                            â”‚  â”‚
â”‚  â”‚                                                 â”‚  â”‚
â”‚  â”‚ Notifications:                                 â”‚  â”‚
â”‚  â”‚ Customer + Warehouse team will be notified    â”‚  â”‚
â”‚  â”‚                                                 â”‚  â”‚
â”‚  â”‚ [+] Expand Details                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Grace Period & Undo                            â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ â± 5-Minute Window:                            â”‚  â”‚
â”‚  â”‚ You can undo this cancellation for 5 minutes â”‚  â”‚
â”‚  â”‚ [âŸ² How Undo Works]                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Confirmation                                   â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ [âœ“] I confirm cancellation and understand:   â”‚  â”‚
â”‚  â”‚     - Inventory will be released              â”‚  â”‚
â”‚  â”‚     - 5-min undo window applies                â”‚  â”‚
â”‚  â”‚     - Notifications will be sent              â”‚  â”‚
â”‚  â”‚                                                 â”‚  â”‚
â”‚  â”‚ [âœ“] I confirm this cancellation is correct   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                       â”‚
â”‚  [ğŸ—‘ Cancel Order]                                   â”‚
â”‚  [â† Keep Order]                                      â”‚
â”‚                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Loading State (Form Submission)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ—‘ Cancel Sales Order                                    [Ã—]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] Loading cancellation details...         â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Order Details                                               â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ Order: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘]                  â”‚ â”‚
â”‚  â”‚ Customer: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘]           â”‚ â”‚
â”‚  â”‚ Status: [â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘]                               â”‚ â”‚
â”‚  â”‚ Total: [â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘]                                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Reason (required)                                           â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘]               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Notes (optional)                                            â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘]               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ âš  IMPACT SUMMARY                                           â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 40%        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Confirmation                                                â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ [â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘]  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  [â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] [â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘]                        â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Loading State (Form Submission with Spinner)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ—‘ Cancel Sales Order                                    [Ã—]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  âš  Cancellation will permanently release allocated inventory     â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Order Details                                               â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ Order Number: SO-2025-001234                                â”‚ â”‚
â”‚  â”‚ Customer: Acme Foods Inc. (CUST-001)                        â”‚ â”‚
â”‚  â”‚ Current Status: ğŸŸ¢ Confirmed                                â”‚ â”‚
â”‚  â”‚ Order Total: $1,512.04                                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Cancellation Reason (required)                              â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ [â–¼ Customer Request (disabled) â–¼]                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Additional Notes (optional)                                 â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ [Disabled textarea] (44/500 characters)                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ âš  IMPACT SUMMARY - What will be released                   â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ [Content disabled/faded during submission]                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Confirmation                                                â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ [Checkboxes disabled during submission]                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  [ğŸ”„ Cancelling...] (disabled)  [â† Keep Order] (disabled)       â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Key States During Submission:
- Primary button label: "[ğŸ”„ Cancelling...]"
- Primary button state: disabled, showing spinner
- All form fields: disabled (grayed out, no interaction)
- Secondary button: disabled (cannot close during submission)
- Backdrop: locked (cannot dismiss by clicking outside)
```

### Error State (Cannot Cancel)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ—‘ Cancel Sales Order                                    [Ã—]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚                           [âš  Icon]                               â”‚
â”‚                                                                   â”‚
â”‚                    Cannot Cancel This Order                      â”‚
â”‚                                                                   â”‚
â”‚                  Order SO-2025-001240 is in                       â”‚
â”‚                   "Shipped" status and cannot                    â”‚
â”‚                        be cancelled.                              â”‚
â”‚                                                                   â”‚
â”‚             Only Draft, Confirmed, Allocated, Picking,           â”‚
â”‚               and Packing orders can be cancelled.                â”‚
â”‚                                                                   â”‚
â”‚           [Contact Support] [â† Keep Order]                       â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Error State (Active Pick Lists Cannot Be Cancelled)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ—‘ Cancel Sales Order                                    [Ã—]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚                           [âš  Icon]                               â”‚
â”‚                                                                   â”‚
â”‚              Cannot Cancel: Pick Lists In Progress               â”‚
â”‚                                                                   â”‚
â”‚              This order has active pick lists that               â”‚
â”‚               must be cancelled before the order                 â”‚
â”‚                    can be cancelled.                              â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Active Pick Lists:                                          â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ â€¢ PL-2025-001 (Status: In Progress)                         â”‚ â”‚
â”‚  â”‚   Assigned to: John Davis                                   â”‚ â”‚
â”‚  â”‚   Started: 2025-12-15 12:30 PM                              â”‚ â”‚
â”‚  â”‚   [View Pick List] [Cancel Pick List]                       â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚ â€¢ PL-2025-002 (Status: Assigned)                            â”‚ â”‚
â”‚  â”‚   Assigned to: Sarah Miller                                 â”‚ â”‚
â”‚  â”‚   Created: 2025-12-15 12:00 PM                              â”‚ â”‚
â”‚  â”‚   [View Pick List] [Cancel Pick List]                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚           [â† Back to Order] [View All Pick Lists]                â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Empty State (No Inventory Impact)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ—‘ Cancel Sales Order                                    [Ã—]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  âš  Cancellation will permanently release allocated inventory     â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Order Details                                               â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ Order Number: SO-2025-001250 (Draft)                        â”‚ â”‚
â”‚  â”‚ Customer: Small Retailer (CUST-003)                         â”‚ â”‚
â”‚  â”‚ Current Status: ğŸŸ  Draft                                    â”‚ â”‚
â”‚  â”‚ Order Total: $250.00                                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Cancellation Reason (required)                              â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ [â–¼ Select Reason â–¼]                                          â”‚ â”‚
â”‚  â”‚   â˜ Customer Request                                        â”‚ â”‚
â”‚  â”‚   â˜ Out of Stock                                            â”‚ â”‚
â”‚  â”‚   â˜ Duplicate Order                                         â”‚ â”‚
â”‚  â”‚   â˜ Other                                                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Additional Notes (optional, max 500 chars)                  â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ [Empty field] (0/500 characters)                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ âš  IMPACT SUMMARY - What will be released                   â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚ Inventory Allocations:                                       â”‚ â”‚
â”‚  â”‚ (No inventory allocated - order is in Draft status)          â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚ Pick Lists:                                                  â”‚ â”‚
â”‚  â”‚ (No pick lists created - order not yet confirmed)            â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚ Notifications to Send (1):                                   â”‚ â”‚
â”‚  â”‚ âœ“ Customer: Will be notified of cancellation                â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚ Audit Trail:                                                 â”‚ â”‚
â”‚  â”‚ âœ“ Cancellation will be logged with user, timestamp, reason  â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚ Grace Period: Full undo available (Draft orders)             â”‚ â”‚
â”‚  â”‚ âœ“ You can undo cancellation anytime                         â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Confirmation                                                â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ [âœ“] I confirm cancellation and understand that:             â”‚ â”‚
â”‚  â”‚     - Customer will be notified                             â”‚ â”‚
â”‚  â”‚     - I can undo this cancellation anytime                  â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚ [âœ“] I confirm this cancellation is correct                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  [ğŸ—‘ Cancel Order]  [â† Keep Order]                              â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Error State (Undo Grace Period Expired)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â± Undo Grace Period Expired                             [Ã—]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚                           [â± Icon]                               â”‚
â”‚                                                                   â”‚
â”‚                  Grace Period Has Expired                        â”‚
â”‚                                                                   â”‚
â”‚            The 5-minute window to undo this                      â”‚
â”‚              cancellation has passed. You can                    â”‚
â”‚            no longer recover the cancelled order.                â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Order Details                                               â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ Order Number: SO-2025-001234                                â”‚ â”‚
â”‚  â”‚ Status: ğŸ”´ Cancelled                                        â”‚ â”‚
â”‚  â”‚ Cancelled At: 2025-12-15 15:30 PM                           â”‚ â”‚
â”‚  â”‚ Grace Period Expired: 2025-12-15 15:35 PM                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  Reason: Customer requested cancellation.                        â”‚
â”‚  All allocated inventory has been released.                       â”‚
â”‚                                                                   â”‚
â”‚  If you need to restore this order, contact support.             â”‚ â”‚
â”‚                                                                   â”‚
â”‚           [Contact Support] [â† Back to Order]                    â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Success Confirmation (After Cancellation)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ“ Order Cancelled Successfully                         [Ã—]      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚                        [âœ“ Checkmark Icon]                        â”‚
â”‚                                                                   â”‚
â”‚                    Order Cancelled Successfully                  â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Summary                                                      â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ Order Number: SO-2025-001234                                â”‚ â”‚
â”‚  â”‚ Status Changed: ğŸŸ¢ Confirmed â†’ ğŸ”´ Cancelled               â”‚ â”‚
â”‚  â”‚ Cancelled At: 2025-12-15 15:30 PM                           â”‚ â”‚
â”‚  â”‚ Cancelled By: Sarah Johnson                                 â”‚ â”‚
â”‚  â”‚ Reason: Customer Request                                    â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚ Inventory Released:                                          â”‚ â”‚
â”‚  â”‚ âœ“ 3 license plates released (180 units available again)     â”‚ â”‚
â”‚  â”‚   - LP-2025-0451: 50 units (Tomato Sauce)                  â”‚ â”‚
â”‚  â”‚   - LP-2025-0452: 50 units (Tomato Sauce)                  â”‚ â”‚
â”‚  â”‚   - LP-2025-0453: 50 units (Fresh Basil)                   â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚ Notifications Sent:                                          â”‚ â”‚
â”‚  â”‚ âœ“ Email sent to: john@acmefoods.com                         â”‚ â”‚
â”‚  â”‚ âœ“ Alert sent to: Shipping team                              â”‚ â”‚
â”‚  â”‚ âœ“ Audit log entry created                                   â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚ Undo Window:                                                 â”‚ â”‚
â”‚  â”‚ â± You have 5 minutes to undo this cancellation              â”‚ â”‚
â”‚  â”‚ [âŸ² Undo Cancellation] (active for 5 minutes)               â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚ Next Steps:                                                  â”‚ â”‚
â”‚  â”‚ â€¢ If customer needs to reorder, you can create a new SO     â”‚ â”‚
â”‚  â”‚ â€¢ Released inventory is available for other orders           â”‚ â”‚
â”‚  â”‚ â€¢ All order history is preserved for auditing                â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  [â† Back to Order] [View Cancelled Order] [New SO] [âŸ² Undo]    â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Key Components

### 1. Modal Header
- **Title**: "ğŸ—‘ Cancel Sales Order"
- **Close Button**: [Ã—] in top-right (48x48dp)
- **Warning Banner**: "âš  Cancellation will permanently release allocated inventory"
- **Desktop**: Sticky header remains visible during scroll
- **Mobile**: Header adjusts for smaller screens

### 2. Order Details Section
- **Order Number**: SO-2025-001234
- **Customer Name & Code**: Acme Foods Inc. (CUST-001)
- **Current Status**: ğŸŸ¢ Confirmed (color-coded)
- **Order Total**: $1,512.04
- **Order Date & Promised Ship Date**: For context
- **Read-only display** (no editing)

### 3. Cancellation Reason Section
- **Dropdown (required)**:
  - Customer Request
  - Out of Stock
  - Duplicate Order
  - Other
- **Validation**: Cannot proceed without selection
- **Error message if missing**: "Reason is required"
- **Button Styling**:
  - Desktop: Standard button with dropdown arrow
  - Mobile: Full-width dropdown with larger touch target

### 4. Additional Notes Section
- **Textarea**: Optional, max 500 characters
- **Character Counter**: Standardized format "44/500 characters" (live update)
- **Placeholder**: "Enter optional notes about this cancellation..."
- **Purpose**: Context for warehouse team and future auditing

### 5. Impact Summary Panel
- **Inventory Allocations**:
  - Number of LPs to release
  - List of LPs with product names and quantities
  - Expandable details
- **Pick Lists**:
  - Count of active pick lists
  - If any exist: Show status, assignee, action impact
  - Link to view pick list details
- **Notifications**:
  - List of recipients (customer, warehouse team, picker if applicable)
  - Email addresses shown
  - Types: Customer notification, warehouse alert
- **Audit Trail**: Confirmation that cancellation will be logged
- **Tablet**: Collapsible accordion sections with expand/collapse
- **Mobile**: Collapsible summary with "[+] Expand Details" option

### 6. Recovery & Undo Options Section
- **Grace Period Explanation**:
  - For Draft orders: "Full undo available anytime"
  - For other statuses: "5-minute grace period for undo"
  - Clear messaging about reversibility window
- **Undo Button** (post-confirmation):
  - "[âŸ² Undo Cancellation]" - visible for 5 minutes after cancellation
  - Desktop: Always visible in success confirmation
  - Mobile: Button with touch target >= 48x48dp
  - Disabled after 5-minute window expires
- **Soft-Delete Mechanism**:
  - Cancellation status: "cancelled" (not hard-deleted)
  - Archive data: Preserved in database with `cancelled_at` timestamp
  - Undo restoration: Re-activates order + restores allocations + re-activates pick lists

### 7. Confirmation Checkbox Section
- **Dual Confirmation**:
  - [âœ“] "I confirm cancellation and understand that: [bullets]"
  - [âœ“] "I confirm this cancellation is correct"
- **Bullets in first checkbox**:
  - All allocated inventory will be released
  - This action cannot be undone after grace period
  - Customer and warehouse will be notified
  - If pick lists exist: "Pick list XYZ will be cancelled"
  - If Draft: "I can undo anytime (Draft status)"
  - If Picking/Packing: "I can undo within 5 minutes"
- **Both must be checked** to enable [ğŸ—‘ Cancel Order] button

### 8. Action Buttons
- **Primary Button: [ğŸ—‘ Cancel Order]** (Destructive, red):
  - Enabled only when:
    - Reason selected
    - Both confirmation checkboxes checked
  - Shows loading spinner during submission: `[ğŸ”„ Cancelling...]`
  - All form elements disabled during submission
  - Desktop: Standard button width
  - Mobile: Full-width button
- **Secondary Button: [â† Keep Order]** (Default, gray):
  - Closes modal without action
  - Disabled during form submission
  - Provides cancel/abort option

---

## API Specification

### Request Body with Version Field (Concurrent Edit Protection)

```json
{
  "reason": "customer_request|out_of_stock|duplicate_order|other",
  "notes": "Optional context for cancellation...",
  "confirmed": true,
  "version": 3
}
```

**Version Field**: Integer field representing the current state version of the SO. Prevents race conditions when multiple users attempt simultaneous cancellations.

### 409 Conflict Response (Race Condition)

```json
{
  "success": false,
  "error": "VERSION_CONFLICT",
  "message": "Sales order was modified by another user. Please refresh and try again.",
  "current_version": 4,
  "expected_version": 3
}
```

---

## Main Interactions

### Open Cancellation Modal
1. **Trigger**: Click [ğŸ—‘ Cancel Order] button from SO Detail page
2. **Flow**:
   - Modal opens with fade-in animation
   - API call: `GET /api/shipping/sales-orders/:id` (to get current state and version)
   - Load allocation and pick list data
   - Calculate impact summary
   - Display modal with all sections
3. **Display**: Loading state â†’ Success state
4. **States**: Loading, Empty (no impact), Error (cannot cancel)

### Select Cancellation Reason
1. **Trigger**: Click on reason dropdown
2. **Flow**:
   - Dropdown opens showing 4 options
   - User selects reason (e.g., "Customer Request")
   - Selection updates form state
3. **Display**: Selected reason shown in dropdown
4. **Validation**: Enables next steps

### Enter Optional Notes
1. **Trigger**: Click in notes textarea
2. **Flow**:
   - User types notes (max 500 chars)
   - Character count updates in real-time
   - Notes stored in form state
   - Format: "Current/Maximum" (e.g., "44/500 characters")
3. **Display**: Text entered, character counter shows "44/500 characters"
4. **Validation**: No validation required (optional field), error if exceeds 500

### Review Impact Summary
1. **Trigger**: Modal displays automatically
2. **Flow**:
   - Impact summary section shows:
     - Count and list of LPs to be released
     - Count and details of active pick lists (if any)
     - List of recipients for notifications
   - If too much content, sections are collapsible
3. **Display**: All impact details visible with expand/collapse
4. **Actions**: Can click [ğŸ” View Pick List Details] to see more

### Review Undo/Grace Period Options
1. **Trigger**: Before confirming cancellation
2. **Flow**:
   - Display grace period explanation
   - Show status-based undo window (5 min or unlimited)
   - Explain that undo restores order + allocations + pick lists
3. **Display**: "Recovery & Undo Options" section with clear messaging
4. **Mobile**: Collapsible section with "[+] How Undo Works"

### Confirm Cancellation
1. **Trigger**: Check [âœ“] confirmation checkboxes
2. **Flow**:
   - User reads implications (bullets in checkbox)
   - Checks both confirmation checkboxes
   - Click [ğŸ—‘ Cancel Order]
   - Show loading spinner "Cancelling order..."
   - All form fields disabled during submission
   - API call: `DELETE /api/shipping/sales-orders/:id` with version field
   - Request body:
     ```json
     {
       "reason": "customer_request",
       "notes": "Customer called to cancel due to internal supply change...",
       "confirmed": true,
       "version": 3
     }
     ```
3. **Response**:
   ```json
   {
     "order": {
       "id": "uuid-so-1",
       "order_number": "SO-2025-001234",
       "status": "cancelled",
       "cancelled_at": "2025-12-15T15:30:00Z",
       "cancelled_by": "uuid-user",
       "cancellation_reason": "customer_request",
       "cancellation_notes": "..."
     },
     "released_allocations": [
       {
         "id": "uuid-alloc-1",
         "license_plate_id": "uuid-lp-1",
         "license_plate_number": "LP-2025-0451",
         "quantity_released": 50
       }
     ],
     "cancelled_pick_lists": [
       {
         "id": "uuid-pl-1",
         "pick_list_number": "PL-2025-001",
         "status": "cancelled"
       }
     ],
     "notifications_sent": [
       {
         "recipient_type": "customer",
         "recipient_email": "john@acmefoods.com",
         "status": "sent"
       },
       {
         "recipient_type": "warehouse",
         "recipient_id": "uuid-shipping-team",
         "status": "sent"
       }
     ],
     "undo_available_until": "2025-12-15T15:35:00Z",
     "success": true,
     "message": "Sales order cancelled successfully. Allocations released. Undo available for 5 minutes."
   }
   ```
4. **Result**:
   - Modal changes to success confirmation state
   - Shows summary of what was released
   - Displays undo button active for 5 minutes
   - Button options: [â† Back to Order], [View Cancelled Order], [New SO], [âŸ² Undo]

### Handle Cancellation Errors
1. **Cannot Cancel (Wrong Status)**:
   - Show error modal: "Cannot cancel order in Shipped status"
   - List allowed statuses
   - Buttons: [Contact Support], [â† Keep Order]

2. **Version Conflict (Race Condition)**:
   - Show error modal: "Sales order was modified by another user. Please refresh and try again."
   - Buttons: [Refresh and Retry], [â† Keep Order]
   - Reload SO data from server after user clicks Refresh

3. **Active Pick Lists Exist**:
   - Show error modal with list of active pick lists
   - Allow user to cancel pick lists first
   - Buttons: [â† Back to Order], [View All Pick Lists]

4. **Permission Denied**:
   - Show error: "You don't have permission to cancel orders"
   - Buttons: [Contact Admin], [â† Back to Order]

5. **Network/Server Error**:
   - Show error: "Failed to cancel order. [Retry] [Contact Support]"
   - Keep modal open to preserve form data

### Undo Cancellation (5-Minute Grace Period)
1. **Trigger**: Click [âŸ² Undo Cancellation] within 5 minutes of cancellation
2. **Flow**:
   - Confirmation dialog: "Are you sure you want to undo this cancellation? Order will be restored."
   - API call: `POST /api/shipping/sales-orders/:id/undo-cancellation`
   - Request body:
     ```json
     {
       "cancelled_id": "uuid-so-1"
     }
     ```
   - Server restores:
     - SO status to previous state (e.g., "confirmed")
     - All allocations re-activated
     - All pick lists re-activated (if they were cancelled)
     - Audit log entry for undo action
3. **Response**:
   ```json
   {
     "order": {
       "id": "uuid-so-1",
       "status": "confirmed",
       "restored_at": "2025-12-15T15:32:00Z"
     },
     "restored_allocations": 3,
     "restored_pick_lists": 1,
     "success": true,
     "message": "Cancellation undone. Order restored to previous state."
   }
   ```
4. **Result**:
   - Success message: "Cancellation undone successfully. Order restored."
   - Redirect to SO Detail page
   - Order shows previous status
   - Allocations available again
   - Pick lists re-activated with in-progress status

---

## Focus Trap & Keyboard Navigation

### Focus Trap Specification
- **Modal has focus trap** enabled
- **Tab navigation**: Cycles through all interactive elements within modal only
- **Tab order**: Reason dropdown â†’ Notes textarea â†’ Confirmation checkboxes â†’ Buttons
- **Shift+Tab**: Reverse order (buttons â†’ checkboxes â†’ textarea â†’ dropdown)
- **Escape key**: Closes modal (with confirmation dialog to prevent accidental closure)
- **Focus wraps**: Tab from last button returns focus to first element (reason dropdown)
- **Initially focused**: First interactive element is reason dropdown (or notes if reason selected)
- **Focus visible**: All focused elements show 2px outline in brand color
- **Backdrop click**: Does not close modal (users must use [â† Keep Order] button)

### Screen Reader Announcements
- **Modal open**: "Alert dialog: Cancel Sales Order modal opened. Order SO-2025-001234."
- **Character counter update**: "44 of 500 characters entered" (aria-live="polite")
- **Impact summary**: "Impact summary region: 3 license plates will be released"
- **Grace period info**: "Recovery options: 5-minute undo window available for this cancellation"
- **Form submission**: "Cancelling order... Button disabled"
- **Success**: "Success: Order cancelled successfully. Undo available for 5 minutes."

---

## States

### Loading State (Initial Modal Open)
- Skeleton screens for all sections
- Animated progress bar (0-100%)
- "Loading cancellation details..." message
- All form fields disabled
- Buttons disabled
- No data displayed

### Loading State (Form Submission)
- All form fields disabled (grayed out)
- Primary button shows spinner: `[ğŸ”„ Cancelling...]`
- Secondary button disabled
- Backdrop locked (no click-outside close)
- Character counter still visible but read-only
- Impact summary faded/disabled

### Empty State (No Inventory Impact)
- Modal displays normally
- Inventory Allocations section: "(No inventory allocated - order is in Draft status)"
- Pick Lists section: "(No pick lists created)"
- Notifications section: Shows only customer notification
- Grace period section: "Full undo available (Draft orders)"
- Everything else proceeds normally

### Error States

**Cannot Cancel (Wrong Status)**:
- Large warning icon
- "Cannot Cancel This Order" headline
- Explanation: "Order SO-2025-001240 is in Shipped status..."
- Allowed statuses listed
- Buttons: [Contact Support], [â† Keep Order]

**Version Conflict (Race Condition)**:
- Large warning icon
- "Order Modified" headline
- Explanation: "Sales order was modified by another user. Please refresh and try again."
- Buttons: [Refresh and Retry], [â† Keep Order]

**Active Pick Lists Exist**:
- Large warning icon
- "Cannot Cancel: Pick Lists In Progress" headline
- List of active pick lists with details
- Buttons to cancel individual pick lists
- Buttons: [â† Back to Order], [View All Pick Lists]

**Permission Denied**:
- Warning icon
- "Permission Denied" headline
- Explanation: "You don't have permission to cancel orders"
- Buttons: [Contact Admin], [â† Back to Order]

**Network/Server Error**:
- Warning icon
- "Failed to Cancel Order" headline
- Error code and message
- Buttons: [Retry], [Contact Support]

**Undo Grace Period Expired**:
- Hourglass/expiry icon
- "Grace Period Has Expired" headline
- Explanation: "The 5-minute window to undo this cancellation has passed..."
- Cancelled order details
- Buttons: [Contact Support], [â† Back to Order]

### Success State (Before Submission)
- Reason dropdown selected
- Notes filled in (optional)
- Both confirmation checkboxes checked
- Impact summary displayed with all details
- Grace period information visible
- [ğŸ—‘ Cancel Order] button enabled

### Success Confirmation (After Submission)
- Success icon and message: "Order Cancelled Successfully"
- Summary showing:
  - Order number and status change
  - Timestamp and who cancelled it
  - Reason for cancellation
  - Inventory released (LPs and quantities)
  - Notifications sent (recipients listed)
  - **Undo window**: "â± You have 5 minutes to undo this cancellation"
  - **Undo button**: "[âŸ² Undo Cancellation]" (active for 5 minutes)
  - Next steps (reorder, inventory available, history preserved)
- Buttons: [â† Back to Order], [View Cancelled Order], [New SO], [âŸ² Undo] (5-min timer visible)

---

## Data Fields

### Request Body (Cancel SO) with Version

```json
{
  "reason": "customer_request|out_of_stock|duplicate_order|other",
  "notes": "Optional context for cancellation...",
  "confirmed": true,
  "version": 3
}
```

**Fields**:
- `reason` (required): Enum value selecting cancellation reason
- `notes` (optional): Text field, max 500 characters
- `confirmed` (required): Boolean, must be true
- `version` (required): Integer field for concurrent edit protection

### Response (Successful Cancellation)

```json
{
  "order": {
    "id": "uuid-so-1",
    "org_id": "uuid-org",
    "order_number": "SO-2025-001234",
    "customer_id": "uuid-cust-1",
    "status": "cancelled",
    "total_amount": 1512.04,
    "cancelled_at": "2025-12-15T15:30:00Z",
    "cancelled_by": "uuid-user-1",
    "cancellation_reason": "customer_request",
    "cancellation_notes": "Customer called to cancel due to internal supply change...",
    "lines": [
      {
        "id": "uuid-line-1",
        "product": "Organic Tomato Sauce 500g",
        "quantity_ordered": 100,
        "quantity_allocated": 0,
        "notes": "Cancelled - allocations released"
      }
    ]
  },
  "released_allocations": [
    {
      "id": "uuid-alloc-1",
      "sales_order_line_id": "uuid-line-1",
      "license_plate_id": "uuid-lp-1",
      "license_plate_number": "LP-2025-0451",
      "product_name": "Organic Tomato Sauce 500g",
      "lot_number": "LOT-2025-0101",
      "quantity_released": 50,
      "status": "released",
      "released_at": "2025-12-15T15:30:00Z"
    },
    {
      "id": "uuid-alloc-2",
      "sales_order_line_id": "uuid-line-1",
      "license_plate_id": "uuid-lp-2",
      "license_plate_number": "LP-2025-0452",
      "product_name": "Organic Tomato Sauce 500g",
      "lot_number": "LOT-2025-0102",
      "quantity_released": 50,
      "status": "released",
      "released_at": "2025-12-15T15:30:00Z"
    },
    {
      "id": "uuid-alloc-3",
      "sales_order_line_id": "uuid-line-2",
      "license_plate_id": "uuid-lp-3",
      "license_plate_number": "LP-2025-0453",
      "product_name": "Fresh Basil 100g",
      "lot_number": "LOT-2025-0201",
      "quantity_released": 50,
      "status": "released",
      "released_at": "2025-12-15T15:30:00Z"
    }
  ],
  "cancelled_pick_lists": [
    {
      "id": "uuid-pl-1",
      "pick_list_number": "PL-2025-001",
      "status": "cancelled",
      "previous_status": "in_progress",
      "assigned_to": "uuid-user-2",
      "assigned_user_name": "John Davis",
      "cancelled_at": "2025-12-15T15:30:00Z"
    }
  ],
  "notifications_sent": [
    {
      "id": "uuid-notif-1",
      "recipient_type": "customer",
      "recipient_id": "uuid-cust-1",
      "recipient_name": "John Smith",
      "recipient_email": "john@acmefoods.com",
      "template": "so_cancelled_customer",
      "status": "sent",
      "sent_at": "2025-12-15T15:30:05Z"
    },
    {
      "id": "uuid-notif-2",
      "recipient_type": "warehouse_team",
      "recipient_role": "shipping_team",
      "template": "so_cancelled_warehouse",
      "status": "sent",
      "sent_at": "2025-12-15T15:30:06Z"
    },
    {
      "id": "uuid-notif-3",
      "recipient_type": "picker",
      "recipient_id": "uuid-user-2",
      "recipient_name": "John Davis",
      "template": "pick_list_cancelled",
      "status": "sent",
      "sent_at": "2025-12-15T15:30:07Z"
    }
  ],
  "undo_available_until": "2025-12-15T15:35:00Z",
  "success": true,
  "message": "Sales order cancelled successfully. Allocations released. Undo available for 5 minutes."
}
```

### Impact Summary Calculations

```typescript
interface ImpactSummary {
  allocated_lps: {
    count: number;
    lps: {
      license_plate_number: string;
      product_name: string;
      quantity_allocated: number;
      lot_number: string;
    }[];
  };
  active_pick_lists: {
    count: number;
    pick_lists: {
      pick_list_number: string;
      status: string;
      assigned_to_name: string;
      created_at: string;
    }[];
  };
  notifications: {
    recipients: {
      type: "customer" | "warehouse" | "picker";
      name: string;
      email?: string;
    }[];
    templates: string[];
  };
  audit_trail: {
    will_be_logged: true;
    fields: ["reason", "notes", "user_id", "timestamp"];
  };
  recovery_options: {
    status: string;
    undo_available_until: string | null;
    grace_period_minutes: number | null;
    can_undo_anytime: boolean;
  };
}
```

---

## API Endpoints

### Cancel Sales Order
```
DELETE /api/shipping/sales-orders/:id

Headers:
  Authorization: Bearer {token}
  Content-Type: application/json

Request Body:
{
  "reason": "customer_request|out_of_stock|duplicate_order|other",
  "notes": "Optional cancellation notes (max 500 chars)",
  "confirmed": true,
  "version": 3
}

Response:
{
  "order": { ...cancelled SO object... },
  "released_allocations": [ ...allocation objects... ],
  "cancelled_pick_lists": [ ...pick list objects... ],
  "notifications_sent": [ ...notification objects... ],
  "undo_available_until": "2025-12-15T15:35:00Z",
  "success": true,
  "message": "Sales order cancelled successfully. Allocations released. Undo available for 5 minutes."
}

Status Codes:
  200 OK - Success
  400 Bad Request - Invalid reason or missing confirmation
  401 Unauthorized - Not authenticated
  403 Forbidden - No permission to cancel
  404 Not Found - SO doesn't exist
  409 Conflict - SO in Shipped/Delivered status OR version conflict
  500 Server Error - Database/server error

Error Responses:

{
  "success": false,
  "error": "VERSION_CONFLICT",
  "message": "Sales order was modified by another user. Please refresh and try again.",
  "current_version": 4,
  "expected_version": 3
}

{
  "success": false,
  "error": "CANNOT_CANCEL_SHIPPED_ORDER",
  "message": "Cannot cancel order in Shipped status. Only Draft, Confirmed, Allocated, Picking, Packing statuses can be cancelled.",
  "current_status": "shipped"
}

{
  "success": false,
  "error": "ACTIVE_PICK_LISTS_EXIST",
  "message": "Cannot cancel order with active pick lists. Cancel pick lists first.",
  "pick_lists": [
    {
      "id": "uuid-pl-1",
      "pick_list_number": "PL-2025-001",
      "status": "in_progress",
      "assigned_to": "John Davis"
    }
  ]
}

{
  "success": false,
  "error": "PERMISSION_DENIED",
  "message": "You don't have permission to cancel orders."
}

{
  "success": false,
  "error": "VALIDATION_ERROR",
  "message": "Reason is required",
  "details": {
    "field": "reason",
    "value": null,
    "constraint": "required"
  }
}
```

### Undo Sales Order Cancellation
```
POST /api/shipping/sales-orders/:id/undo-cancellation

Headers:
  Authorization: Bearer {token}
  Content-Type: application/json

Request Body:
{
  "cancelled_id": "uuid-so-1"
}

Response:
{
  "order": {
    "id": "uuid-so-1",
    "status": "confirmed",
    "restored_at": "2025-12-15T15:32:00Z"
  },
  "restored_allocations": 3,
  "restored_pick_lists": 1,
  "success": true,
  "message": "Cancellation undone. Order restored to previous state."
}

Status Codes:
  200 OK - Undo successful
  400 Bad Request - Grace period expired or cannot undo
  401 Unauthorized - Not authenticated
  403 Forbidden - No permission
  404 Not Found - SO not found
  409 Conflict - SO not in cancelled state
  500 Server Error - Database/server error

Error Responses:

{
  "success": false,
  "error": "UNDO_GRACE_PERIOD_EXPIRED",
  "message": "Undo grace period (5 minutes) has expired. Cannot undo this cancellation.",
  "cancelled_at": "2025-12-15T15:30:00Z",
  "expired_at": "2025-12-15T15:35:00Z"
}

{
  "success": false,
  "error": "NOT_CANCELLABLE_ORDER",
  "message": "This order is not in cancelled state. Cannot undo."
}
```

### Get Cancellation Impact Summary (Pre-flight check)
```
GET /api/shipping/sales-orders/:id/cancellation-impact

Headers:
  Authorization: Bearer {token}

Response:
{
  "can_cancel": true,
  "order_status": "confirmed",
  "current_version": 3,
  "allocated_lps": [
    {
      "id": "uuid-alloc-1",
      "license_plate_number": "LP-2025-0451",
      "product_name": "Organic Tomato Sauce 500g",
      "quantity_allocated": 50
    }
  ],
  "active_pick_lists": [
    {
      "id": "uuid-pl-1",
      "pick_list_number": "PL-2025-001",
      "status": "in_progress",
      "assigned_to_name": "John Davis"
    }
  ],
  "notifications_recipients": [
    {
      "type": "customer",
      "name": "John Smith",
      "email": "john@acmefoods.com"
    },
    {
      "type": "warehouse",
      "role": "shipping_team"
    }
  ],
  "recovery_options": {
    "status": "confirmed",
    "undo_available_until": null,
    "grace_period_minutes": 5,
    "can_undo_anytime": false
  },
  "success": true
}

Status Codes:
  200 OK - Impact summary calculated
  404 Not Found - SO not found
  409 Conflict - SO cannot be cancelled (e.g., already shipped)
```

---

## Permissions

| Role | Can Cancel | Notes |
|------|-----------|-------|
| Admin | Yes | All statuses except Shipped/Delivered |
| Shipping Manager | Yes | All statuses except Shipped/Delivered |
| Shipping Clerk | No | View only |
| Warehouse Manager | No | Cannot cancel (warehouse function) |
| Sales Manager | No | Can view but not cancel |
| Viewer | No | View only |

---

## Validation Rules

### Cancellation Requirements
- **Status Check**: Order must be in Draft, Confirmed, Allocated, Picking, or Packing status
  - Cannot cancel: Shipped, Delivered, Cancelled
- **Reason Selection**: Must select from enum (Customer Request, Out of Stock, Duplicate Order, Other)
- **Notes Field**: Optional, max 500 characters
- **Confirmation Checkboxes**: Both must be checked before submission
- **Permissions**: User must have `cancel_sales_order` permission
- **Version Check**: Request version must match current SO version (prevents race conditions)

### Pre-Submission Validation
- Reason dropdown: Not empty (validation error if empty)
- Confirmation checkboxes: Both checked (button disabled if unchecked)
- Notes field: Character count <= 500
- Version field: Present in request payload

### Server-Side Validation
- SO exists and belongs to user's org
- SO status is cancellable (not Shipped/Delivered/Cancelled)
- User has permission to cancel
- No active pick lists OR user confirmed cancellation anyway
- Reason enum value is valid
- Request version matches current SO version (409 if mismatch)

### Post-Cancellation Validation
- All allocations released successfully
- All related pick lists cancelled (if any)
- Notifications sent to all recipients
- Audit log entry created
- Undo grace period timer started

### Undo Validation
- Order must be in "cancelled" status
- Undo must occur within 5 minutes of cancellation
- User must have `undo_sales_order_cancellation` permission
- Original allocations and pick lists must still exist (not manually modified)

---

## Accessibility

### Touch Targets
- All buttons: >= 48x48dp
- Modal close button: >= 48x48dp
- Dropdown toggle: >= 48x48dp
- Checkboxes: >= 44x44dp
- Any clickable element: >= 44x44dp
- Undo button (post-confirmation): >= 48x48dp

### Contrast
- Modal title: Dark gray on white, 8:1
- Body text: Dark gray on white, 5:1
- Labels: Dark gray, 4.5:1
- Links (if any): Blue, 4.5:1
- Warning banner: Dark text on light yellow background, 4.5:1
- Buttons: White text on colored background (red for cancel), 4.5:1
- Success message: Dark green on light green background, 4.5:1

### Screen Reader
- Modal: `role="alertdialog" aria-labelledby="modal-title" aria-modal="true"`
- Modal title: `id="modal-title"` with descriptive text
- Warning banner: `role="alert" aria-live="assertive"`
- Form sections: `fieldset` + `legend` for grouping
- Reason dropdown: `aria-label="Cancellation reason (required)"`
- Notes textarea: `aria-label="Additional notes (optional, max 500 characters)"`
- Character counter: `aria-live="polite"` (updates on keystroke)
- Impact summary: `role="region" aria-label="Cancellation impact summary"`
- Recovery options: `role="region" aria-label="Recovery and undo options"`
- Checkboxes: `aria-label` with full description
- Buttons: Descriptive `aria-label` (e.g., "Cancel order SO-2025-001234")
- Undo button: `aria-label="Undo cancellation (expires in X minutes)"`

### Keyboard Navigation
- Tab: Move through form fields (reason dropdown â†’ notes â†’ checkboxes â†’ buttons)
- Enter: Activate buttons, open dropdown
- Escape: Close modal (confirm via dialog before closing)
- Space: Toggle checkboxes, toggle dropdown
- Arrow Keys: Navigate dropdown options
- Shift+Tab: Reverse tab order
- **Focus trap**: Tab from last button wraps to first interactive element
- **Focus visible**: All focused elements show 2px outline

### ARIA Labels
- Modal title: "Cancel Sales Order SO-2025-001234"
- Warning: `aria-live="polite"` for impact summary updates
- Reason field: "Cancellation reason (required)"
- Notes field: "Additional notes (optional, 0/500 characters)"
- Character counter: `aria-live="polite"` (updates on each keystroke)
- Confirmation checkboxes: Full text describing implications
- Submit button: "Cancel order SO-2025-001234 permanently"
- Close button: "Close cancel order dialog"
- Undo button: "Undo cancellation (expires in X minutes)"

---

## Responsive Breakpoints

### Desktop (>1024px)
- Modal width: 600-650px, centered on screen
- All sections visible
- Impact summary fully expanded (not collapsed)
- Recovery options visible
- Buttons side-by-side at bottom
- Form fields at standard heights
- Character counter inline with textarea label

### Tablet (768-1024px)
- Modal width: 90% of viewport (max 550px)
- Sections may stack if needed
- Impact summary accordion sections (collapsible)
- Recovery options collapsible with "[+] How Undo Works"
- Buttons may stack vertically if space constrained
- Font sizes slightly reduced
- Character counter shows count: "35/500 characters"

### Mobile (<768px)
- Modal: Full-screen overlay or drawer from bottom
- Modal width: 100% of viewport
- Padding reduced to 12px-16px
- Impact summary: Collapsible accordion sections
- Recovery options: Collapsible section "[+] Grace Period Info"
- Buttons: Full-width, stacked vertically
- Font sizes: Adjusted for readability
- Dropdown, textarea: Full-width controls
- Character counter visible above textarea: "35/500 characters"
- Reason dropdown: Full-width with larger touch targets

---

## Error Handling

### Validation Errors
- **Missing Reason**: "Reason is required. Please select a cancellation reason." (red inline message)
- **Confirmation Unchecked**: "Both confirmation checkboxes must be checked to cancel this order." (modal-level message)
- **Notes Too Long**: "Notes exceed 500 character limit. Please remove X characters." (inline, real-time)

### API Errors
- **Version Conflict**: Show error modal: "Sales order was modified by another user. Please refresh and try again. [Refresh and Retry]"
- **Cannot Cancel (Shipped)**: Show error modal with status explanation
- **Active Pick Lists**: Show error modal with list of pick lists to cancel first
- **Permission Denied**: "You don't have permission to cancel orders. Contact your administrator."
- **Network Error**: "Failed to cancel order. Check your connection and try again. [Retry] [Cancel]"
- **Server Error (500)**: "Server error while cancelling order. [Retry] [Contact Support]"
- **Undo Grace Period Expired**: "Undo grace period has expired. You can no longer undo this cancellation."

### Partial Failures
- If some allocations fail to release: "Cancelled with partial success. 2 of 3 allocations released. [View Details] [Retry]"
- If some notifications fail to send: "Order cancelled but notification failed. Check with warehouse manually."

### Success Message
- Green success banner: "Order SO-2025-001234 cancelled successfully. Allocations released and notifications sent. Undo available for 5 minutes."
- Shows summary of what was released (counts)
- Provides undo button option (expires in 5 minutes)

---

## Testing Requirements

### Unit Tests
- **Reason Selection**:
  - Can select each reason option
  - Validation passes with any selected reason
  - Error shown if no reason selected
- **Notes Field**:
  - Can enter up to 500 characters
  - Character counter updates in format "N/500 characters"
  - Error shown if exceeds 500
- **Confirmation Checkboxes**:
  - Both must be checked to enable button
  - Button disabled if either unchecked
  - Each checkbox maintains state independently
- **Impact Summary Calculation**:
  - Correctly counts allocated LPs
  - Correctly identifies active pick lists
  - Correctly builds notification recipient list
  - Shows 0 if no impact in that category
- **Form Submission**:
  - Payload includes reason, notes, confirmed flag, version field
  - All data properly serialized
- **Version Field**:
  - Version field correctly included in request
  - Version increments on server after successful cancellation

### Integration Tests
- **API Endpoint**:
  - DELETE /api/shipping/sales-orders/:id (success)
  - DELETE with wrong status (409 error)
  - DELETE with active pick lists (409 error)
  - DELETE without permission (403 error)
  - DELETE SO not found (404 error)
  - DELETE with version mismatch (409 Conflict response)
- **Database Updates**:
  - SO status changed to "cancelled"
  - cancelled_at, cancelled_by, cancellation_reason, cancellation_notes set
  - All allocations released (released_at set)
  - All active pick lists cancelled
  - Audit log entry created
  - Undo grace period timestamp recorded
- **Notifications**:
  - Customer notification sent with correct template
  - Warehouse notification sent
  - Picker notification sent if pick lists existed
  - All emails contain correct order details
- **Undo Functionality**:
  - Undo endpoint correctly restores order status
  - Undo within grace period succeeds
  - Undo after grace period fails (400/409)
  - Allocations and pick lists re-activated

### E2E Tests
- **Happy Path: Cancel Draft Order**:
  - Click [ğŸ—‘ Cancel Order]
  - Modal opens (loading â†’ success)
  - Select "Customer Request"
  - Enter notes
  - Check confirmation checkboxes
  - Click [ğŸ—‘ Cancel Order]
  - Success confirmation displays with undo button
  - Undo button available and countdown visible
  - Click [âŸ² Undo Cancellation]
  - Order restored successfully

- **Happy Path: Cancel Confirmed Order with Allocations**:
  - Click [ğŸ—‘ Cancel Order]
  - Modal opens showing impact summary (3 LPs to release)
  - Select "Out of Stock"
  - Leave notes empty
  - Check confirmations
  - Click [ğŸ—‘ Cancel Order]
  - Success shows: "3 allocations released" + undo option
  - Verify allocations in database are released
  - Verify notifications were sent

- **Happy Path: Cancel Order with Active Pick Lists**:
  - Click [ğŸ—‘ Cancel Order]
  - Modal opens showing impact (1 active pick list)
  - Select reason
  - Confirm
  - Success shows: "Pick list PL-2025-001 cancelled" + undo option
  - Verify pick list status is cancelled

- **Race Condition: Version Conflict**:
  - Open cancel dialog for order (version=3)
  - Another user cancels same order (version increments to 4)
  - Try to submit cancellation with version 3
  - Receive 409 Conflict error with message
  - Click [Refresh and Retry]
  - Modal refreshes with current data
  - Show cannot-cancel error if already cancelled

- **Error: Cannot Cancel Shipped**:
  - Click [ğŸ—‘ Cancel Order]
  - Error modal appears
  - Modal shows reason (already shipped)
  - Close modal, order remains open

- **Error: Active Pick Lists**:
  - Click [ğŸ—‘ Cancel Order]
  - Modal shows error about active pick lists
  - Can click to view or cancel pick lists first

- **Validation: Missing Reason**:
  - Click [ğŸ—‘ Cancel Order]
  - Modal opens
  - Try to click submit without selecting reason
  - Button disabled or error message shown

- **Validation: Notes Too Long**:
  - Click [ğŸ—‘ Cancel Order]
  - Enter 600+ characters in notes
  - Character counter shows red/error state
  - Error shown: "Exceeds 500 character limit"
  - Cannot submit

### Responsive Tests
- **Desktop**: Modal 600px wide, centered, all content visible
- **Tablet**: Modal responsive width (90%), impact summary collapsible
- **Mobile**: Full-screen drawer, buttons stacked, sections collapsible

### Performance Tests
- Modal opens: <500ms
- Impact summary calculation: <300ms
- Cancellation submission: <2s
- Undo submission: <1s

---

## Quality Gates

Before handoff to FRONTEND-DEV:
- [x] All 4 states defined (Loading, Empty, Error, Success)
- [x] Responsive breakpoints documented (Desktop/Tablet/Mobile)
- [x] Modal triggered from SO Detail page
- [x] Cancellation reason dropdown (4 options)
- [x] Optional notes field (max 500 chars) with "N/500 characters" counter
- [x] Impact summary panel (allocations, pick lists, notifications)
- [x] Dual confirmation checkboxes with clear implications
- [x] Undo/grace period mechanism (5-minute window for Draft & non-Draft)
- [x] Version field for concurrent edit protection
- [x] Tablet ASCII wireframe with collapsible sections
- [x] Loading state with form submission spinner
- [x] Focus trap specification with keyboard navigation
- [x] API endpoint specified with request/response schemas
- [x] Error states documented (cannot cancel, version conflict, active pick lists, permission, undo expired, etc.)
- [x] Accessibility checklist passed (touch targets, contrast, screen reader, keyboard)
- [x] Permissions defined by role
- [x] Validation rules documented (server-side & client-side)
- [x] Error handling strategies for all failure scenarios
- [x] Success confirmation state with summary, undo button, and next steps
- [x] Notifications configured (customer, warehouse, picker)
- [x] Audit trail logging confirmed
- [x] Performance targets defined (<500ms open, <2s submit, <1s undo)
- [x] All interactions documented (open â†’ select reason â†’ review impact â†’ confirm â†’ submit â†’ undo)

---

## Handoff to FRONTEND-DEV

```yaml
feature: Sales Order Cancellation with Inventory Release + Undo Grace Period
story: SHIP-011
prd_coverage: "FR-7.17 (SO Cancellation with inventory release + recovery)"
approval_status:
  mode: "review_each"
  user_approved: false  # Awaiting review
  screens_approved: []
  iterations_used: 0
deliverables:
  wireframe: docs/3-ARCHITECTURE/ux/wireframes/SHIP-011-so-cancellation.md
  api_endpoint: DELETE /api/shipping/sales-orders/:id
  undo_endpoint: POST /api/shipping/sales-orders/:id/undo-cancellation
  pre_flight_check: GET /api/shipping/sales-orders/:id/cancellation-impact
states_per_screen:
  - loading (skeleton, progress bar)
  - loading_submission (spinner, disabled fields)
  - empty (no impact, draft order)
  - error (cannot cancel, version conflict, active pick lists, permission, undo expired)
  - success (form ready, confirmations checked)
  - success_confirmation (post-cancellation summary with undo)
screens:
  - Cancel SO Modal - Standard
  - Cancel SO Modal - With Active Pick Lists
  - Cancel SO Modal - Tablet (Responsive)
  - Cancel SO Modal - Mobile Full-Screen
  - Loading State - Initial
  - Loading State - Form Submission
  - Error: Cannot Cancel (Shipped)
  - Error: Version Conflict (Race Condition)
  - Error: Active Pick Lists Exist
  - Error: Undo Grace Period Expired
  - Success Confirmation (After Cancellation with Undo)
breakpoints:
  mobile: "<768px (full-screen drawer, stacked buttons)"
  tablet: "768-1024px (responsive modal, collapsible sections)"
  desktop: ">1024px (600px modal, all visible)"
accessibility:
  touch_targets: "48x48dp minimum"
  contrast: "4.5:1 minimum"
  aria_roles: ["alertdialog", "region", "alert"]
  keyboard_nav: ["Tab", "Enter", "Escape", "Space", "Arrow Keys"]
  focus_trap: "enabled (Tab cycles within modal)"
modal:
  width: "600px (desktop), 90% (tablet), 100% (mobile)"
  animation: "fade-in"
  backdrop: "semi-transparent dark"
  close_button: "[Ã—] 48x48dp top-right"
sections:
  - Header with warning banner
  - Order details (read-only)
  - Cancellation reason dropdown
  - Optional notes textarea (500 char limit with "N/500 characters" counter)
  - Impact summary panel (allocations, pick lists, notifications)
  - Recovery & Undo Options (grace period explanation)
  - Dual confirmation checkboxes
  - Action buttons (Cancel, Keep Order, Undo post-submission)
form_fields:
  reason:
    type: "enum select"
    options: ["customer_request", "out_of_stock", "duplicate_order", "other"]
    required: true
    validation: "Must select one"
  notes:
    type: "textarea"
    max_length: 500
    required: false
    character_counter: true
    counter_format: "N/500 characters"
  confirmed:
    type: "checkbox"
    required: true
    label: "I confirm cancellation and understand that..."
  confirmed_correct:
    type: "checkbox"
    required: true
    label: "I confirm this cancellation is correct"
  version:
    type: "hidden"
    required: true
    validation: "Must match current SO version"
impact_summary:
  allocations:
    shows: "Count and list of LPs with product names and quantities"
    expandable: true
  pick_lists:
    shows: "Count and status of active pick lists"
    actions: ["View Pick List", "Cancel Pick List"]
  notifications:
    shows: "Recipients (customer, warehouse, picker)"
    types: ["customer_email", "warehouse_alert", "picker_notification"]
  audit_trail:
    shows: "Confirmation that action will be logged"
  recovery_options:
    shows: "Grace period explanation, undo window, status-based rules"
    draft_orders: "Full undo available anytime"
    other_statuses: "5-minute grace period"
api:
  cancel_endpoint: "DELETE /api/shipping/sales-orders/:id"
  undo_endpoint: "POST /api/shipping/sales-orders/:id/undo-cancellation"
  preflight_endpoint: "GET /api/shipping/sales-orders/:id/cancellation-impact"
  request_body:
    reason: "enum"
    notes: "string|null (max 500)"
    confirmed: "boolean"
    version: "integer"
  response: "Cancelled SO + released allocations + notifications + undo_available_until"
  errors:
    CANNOT_CANCEL_SHIPPED_ORDER: "409 Conflict"
    VERSION_CONFLICT: "409 Conflict"
    ACTIVE_PICK_LISTS_EXIST: "409 Conflict"
    PERMISSION_DENIED: "403 Forbidden"
    VALIDATION_ERROR: "400 Bad Request"
    UNDO_GRACE_PERIOD_EXPIRED: "400 Bad Request"
buttons:
  primary:
    label: "ğŸ—‘ Cancel Order"
    style: "destructive (red)"
    loading_label: "ğŸ”„ Cancelling..."
    enabled_when: "reason selected AND both confirmations checked"
    disabled_during: "form submission"
  secondary:
    label: "â† Keep Order"
    style: "default (gray)"
    action: "close modal"
    disabled_during: "form submission"
  undo:
    label: "âŸ² Undo Cancellation"
    style: "secondary (gray)"
    visible_when: "success confirmation + within 5-minute grace period"
    expires: "5 minutes after cancellation"
    action: "call undo endpoint"
performance_targets:
  modal_open: "<500ms"
  impact_summary: "<300ms"
  cancellation_submit: "<2s"
  undo_submit: "<1s"
notifications:
  customer: "Email template: so_cancelled_customer"
  warehouse: "Alert template: so_cancelled_warehouse"
  picker: "Email template: pick_list_cancelled (if active pick lists)"
database_updates:
  sales_orders:
    fields: ["status", "cancelled_at", "cancelled_by", "cancellation_reason", "cancellation_notes"]
    soft_delete: true
  inventory_allocations:
    fields: ["released_at", "status"]
  pick_lists:
    fields: ["status"]
  audit_logs:
    entry: "SO cancellation with reason, notes, user, timestamp"
recovery_mechanism:
  grace_period: "5 minutes for non-Draft orders"
  draft_orders: "Unlimited undo available"
  endpoint: "POST /api/shipping/sales-orders/:id/undo-cancellation"
  restores: ["order status", "allocations", "pick lists"]
  validation: "Version check, timestamp validation"
concurrent_edit_protection:
  mechanism: "Version field in request"
  conflict_response: "409 Conflict with VERSION_CONFLICT error"
  handling: "User prompted to refresh and retry"
data_validation:
  client_side:
    - Reason: Required enum
    - Notes: Max 500 chars with live counter
    - Confirmations: Both checked
    - Version: Present in payload
  server_side:
    - SO exists and belongs to org
    - SO status is cancellable
    - User has permission
    - Request version matches current version
    - No conflicts with active operations
    - Undo: Grace period not expired, order in cancelled state
testing:
  unit: ["Reason selection", "Notes validation", "Checkbox logic", "Form submission", "Character counter", "Version field"]
  integration: ["API endpoint", "Database updates", "Notifications", "Permissions", "Version conflict handling", "Undo functionality"]
  e2e: ["Cancel draft", "Cancel with allocations", "Cancel with pick lists", "Version conflict", "Undo within grace period", "Undo after expiry", "Error scenarios"]
  responsive: ["Desktop 600px modal", "Tablet 90% responsive", "Mobile full-screen drawer"]
quality_target: "95%+ (production-ready cancellation workflow with recovery & concurrency protection)"
```

---

## Cancellation Reason Enum

```typescript
type CancellationReason =
  | "customer_request"      // Customer called/requested cancellation
  | "out_of_stock"          // Items no longer available
  | "duplicate_order"       // Duplicate was created accidentally
  | "other"                 // Other reason (see notes)
```

---

## Notification Templates

### Customer Email (so_cancelled_customer)
```
Subject: Order SO-2025-001234 Cancelled

Dear John Smith,

Your sales order SO-2025-001234 has been cancelled as of December 15, 2025 at 3:30 PM.

Order Details:
- Order Number: SO-2025-001234
- Customer: Acme Foods Inc.
- Order Total: $1,512.04
- Reason: Customer Request
- Cancelled By: Sarah Johnson

Undo Window: You have 5 minutes to contact us if you need to restore this order.

If you have any questions or would like to reorder, please contact us.

Thank you for your business.
```

### Warehouse Alert (so_cancelled_warehouse)
```
Alert: Sales Order Cancelled

Order SO-2025-001234 has been cancelled by Sarah Johnson.

Impact:
- 3 license plates released (180 units available again):
  - LP-2025-0451: Organic Tomato Sauce (50 units)
  - LP-2025-0452: Organic Tomato Sauce (50 units)
  - LP-2025-0453: Fresh Basil (50 units)
- 0 active pick lists
- 0 active shipments

Reason: Customer Request
Notes: Customer called to cancel due to internal supply change.

Customer: Acme Foods Inc. (john@acmefoods.com)

Recovery: This order can be restored within 5 minutes if needed. Check system for undo option.
```

### Picker Notification (pick_list_cancelled)
```
Your pick list PL-2025-001 has been cancelled.

Reason: Parent sales order SO-2025-001234 was cancelled.
Cancellation Reason: Customer Request

You may now work on other pick lists.

If you have questions, contact the warehouse manager.
```

---

## Summary

**SHIP-011** provides a comprehensive, user-friendly SO cancellation workflow with recovery and concurrent edit protection:

1. **Clear Intent**: Warning banner + order details for context
2. **Required Inputs**: Reason dropdown + optional notes with live character counter (N/500 format)
3. **Impact Transparency**: Detailed summary of what will be released
4. **User Confirmation**: Dual checkboxes ensuring explicit consent
5. **Error Prevention**: Pre-flight checks for invalid statuses or conflicting operations
6. **Full Traceability**: Audit logging with reason, notes, user, timestamp
7. **Comprehensive Notifications**: Customer, warehouse, and picker alerts
8. **Recovery Mechanism**: 5-minute grace period for non-Draft orders, unlimited undo for Draft orders
9. **Concurrent Edit Protection**: Version field prevents race conditions with 409 Conflict handling
10. **Responsive Design**: Desktop modal, tablet collapsible, mobile full-screen
11. **Accessibility**: Full WCAG 2.1 AA compliance with focus trap and keyboard nav
12. **Performance**: Sub-500ms open, sub-2s submission, sub-1s undo

**Quality Target**: 95%+ (production-ready)
**Wireframe Length**: ~2,000 lines
**Estimated Implementation**: 18-24 hours (includes undo + concurrency protection)

---

**Status**: Production-Ready
**Last Updated**: 2025-12-15
**Ready for User Review**
