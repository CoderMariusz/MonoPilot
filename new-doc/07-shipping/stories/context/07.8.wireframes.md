# Story 07.8 - Wireframe Mapping

## Overview

Story 07.8 (Pick List Generation + Wave Picking) is supported by two detailed wireframes that define the complete user interface for managing pick lists and creating wave picks.

---

## Wireframe 1: SHIP-012 - Pick List Management

**File**: `docs/3-ARCHITECTURE/ux/wireframes/SHIP-012-pick-list-list.md`

### Purpose

SHIP-012 defines the main pick list management interface, including:
- Pick list creation, filtering, and bulk actions
- Status badge design and color-coding (Draft, Assigned, In Progress, Completed, Cancelled)
- Responsive layouts (Desktop 7 cols, Tablet 5 cols, Mobile cards)
- Assignment workflow (Assign Picker Modal)

### Key Components

#### 1. PickListTable (Desktop - 7 Columns)
- **Checkbox** (select individual)
- **Pick List #** (PL-YYYY-NNNNN, clickable)
- **SO #** (sales_order_number, clickable)
- **Customer** (customer name, clickable)
- **Created** (relative/absolute date)
- **Assigned To** (user name or "Unassigned")
- **Status** (badge with icon, color, pattern)
- **Actions Dropdown** (â–¼) - View, Assign, Reassign, Start, Complete, Cancel, Print

#### 2. Status Badges (WCAG AA Compliant)
```
Draft:        â—€ Gray solid background
Assigned:     â—€ Light blue background + horizontal stripes
In Progress:  â—¯ Yellow background + diagonal stripes
Completed:    âœ“ Green background (solid)
Cancelled:    âœ• Red background (solid)
```

#### 3. Filters & Search
- **Search Bar**: Pick list #, SO #, customer name (debounced 300ms, min 2 chars)
- **Filter Dropdown**:
  - Status (multi-select checkboxes)
  - Assigned To (multi-select with "Unassigned" option)
  - Date Range (from-to date picker)
- **Pagination**: 20 per page (default), options 15/20/50

#### 4. Bulk Actions (when selected)
- [Assign (N)] - Assign N unassigned picks
- [Complete (N)] - Mark N as completed
- [Cancel (N)] - Cancel N with confirmation
- [Print (N)] - Print N as batch

#### 5. States Defined in SHIP-012
- **Loading**: Skeleton rows (10 rows) with progress bar
- **Empty**: Large icon, "No Pick Lists Yet" message, CTA to create
- **Error**: Warning icon, "Failed to Load Pick Lists", retry button
- **Success**: Full table with data, all features functional

### Mapping to Story 07.8

**SHIP-012 defines the UI for these Story 07.8 requirements:**

| AC # | Description | SHIP-012 Component |
|------|-------------|-------------------|
| AC-6 | List pick lists with filters (status, assigned_to, priority, date) | PickListTable + Filters |
| AC-7 | Picker view: "My Picks" (assigned to current user) | Page redirect to /pick-lists/my-picks |
| AC-8 | Pick list detail view with pick lines grouped by location | PickLinesTable (nested) |
| AC-5 | Assign picker with modal | AssignPickerModal component |

### Responsive Breakpoints

**Desktop (>1024px)**
- Full 7-column table
- Full-width search bar
- Side panel or overlay dropdown filters
- Bulk actions visible
- All status details visible

**Tablet (768-1024px)**
- Compact 5-column table (PL#, SO#, status, assigned, lines)
- Filters as dropdown overlay
- Actions dropdown (5-7 items)
- Status badge icon only (tooltip for label)

**Mobile (<768px)**
- Card layout (1 per pick list)
- Search and filter stacked
- Actions as vertical buttons
- "Load More" pagination

---

## Wireframe 2: SHIP-013 - Wave Picking Workflow

**File**: `docs/3-ARCHITECTURE/ux/wireframes/SHIP-013-wave-picking.md`

### Purpose

SHIP-013 defines the wave picking creation wizard:
- Multi-step workflow for selecting multiple sales orders
- Strategy selection (Zone-based, Route-based, FIFO)
- Preview of consolidated pick lines with location sequences

### Key Components

#### Step 1: Select Sales Orders
- **Sales Order Table** with filters:
  - Customer name search
  - Status filter (confirmed, allocated)
  - Date range filter
- **Multi-select checkboxes** for SOs
- **Bulk actions**: Select All, Clear Selection
- **Preview info**: "N orders selected, M total lines"

#### Step 2: Choose Optimization Strategy
- **Strategy Options** (radio buttons):
  - **Zone-Based** (Default): Pick sequence by zone (Chilledâ†’Frozenâ†’Dry)
  - **Route-Based**: TSP/route optimization (Phase 2)
  - **FIFO**: Chronological manufacturing date order
- **Preview**: Shows consolidated line count and estimated consolidation
- **Allergen Alert** (if applicable): Flag if wave contains allergen conflicts

#### Step 3: Review Consolidated Lines
- **Consolidated Pick Lines Table**:
  - **Product** (consolidated from all SOs)
  - **Location** (Zone/Aisle/Bin)
  - **Total Qty** (sum of all SO allocations for this product+location)
  - **Pick Sequence** (1, 2, 3, ...)
  - **Zone Sequence**: Visual indicator (Chilledâ†’Frozenâ†’Dry order)
- **Summary Stats**:
  - Total lines: (original SO lines â†’ consolidated lines)
  - Total quantity
  - Zones covered
  - Estimated pick time
- **Confirm Button**: Creates wave pick list with consolidated lines

### Mapping to Story 07.8

**SHIP-013 defines the UI for these Story 07.8 requirements:**

| AC # | Description | SHIP-013 Component |
|------|-------------|-------------------|
| AC-4 | Create wave pick list from multiple sales orders | Wave Wizard Step 1-3 |
| AC-3 | Generate pick lines with location-based sequencing | Step 3 Preview Table |
| AC-3 | Location sorting (zone â†’ aisle â†’ bin) | Zone/Aisle/Bin display |
| AC-3 | Auto-calculate pick_sequence | Visible in Step 3 |

### Wave Picking Algorithm (as shown in SHIP-013)

**Step 1 Flow:**
```
User clicks [ðŸ“‹ Wave Picking]
  â†“
Wizard opens: "Create Wave Pick List"
  â†“
User filters SOs (confirmed/allocated)
  â†“
User selects 2+ SOs (with checkboxes)
  â†“
User clicks [Next] â†’ Step 2
```

**Step 2 Flow:**
```
Strategy options displayed:
  - Zone-Based (recommended) - Pick by zone
  - Route-Based (future) - TSP algorithm
  - FIFO - Chronological order
  â†“
User selects strategy (Zone-Based default)
  â†“
System shows preview: "Will consolidate X lines to Y"
  â†“
User clicks [Next] â†’ Step 3
```

**Step 3 Flow:**
```
Consolidated lines preview:
  Product A: 150 units (Location: Chilled A1)  Pick Seq: 1
  Product B: 200 units (Location: Dry B3)      Pick Seq: 2
  Product C: 75 units (Location: Frozen F2)    Pick Seq: 3
  â†“
User reviews and clicks [Create Wave Pick List]
  â†“
API call: POST /api/shipping/pick-lists/wave
  â†“
Wave pick list created (pick_type='wave', wave_id set)
  â†“
Redirect to pick list detail page
```

### Location Sequence Visualization

SHIP-013 shows how locations are ordered in the consolidated wave:

**Zone-Based Strategy** (Most Common)
```
Zone 1: Chilled (Products A, D - Seq 1, 2)
Zone 2: Frozen (Products C - Seq 3)
Zone 3: Dry (Products B, E - Seq 4, 5)
```

Within each zone, sorted by aisle/bin (alphanumeric).

---

## Integration: SHIP-012 + SHIP-013

### Create Pick List Flow

**Single Order** (SHIP-012):
```
1. Click [+ Create Pick List] on SO detail page
2. System creates pick list with status=pending
3. [Assign] button in SHIP-012 table
4. Select operator from AssignPickerModal
5. Status updates to assigned
```

**Wave Picking** (SHIP-013):
```
1. Click [ðŸ“‹ Wave Picking] in SHIP-012 header
2. Select multiple SOs (SHIP-013 Step 1)
3. Choose strategy (SHIP-013 Step 2)
4. Review consolidated lines (SHIP-013 Step 3)
5. Create wave â†’ Redirect to SHIP-012 table
6. Wave appears with pick_type='wave'
```

### Assignment Workflow

Both single-order and wave pick lists follow the same assignment flow:

```
SHIP-012 Table â†’ [Assign] button
    â†“
AssignPickerModal opens (modal component)
    â†“
Display list of pickers (Picker, Warehouse, Manager roles)
    â†“
Select operator â†’ POST /api/shipping/pick-lists/:id/assign
    â†“
Status updates to 'assigned' in table (real-time)
    â†“
Pick appears in operator's "My Picks" view
```

### Detail Page Navigation

From SHIP-012 table, clicking pick list # navigates to detail page which shows:

```
Pick List Header (SHIP-012 concept)
  â”œâ”€ Pick List # (PL-YYYY-NNNNN)
  â”œâ”€ Type (Single Order / Wave)
  â”œâ”€ Status badge
  â”œâ”€ Assigned To (editable if pending)
  â”œâ”€ Created At / Started At / Completed At
  â””â”€ Associated Sales Order(s) links

Pick Lines Table (PickLinesTable component)
  â””â”€ Grouped by Location:
      Zone: Chilled
        Aisle: A1
          Bin: 01 â†’ Product A, Qty 100, Seq 1
          Bin: 02 â†’ Product B, Qty 50, Seq 2
        Aisle: A2
          Bin: 01 â†’ Product C, Qty 75, Seq 3
      Zone: Frozen
        Aisle: F1
          Bin: 01 â†’ Product D, Qty 200, Seq 4

Summary Stats
  â”œâ”€ Total lines: 12
  â”œâ”€ Total quantity: 350 units
  â”œâ”€ Locations: 8
  â””â”€ Picked: 0/12 (0%)
```

---

## Component Implementation Checklist

### From SHIP-012
- [x] PickListTable.tsx (7-column desktop, 5-column tablet, card mobile)
- [x] Status badges (with color + pattern/icon for accessibility)
- [x] Filter dropdown (status, assigned_to, date_range)
- [x] Search bar (debounced, min 2 chars)
- [x] Bulk actions bar (assign, complete, cancel, print)
- [x] Pagination (20 default, options 15/20/50)
- [x] Empty state (no pick lists, CTA)
- [x] Loading state (skeleton rows, progress)
- [x] Error state (retry button)

### From SHIP-013
- [x] WavePickingWizard.tsx (3-step wizard)
- [x] SO selection table (Step 1)
- [x] Strategy selector (Step 2 - Zone/Route/FIFO)
- [x] Consolidated preview (Step 3)
- [x] Allergen alert (if applicable)
- [x] Consolidation logic (group by product+location)

### Common Components
- [x] AssignPickerModal.tsx (operator selection + assignment)
- [x] PickLinesTable.tsx (grouped by location with hierarchy)
- [x] PickListHeader.tsx (detail page header)

---

## Data Mapping: Wireframes â†’ Database

### Pick List Creation (SHIP-013 â†’ Database)

**Step 3 Preview Shows:**
```
Product A: 150 units (Location: Chilled A1)  Pick Seq: 1
```

**Maps to Database:**
```
pick_list_lines entry:
  {
    pick_list_id: "uuid-pl-wave",
    product_id: "product-a-id",
    location_id: "loc-chilled-a1",
    quantity_to_pick: 150,
    pick_sequence: 1,
    status: "pending"
  }
```

**Multiple SOs Consolidated:**
```
Input (3 SOs):
  SO1: Product A, Qty 50, Location Chilled A1
  SO2: Product A, Qty 100, Location Chilled A1
  SO3: Product B, Qty 75, Location Dry B3

Output (Wave Pick Lines):
  Line 1: Product A, Qty 150 (consolidated), Location Chilled A1, Seq 1
  Line 2: Product B, Qty 75, Location Dry B3, Seq 2
```

---

## Performance Considerations (SHIP-012 + SHIP-013)

### SHIP-012 List Page
- **Initial Load**: <400ms (20 pick lists with pagination)
- **Search**: <300ms (debounced)
- **Filter Apply**: <350ms
- **Pagination**: <250ms

### SHIP-013 Wave Creation
- **Step 1 (SO Selection)**: <500ms (load SO list)
- **Step 2 (Strategy)**: <100ms (render options)
- **Step 3 (Preview)**: <800ms (consolidate + calculate sequences)
- **Create Wave**: <1s (POST + redirect)

---

## Testing Coverage (SHIP-012 + SHIP-013)

### SHIP-012 E2E Tests
1. Load pick list table â†’ Filter by status â†’ Verify results
2. Search by pick list # â†’ Verify matches
3. Click [Assign] â†’ Select operator â†’ Verify status updates
4. Select multiple pick lists â†’ Click [Complete (N)] â†’ Verify bulk action
5. Mobile: Card layout â†’ Load More â†’ Verify pagination
6. Empty state: No pick lists â†’ Click CTA â†’ Verify create flow
7. Error state: Simulate network error â†’ Click Retry â†’ Verify reload

### SHIP-013 E2E Tests
1. Click [ðŸ“‹ Wave Picking] â†’ Step 1 opens with SO list
2. Select 3 SOs â†’ Click [Next] â†’ Step 2 shows strategies
3. Select "Zone-Based" â†’ Click [Next] â†’ Step 3 shows consolidated lines
4. Verify: Lines consolidated by product+location, sorted by zone
5. Click [Create Wave Pick List] â†’ Redirect to SHIP-012 table
6. Verify: Wave appears with pick_type='wave' and consolidated line count
7. Click wave pick list â†’ Detail shows consolidated lines grouped by location

---

## Accessibility Validation (WCAG AA)

### SHIP-012
- [x] Status badges use color + pattern (Draft gray, Assigned blue+stripe, In Progress yellow+stripe)
- [x] Status badges have screen reader text ("Status: Assigned (awaiting start)")
- [x] Bulk action buttons show count ("Assign (3)")
- [x] Filter dropdowns have aria-labels
- [x] Pagination has aria-labels ("Page 1 of 5")
- [x] Touch targets >= 48x48dp (64x64dp on mobile)

### SHIP-013
- [x] Radio buttons for strategy options (keyboard navigable)
- [x] Multi-select checkboxes for SO selection (aria-labels)
- [x] Step indicator ("Step 1 of 3") for screen readers
- [x] Consolidated table headers clear (aria-label for sorted column)
- [x] Allergen alert prominent (color + icon + text)

---

## Wireframe Quality Checklist

| Item | SHIP-012 | SHIP-013 | Status |
|------|----------|----------|--------|
| ASCII wireframes | âœ“ | âœ“ | Complete |
| Responsive layouts | Desktop, Tablet, Mobile | Step layouts | Complete |
| States defined | Loading, Empty, Error, Success | 3 steps | Complete |
| API endpoints mapped | 16 endpoints listed | POST /wave | Complete |
| Components specified | 7 major components | 4 major components | Complete |
| Permissions matrix | 6 roles documented | Admin+ only | Complete |
| Business rules | Status workflow, assignment | Consolidation logic | Complete |
| Validation rules | Search, filter, pagination | Strategy validation | Complete |
| Accessibility | WCAG AA compliant | WCAG AA compliant | Complete |
| Performance targets | <400ms load, <300ms search | <1s wave creation | Complete |

---

## References

- **SHIP-012**: `docs/3-ARCHITECTURE/ux/wireframes/SHIP-012-pick-list-list.md` (1,477 lines)
- **SHIP-013**: `docs/3-ARCHITECTURE/ux/wireframes/SHIP-013-wave-picking.md` (comprehensive)
- **Story 07.8**: `docs/2-MANAGEMENT/epics/current/07-shipping/07.8.pick-list-generation.md`
- **PRD**: `docs/1-BASELINE/product/modules/shipping.md` (FR-7.21, FR-7.22, FR-7.23)

---

**Created**: 2025-12-18
**Story**: 07.8 - Pick List Generation + Wave Picking
