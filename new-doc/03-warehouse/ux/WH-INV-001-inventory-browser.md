# WH-INV-001: Inventory Browser & Cycle Counts

**Module**: Warehouse
**Feature**: Inventory Browser, Aging Reports, Expiring Items, Cycle Counts, Stock Adjustments
**Status**: Ready for Review
**Last Updated**: 2026-01-15

---

## Overview

The Inventory Browser (`/warehouse/inventory`) is a comprehensive inventory management page providing:
- **Overview Tab**: Inventory summary with grouping by Product/Location/Warehouse
- **Aging Report Tab**: FIFO/FEFO aging analysis with configurable buckets
- **Expiring Items Tab**: License Plates approaching or past expiry
- **Cycle Counts Tab**: Inventory count planning and execution
- **Adjustments Tab**: Stock adjustment history and creation

This page consolidates PRD requirements FR-023 (Cycle Count), FR-024 (Stock Adjustment), and inventory visibility features.

---

## ASCII Wireframe

### Success State (Desktop)

```
+--------------------------------------------------------------------------------------------------+
|  Warehouse > Inventory                                                [+ New Adjustment] [Export] |
+--------------------------------------------------------------------------------------------------+
|                                                                                                    |
|  +---------------------+ +---------------------+ +---------------------+ +---------------------+   |
|  | Total LP Count      | | Total Value         | | Expiring Soon       | | Expired             |   |
|  |       8,452         | |    $1,245,670       | |          47         | |          5          |   |
|  | Active License      | | Inventory at cost   | | Within 30 days      | | Past expiry date    |   |
|  | Plates              | | [View by Category]  | | [View Items]        | | [Urgent Action]     |   |
|  +---------------------+ +---------------------+ +---------------------+ +---------------------+   |
|                                                                                                    |
|  +----------------------------------------------------------------------------------------------+  |
|  | [Overview] [Aging Report] [Expiring Items] [Cycle Counts] [Adjustments]                     |  |
|  +----------------------------------------------------------------------------------------------+  |
|                                                                                                    |
|  [Overview Tab - Active]                                                                          |
|  +----------------------------------------------------------------------------------------------+  |
|  | Grouping: (o) By Product  ( ) By Location  ( ) By Warehouse                                 |  |
|  |                                                                                              |  |
|  | Filters: [Warehouse: All v] [Location: All v] [Product Category: All v]                    |  |
|  |          [Date Range: Last 30 days v] [Status: Active LPs v]                               |  |
|  |          [Search: _______________]                           [Apply] [Clear All]           |  |
|  +----------------------------------------------------------------------------------------------+  |
|                                                                                                    |
|  +----------------------------------------------------------------------------------------------+  |
|  | Product              | Available | Reserved | Blocked | Total Qty | LP Count | Avg Age    |   |
|  |                      | Qty       | Qty      | Qty     |           |          | (days)     |   |
|  +----------------------------------------------------------------------------------------------+  |
|  | Cocoa Mass           | 180.00 kg | 75.00 kg | 30.00 kg| 285.00 kg |    12    |    45      |   |
|  | RM-COCOA-001         | 63%       | 26%      | 11%     |           |          |            |   |
|  | Category: Raw Mat.   | [View Available LPs]  [View Reserved LPs]  [View Blocked LPs]      |   |
|  +----------------------------------------------------------------------------------------------+  |
|  | Sugar Fine           | 220.00 kg | 50.00 kg | 20.00 kg| 290.00 kg |    15    |    30      |   |
|  | RM-SUGAR-001         | 76%       | 17%      | 7%      |           |          |            |   |
|  | Category: Raw Mat.   | [View Available LPs]  [View Reserved LPs]  [View Blocked LPs]      |   |
|  +----------------------------------------------------------------------------------------------+  |
|  | Milk Powder          | 150.00 kg | 65.00 kg |  0.00 kg| 215.00 kg |     8    |    15      |   |
|  | RM-MILK-001          | 70%       | 30%      | 0%      |           |          |            |   |
|  | Category: Raw Mat.   | [View Available LPs]  [View Reserved LPs]                          |   |
|  +----------------------------------------------------------------------------------------------+  |
|  | Wheat Flour Type 00  | 450.00 kg |125.00 kg | 50.00 kg| 625.00 kg |    25    |    22      |   |
|  | RM-FLOUR-001         | 72%       | 20%      | 8%      |           |          |            |   |
|  | Category: Raw Mat.   | [View Available LPs]  [View Reserved LPs]  [View Blocked LPs]      |   |
|  +----------------------------------------------------------------------------------------------+  |
|  | Butter Unsalted      |  85.50 kg | 40.00 kg |  0.00 kg| 125.50 kg |     6    |    18      |   |
|  | RM-BUTTER-001        | 68%       | 32%      | 0%      |           |          |            |   |
|  | Category: Cold Chain | [View Available LPs]  [View Reserved LPs]                          |   |
|  +----------------------------------------------------------------------------------------------+  |
|                                                                                                    |
|  Showing 1-10 of 45 products                                        [< Prev] [1][2][3][4][5] [Next >] |
|  Total: 8,452 LPs | 547,500 kg | $1,245,670 value                           [Export CSV] [Export Excel] |
|                                                                                                    |
+--------------------------------------------------------------------------------------------------+
```

### Aging Report Tab (Desktop)

```
+--------------------------------------------------------------------------------------------------+
|  Warehouse > Inventory                                                [+ New Adjustment] [Export] |
+--------------------------------------------------------------------------------------------------+
|                                                                                                    |
|  +---------------------+ +---------------------+ +---------------------+ +---------------------+   |
|  | Total LP Count      | | Total Value         | | Expiring Soon       | | Expired             |   |
|  |       8,452         | |    $1,245,670       | |          47         | |          5          |   |
|  +---------------------+ +---------------------+ +---------------------+ +---------------------+   |
|                                                                                                    |
|  +----------------------------------------------------------------------------------------------+  |
|  | [Overview] [Aging Report] [Expiring Items] [Cycle Counts] [Adjustments]                     |  |
|  +----------------------------------------------------------------------------------------------+  |
|                                                                                                    |
|  [Aging Report Tab - Active]                                                                      |
|  +----------------------------------------------------------------------------------------------+  |
|  | Aging Mode: (o) FIFO (by Receipt Date)  ( ) FEFO (by Expiry Date)                          |  |
|  |                                                                                              |  |
|  | Filters: [Warehouse: All v] [Product Category: All v] [Product: All v]                     |  |
|  +----------------------------------------------------------------------------------------------+  |
|                                                                                                    |
|  +----------------------------------------------------------------------------------------------+  |
|  | Aging Analysis Summary                                                    [Export Report]    |  |
|  +----------------------------------------------------------------------------------------------+  |
|  |                                                                                              |  |
|  |  Age Distribution Chart (Horizontal Bar)                                                    |  |
|  |  +--------------------------------------------------------------------------------+         |  |
|  |  | 0-7 days   [=================================] 33% (2,145 LPs | 180,000 kg)    |         |  |
|  |  | 8-30 days  [========================================] 39% (3,420 LPs | 215,000 kg)|        |  |
|  |  | 31-90 days [============================] 22% (2,345 LPs | 120,000 kg)         |         |  |
|  |  | 90+ days   [========] 6% (542 LPs | 32,500 kg)                                  |         |  |
|  |  +--------------------------------------------------------------------------------+         |  |
|  |                                                                                              |  |
|  +----------------------------------------------------------------------------------------------+  |
|                                                                                                    |
|  +----------------------------------------------------------------------------------------------+  |
|  | Age Bucket    | LP Count | Quantity    | Value       | % Total | Status      | Action       |  |
|  +----------------------------------------------------------------------------------------------+  |
|  | 0-7 days      |   2,145  | 180,000 kg  | $410,250    |   33%   | [Fresh]     | [View LPs]   |  |
|  | (Very Recent) |          |             |             |         | Optimal     |              |  |
|  +----------------------------------------------------------------------------------------------+  |
|  | 8-30 days     |   3,420  | 215,000 kg  | $486,500    |   39%   | [Good]      | [View LPs]   |  |
|  | (Recent)      |          |             |             |         | Normal      |              |  |
|  +----------------------------------------------------------------------------------------------+  |
|  | 31-90 days    |   2,345  | 120,000 kg  | $272,000    |   22%   | [Aging]     | [View LPs]   |  |
|  | (Moderate)    |          |             |             |         | Monitor     | [Prioritize] |  |
|  +----------------------------------------------------------------------------------------------+  |
|  | 90+ days      |     542  |  32,500 kg  |  $76,920    |    6%   | [Old]       | [View LPs]   |  |
|  | (Old Stock)   |          |             |             |         | Use First   | [Alert Mgr]  |  |
|  +----------------------------------------------------------------------------------------------+  |
|                                                                                                    |
|  +----------------------------------------------------------------------------------------------+  |
|  | Products with Oldest Stock (Top 10)                                                          |  |
|  +----------------------------------------------------------------------------------------------+  |
|  | Product           | Oldest LP         | Age (days) | Qty       | Location    | Action       |  |
|  +----------------------------------------------------------------------------------------------+  |
|  | Cocoa Mass        | LP-2024-08-00123  |    134     | 50.00 kg  | A-01-02     | [View LP]    |  |
|  | Sugar Fine        | LP-2024-09-00456  |    102     | 75.00 kg  | A-02-03     | [View LP]    |  |
|  | Wheat Flour       | LP-2024-09-00789  |     98     | 100.00 kg | A-03-01     | [View LP]    |  |
|  | Butter Unsalted   | LP-2024-10-00234  |     76     | 25.00 kg  | B-01-02     | [View LP]    |  |
|  | Eggs Large        | LP-2024-10-00567  |     71     | 720.00 ea | B-02-01     | [View LP]    |  |
|  +----------------------------------------------------------------------------------------------+  |
|                                                                                                    |
+--------------------------------------------------------------------------------------------------+
```

### Expiring Items Tab (Desktop)

```
+--------------------------------------------------------------------------------------------------+
|  Warehouse > Inventory                                                [+ New Adjustment] [Export] |
+--------------------------------------------------------------------------------------------------+
|                                                                                                    |
|  +---------------------+ +---------------------+ +---------------------+ +---------------------+   |
|  | Total LP Count      | | Total Value         | | Expiring Soon       | | Expired             |   |
|  |       8,452         | |    $1,245,670       | |          47         | |          5          |   |
|  +---------------------+ +---------------------+ +---------------------+ +---------------------+   |
|                                                                                                    |
|  +----------------------------------------------------------------------------------------------+  |
|  | [Overview] [Aging Report] [Expiring Items] [Cycle Counts] [Adjustments]                     |  |
|  +----------------------------------------------------------------------------------------------+  |
|                                                                                                    |
|  [Expiring Items Tab - Active]                                                                    |
|  +----------------------------------------------------------------------------------------------+  |
|  | Show items expiring within: [30 days v]  (slider: 7 | 14 | 30 | 60 | 90 days)              |  |
|  |                                                                                              |  |
|  | Filters: [Warehouse: All v] [Product: All v] [QA Status: All v]                            |  |
|  |                                                                                              |  |
|  | Bulk Actions: [ ] Select All  [Move to Quarantine] [Create Adjustment] [Print List]        |  |
|  +----------------------------------------------------------------------------------------------+  |
|                                                                                                    |
|  +----------------------------------------------------------------------------------------------+  |
|  | Expiry Summary                                                                               |  |
|  | +------------+ +------------+ +------------+ +------------+                                 |  |
|  | | Expired    | | < 7 days   | | 7-14 days  | | 15-30 days |                                 |  |
|  | |     5      | |     12     | |     15     | |     20     |                                 |  |
|  | | [Urgent]   | | [Critical] | | [Warning]  | | [Monitor]  |                                 |  |
|  | +------------+ +------------+ +------------+ +------------+                                 |  |
|  +----------------------------------------------------------------------------------------------+  |
|                                                                                                    |
|  +----------------------------------------------------------------------------------------------+  |
|  | [ ] | LP Number       | Product         | Qty     | Location    | Expiry Date  | Days      |  |
|  |     |                 |                 |         |             |              | Until     |  |
|  +----------------------------------------------------------------------------------------------+  |
|  | [ ] | LP-2025-1234    | Cocoa Mass      | 50.0 kg | A-01-02     | 2026-01-10   | [EXPIRED] |  |
|  |     | Batch: BCH-890  | RM-COCOA-001    |         | Main WH     | 5 days ago   | [-5]      |  |
|  |     |                 |                 |         |             |              | [Dispose] |  |
|  +----------------------------------------------------------------------------------------------+  |
|  | [ ] | LP-2025-1245    | Milk Powder     | 25.0 kg | B-01-05     | 2026-01-12   | [EXPIRED] |  |
|  |     | Batch: MILK-456 | RM-MILK-001     |         | Cold WH     | 3 days ago   | [-3]      |  |
|  |     |                 |                 |         |             |              | [Dispose] |  |
|  +----------------------------------------------------------------------------------------------+  |
|  | [ ] | LP-2025-1256    | Butter Unsalted | 15.0 kg | B-02-01     | 2026-01-16   | [< 7 days]|  |
|  |     | Batch: BUT-789  | RM-BUTTER-001   |         | Cold WH     | Tomorrow     | [1]       |  |
|  |     |                 |                 |         |             |              | [Prioritize]|  |
|  +----------------------------------------------------------------------------------------------+  |
|  | [ ] | LP-2025-1267    | Eggs Large      | 720 ea  | B-03-02     | 2026-01-18   | [< 7 days]|  |
|  |     | Batch: EGG-234  | RM-EGGS-001     |         | Cold WH     | 3 days       | [3]       |  |
|  |     |                 |                 |         |             |              | [Use First]|  |
|  +----------------------------------------------------------------------------------------------+  |
|  | [ ] | LP-2025-1278    | Cheese Cheddar  | 40.0 kg | B-03-05     | 2026-01-20   | [< 7 days]|  |
|  |     | Batch: CHZ-567  | RM-CHEESE-001   |         | Cold WH     | 5 days       | [5]       |  |
|  |     |                 |                 |         |             |              | [Reserve] |  |
|  +----------------------------------------------------------------------------------------------+  |
|  | [ ] | LP-2025-1289    | Yogurt Plain    | 60.0 kg | B-04-01     | 2026-01-25   | [7-14 d]  |  |
|  |     | Batch: YOG-890  | RM-YOGURT-001   |         | Cold WH     | 10 days      | [10]      |  |
|  |     |                 |                 |         |             |              | [Schedule]|  |
|  +----------------------------------------------------------------------------------------------+  |
|                                                                                                    |
|  Showing 1-20 of 52 expiring items                                  [< Prev] [1][2][3] [Next >] |
|  Color Legend: [EXPIRED] Red  [< 7 days] Orange  [7-14 days] Yellow  [15-30 days] Green        |
|                                                                                                    |
+--------------------------------------------------------------------------------------------------+
```

### Cycle Counts Tab (Desktop)

```
+--------------------------------------------------------------------------------------------------+
|  Warehouse > Inventory                                                [+ New Adjustment] [Export] |
+--------------------------------------------------------------------------------------------------+
|                                                                                                    |
|  +---------------------+ +---------------------+ +---------------------+ +---------------------+   |
|  | Total LP Count      | | Total Value         | | Expiring Soon       | | Expired             |   |
|  |       8,452         | |    $1,245,670       | |          47         | |          5          |   |
|  +---------------------+ +---------------------+ +---------------------+ +---------------------+   |
|                                                                                                    |
|  +----------------------------------------------------------------------------------------------+  |
|  | [Overview] [Aging Report] [Expiring Items] [Cycle Counts] [Adjustments]                     |  |
|  +----------------------------------------------------------------------------------------------+  |
|                                                                                                    |
|  [Cycle Counts Tab - Active]                                                                      |
|  +----------------------------------------------------------------------------------------------+  |
|  | [+ New Cycle Count]                                                                          |  |
|  |                                                                                              |  |
|  | Filters: [Warehouse: All v] [Status: All v] [Type: All v] [Date Range: All v]              |  |
|  +----------------------------------------------------------------------------------------------+  |
|                                                                                                    |
|  +----------------------------------------------------------------------------------------------+  |
|  | Cycle Count Summary                                                                          |  |
|  | +------------------+ +------------------+ +------------------+ +------------------+          |  |
|  | | Planned          | | In Progress      | | Completed        | | With Variances   |          |  |
|  | |       5          | |       2          | |      23          | |       8          |          |  |
|  | | [Schedule Next]  | | [Continue]       | | [View History]   | | [Review]         |          |  |
|  | +------------------+ +------------------+ +------------------+ +------------------+          |  |
|  +----------------------------------------------------------------------------------------------+  |
|                                                                                                    |
|  +----------------------------------------------------------------------------------------------+  |
|  | Count #          | Type      | Warehouse   | Scope          | Scheduled   | Status     |     |  |
|  |                  |           |             |                | Date        |            |     |  |
|  +----------------------------------------------------------------------------------------------+  |
|  | CC-2026-00012    | [Cycle]   | Main WH     | Zone A         | 2026-01-20  | [Planned]  |     |  |
|  | Created by: Admin|           | 125 LPs     | Locations: 15  |             |            |     |  |
|  |                  |           |             |                |             | [Start] [Edit] [...]|  |
|  +----------------------------------------------------------------------------------------------+  |
|  | CC-2026-00011    | [Partial] | Cold WH     | High-Value     | 2026-01-18  | [Planned]  |     |  |
|  | Created by: Mgr  |           |  45 LPs     | Products: 8    |             |            |     |  |
|  |                  |           |             |                |             | [Start] [Edit] [...]|  |
|  +----------------------------------------------------------------------------------------------+  |
|  | CC-2026-00010    | [Cycle]   | Main WH     | Zone B         | 2026-01-15  | [In Prog]  |     |  |
|  | Started: 09:30   |           | 150 LPs     | Counted: 87/150| Today       |            |     |  |
|  | Counter: J.Smith |           |             | 58% complete   |             | [Continue] [...]|  |
|  +----------------------------------------------------------------------------------------------+  |
|  | CC-2026-00009    | [Partial] | Branch WH   | Receiving      | 2026-01-14  | [In Prog]  |     |  |
|  | Started: 14:00   |           |  30 LPs     | Counted: 25/30 | Yesterday   |            |     |  |
|  | Counter: M.Jones |           |             | 83% complete   |             | [Continue] [...]|  |
|  +----------------------------------------------------------------------------------------------+  |
|  | CC-2026-00008    | [Full]    | Cold WH     | All Locations  | 2026-01-10  | [Completed]|     |  |
|  | Completed: 16:45 |           | 200 LPs     | Variances: 3   | Last Week   |            |     |  |
|  | Counter: K.Wilson|           |             | Accuracy: 98.5%|             | [View Report] [...]|  |
|  +----------------------------------------------------------------------------------------------+  |
|  | CC-2026-00007    | [Cycle]   | Main WH     | Zone C         | 2026-01-08  | [Completed]|     |  |
|  | Completed: 11:30 |           |  75 LPs     | Variances: 5   | Last Week   |            |     |  |
|  | Counter: J.Smith |           |             | Accuracy: 93.3%|             | [View Report] [...]|  |
|  +----------------------------------------------------------------------------------------------+  |
|                                                                                                    |
|  Showing 1-10 of 30 cycle counts                                    [< Prev] [1][2][3] [Next >] |
|                                                                                                    |
+--------------------------------------------------------------------------------------------------+

[...] Row Actions Menu:
  - View Details
  - Edit Count (if planned)
  - Start Count (if planned)
  - Continue Count (if in_progress)
  - View Variances (if completed)
  - Approve Adjustments (if has unapproved variances)
  - Export Count Sheet (PDF)
  - Cancel Count (if planned or in_progress)
```

### Adjustments Tab (Desktop)

```
+--------------------------------------------------------------------------------------------------+
|  Warehouse > Inventory                                                [+ New Adjustment] [Export] |
+--------------------------------------------------------------------------------------------------+
|                                                                                                    |
|  +---------------------+ +---------------------+ +---------------------+ +---------------------+   |
|  | Total LP Count      | | Total Value         | | Expiring Soon       | | Expired             |   |
|  |       8,452         | |    $1,245,670       | |          47         | |          5          |   |
|  +---------------------+ +---------------------+ +---------------------+ +---------------------+   |
|                                                                                                    |
|  +----------------------------------------------------------------------------------------------+  |
|  | [Overview] [Aging Report] [Expiring Items] [Cycle Counts] [Adjustments]                     |  |
|  +----------------------------------------------------------------------------------------------+  |
|                                                                                                    |
|  [Adjustments Tab - Active]                                                                       |
|  +----------------------------------------------------------------------------------------------+  |
|  | [+ New Adjustment]                                                                           |  |
|  |                                                                                              |  |
|  | Filters: [Date Range: Last 30 days v] [Reason: All v] [Adjusted By: All v]                 |  |
|  |          [Warehouse: All v] [Status: All v]                                                 |  |
|  +----------------------------------------------------------------------------------------------+  |
|                                                                                                    |
|  +----------------------------------------------------------------------------------------------+  |
|  | Adjustment Summary (Last 30 Days)                                                            |  |
|  | +------------------+ +------------------+ +------------------+ +------------------+          |  |
|  | | Total Adjustments| | Qty Increased    | | Qty Decreased    | | Pending Approval |          |  |
|  | |       45         | |   +1,250 kg      | |   -890 kg        | |        3         |          |  |
|  | | [View All]       | | $28,500 value    | | $19,800 value    | | [Review]         |          |  |
|  | +------------------+ +------------------+ +------------------+ +------------------+          |  |
|  +----------------------------------------------------------------------------------------------+  |
|                                                                                                    |
|  +----------------------------------------------------------------------------------------------+  |
|  | Date/Time        | LP Number       | Product         | Original | New Qty | Reason      |    |  |
|  |                  |                 |                 | Qty      |         |             |    |  |
|  +----------------------------------------------------------------------------------------------+  |
|  | 2026-01-15 10:30 | LP-2025-1234    | Cocoa Mass      | 100.0 kg |  75.0 kg| [Damage]    |    |  |
|  | Adjusted By:     | Batch: BCH-890  | RM-COCOA-001    | -25.0 kg | -$568   | Approved    |    |  |
|  | J. Smith         | A-01-02 (Main)  |                 |          |         | [View] [...]|    |  |
|  +----------------------------------------------------------------------------------------------+  |
|  | 2026-01-15 09:15 | LP-2025-1245    | Sugar Fine      | 200.0 kg | 195.0 kg| [Count Err] |    |  |
|  | Adjusted By:     | Batch: SUG-456  | RM-SUGAR-001    |  -5.0 kg | -$75    | Approved    |    |  |
|  | M. Jones         | A-02-03 (Main)  |                 |          |         | [View] [...]|    |  |
|  +----------------------------------------------------------------------------------------------+  |
|  | 2026-01-14 16:45 | LP-2025-1256    | Milk Powder     |  50.0 kg |  55.0 kg| [Count Err] |    |  |
|  | Adjusted By:     | Batch: MILK-789 | RM-MILK-001     |  +5.0 kg | +$125   | [Pending]   |    |  |
|  | K. Wilson        | B-01-05 (Cold)  |                 |          |         | [Approve] [Reject]|  |
|  +----------------------------------------------------------------------------------------------+  |
|  | 2026-01-14 14:00 | LP-2025-1267    | Butter Unsalted |  40.0 kg |   0.0 kg| [Expired]   |    |  |
|  | Adjusted By:     | Batch: BUT-234  | RM-BUTTER-001   | -40.0 kg | -$1,200 | Approved    |    |  |
|  | Admin            | B-02-01 (Cold)  |                 |          |         | [View] [...]|    |  |
|  +----------------------------------------------------------------------------------------------+  |
|  | 2026-01-14 11:30 | LP-2025-1278    | Eggs Large      | 720 ea   | 680 ea  | [Theft]     |    |  |
|  | Adjusted By:     | Batch: EGG-567  | RM-EGGS-001     | -40 ea   | -$48    | Approved    |    |  |
|  | Security         | B-03-02 (Cold)  |                 |          |         | [View] [...]|    |  |
|  +----------------------------------------------------------------------------------------------+  |
|  | 2026-01-13 08:00 | LP-2025-1289    | Cheese Cheddar  |  60.0 kg |  62.5 kg| [Quality]   |    |  |
|  | Adjusted By:     | Batch: CHZ-890  | RM-CHEESE-001   |  +2.5 kg | +$87.50 | [Pending]   |    |  |
|  | QA Inspector     | B-03-05 (Cold)  |                 |          |         | [Approve] [Reject]|  |
|  +----------------------------------------------------------------------------------------------+  |
|                                                                                                    |
|  Showing 1-10 of 45 adjustments                                     [< Prev] [1][2][3][4][5] [Next >] |
|                                                                                                    |
|  Reason Codes: [Damage] [Counting Error] [Expired] [Theft] [Quality Issue] [Other]              |
|                                                                                                    |
+--------------------------------------------------------------------------------------------------+

[...] Row Actions Menu:
  - View Details
  - View LP
  - View Audit Trail
  - Approve (if pending + user has permission)
  - Reject (if pending + user has permission)
  - Reverse Adjustment (requires manager approval)
  - Print Adjustment Report
```

### Success State (Tablet: 768-1024px)

```
+--------------------------------------------------------------------+
|  Warehouse > Inventory                    [+ Adjust] [Export]       |
+--------------------------------------------------------------------+
|                                                                      |
|  +----------------+ +----------------+                               |
|  | Total LPs      | | Total Value    |                               |
|  |    8,452       | |  $1,245,670    |                               |
|  +----------------+ +----------------+                               |
|                                                                      |
|  +----------------+ +----------------+                               |
|  | Expiring Soon  | | Expired        |                               |
|  |       47       | |       5        |                               |
|  +----------------+ +----------------+                               |
|                                                                      |
|  [Overview] [Aging] [Expiring] [Counts] [Adjust]                    |
|                                                                      |
|  Grouping: (o) Product ( ) Location ( ) Warehouse                   |
|  Filters: [Warehouse v] [Location v] [Category v] [Search]          |
|                                                                      |
|  +----------------------------------------------------------------+ |
|  | Cocoa Mass (RM-COCOA-001)                    12 LPs | 45 days  | |
|  | Available: 180 kg (63%)  Reserved: 75 kg (26%)                  | |
|  | Blocked: 30 kg (11%)  Total: 285 kg                             | |
|  | [View Available] [View Reserved] [View Blocked]                 | |
|  +----------------------------------------------------------------+ |
|  | Sugar Fine (RM-SUGAR-001)                    15 LPs | 30 days  | |
|  | Available: 220 kg (76%)  Reserved: 50 kg (17%)                  | |
|  | Blocked: 20 kg (7%)  Total: 290 kg                              | |
|  | [View Available] [View Reserved] [View Blocked]                 | |
|  +----------------------------------------------------------------+ |
|  | Milk Powder (RM-MILK-001)                     8 LPs | 15 days  | |
|  | Available: 150 kg (70%)  Reserved: 65 kg (30%)                  | |
|  | Blocked: 0 kg (0%)  Total: 215 kg                               | |
|  | [View Available] [View Reserved]                                | |
|  +----------------------------------------------------------------+ |
|                                                                      |
|  Showing 1-10 of 45                             [1][2][3][4][5]     |
|                                                                      |
+--------------------------------------------------------------------+
```

### Success State (Mobile: <768px)

```
+----------------------------------+
|  < Inventory                     |
|  [+ Adjust] [Export]             |
+----------------------------------+
|                                  |
|  +----------------------------+  |
|  | Total LPs        8,452    |  |
|  | $1,245,670 value          |  |
|  +----------------------------+  |
|  | Expiring Soon       47    |  |
|  | Expired              5    |  |
|  +----------------------------+  |
|                                  |
|  [Overview][Aging][Exp][CC][Adj] |
|                                  |
|  Grouping: [Product v]           |
|  [Filters v]    [Search]         |
|                                  |
|  +----------------------------+  |
|  | Cocoa Mass                |  |
|  | RM-COCOA-001              |  |
|  | 12 LPs | Avg Age: 45 days |  |
|  |                           |  |
|  | Available: 180 kg (63%)   |  |
|  | Reserved:   75 kg (26%)   |  |
|  | Blocked:    30 kg (11%)   |  |
|  | Total:     285 kg         |  |
|  |                           |  |
|  | [View LPs] [Details]      |  |
|  +----------------------------+  |
|  | Sugar Fine                |  |
|  | RM-SUGAR-001              |  |
|  | 15 LPs | Avg Age: 30 days |  |
|  |                           |  |
|  | Available: 220 kg (76%)   |  |
|  | Reserved:   50 kg (17%)   |  |
|  | Blocked:    20 kg (7%)    |  |
|  | Total:     290 kg         |  |
|  |                           |  |
|  | [View LPs] [Details]      |  |
|  +----------------------------+  |
|  | Milk Powder               |  |
|  | RM-MILK-001               |  |
|  |  8 LPs | Avg Age: 15 days |  |
|  |                           |  |
|  | Available: 150 kg (70%)   |  |
|  | Reserved:   65 kg (30%)   |  |
|  | Total:     215 kg         |  |
|  |                           |  |
|  | [View LPs] [Details]      |  |
|  +----------------------------+  |
|                                  |
|  [Load More]                     |
|                                  |
+----------------------------------+
```

### Loading State

```
+--------------------------------------------------------------------------------------------------+
|  Warehouse > Inventory                                                [+ New Adjustment] [Export] |
+--------------------------------------------------------------------------------------------------+
|                                                                                                    |
|  +---------------------+ +---------------------+ +---------------------+ +---------------------+   |
|  | [================]  | | [================]  | | [================]  | | [================]  |   |
|  | [========]         | | [========]         | | [========]         | | [========]         |   |
|  | [====]             | | [====]             | | [====]             | | [====]             |   |
|  +---------------------+ +---------------------+ +---------------------+ +---------------------+   |
|                                                                                                    |
|  +----------------------------------------------------------------------------------------------+  |
|  | [================] [================] [================] [================] [================]|  |
|  +----------------------------------------------------------------------------------------------+  |
|                                                                                                    |
|  +----------------------------------------------------------------------------------------------+  |
|  | [================================================================================]          |  |
|  | [====================================================]                                      |  |
|  +----------------------------------------------------------------------------------------------+  |
|  | [================================================================================]          |  |
|  | [====================================================]                                      |  |
|  +----------------------------------------------------------------------------------------------+  |
|  | [================================================================================]          |  |
|  | [====================================================]                                      |  |
|  +----------------------------------------------------------------------------------------------+  |
|                                                                                                    |
|  Loading inventory data...                                                                        |
|                                                                                                    |
+--------------------------------------------------------------------------------------------------+
```

### Empty State

```
+--------------------------------------------------------------------------------------------------+
|  Warehouse > Inventory                                                [+ New Adjustment] [Export] |
+--------------------------------------------------------------------------------------------------+
|                                                                                                    |
|                                                                                                    |
|                                      +------------------+                                          |
|                                      |  [Inventory Icon]|                                          |
|                                      +------------------+                                          |
|                                                                                                    |
|                                  No Inventory Data Yet                                            |
|                                                                                                    |
|                   Your inventory browser is empty. License Plates are created when                |
|                   you receive goods via Goods Receipt Notes (GRN) from Purchase Orders            |
|                   or Transfer Orders. Start by receiving your first shipment.                     |
|                                                                                                    |
|                                                                                                    |
|                               [Go to Receiving (GRN)]                                             |
|                                                                                                    |
|                                [View Purchase Orders]                                             |
|                                                                                                    |
|                                                                                                    |
|                      Quick Tip: The Inventory Browser provides a comprehensive view               |
|                      of all stock by product, location, or warehouse. Use it to:                  |
|                      - Monitor aging inventory (FIFO/FEFO compliance)                             |
|                      - Track expiring items before they expire                                    |
|                      - Plan and execute cycle counts                                              |
|                      - Review and approve stock adjustments                                       |
|                                                                                                    |
|                                   [Learn About Inventory Management]                              |
|                                                                                                    |
+--------------------------------------------------------------------------------------------------+
```

### Error State

```
+--------------------------------------------------------------------------------------------------+
|  Warehouse > Inventory                                                [+ New Adjustment] [Export] |
+--------------------------------------------------------------------------------------------------+
|                                                                                                    |
|                                                                                                    |
|                                      +------------------+                                          |
|                                      |   [Error Icon]   |                                          |
|                                      +------------------+                                          |
|                                                                                                    |
|                               Failed to Load Inventory Data                                       |
|                                                                                                    |
|                     Unable to retrieve inventory information. Please check your                   |
|                     connection and try again.                                                     |
|                                                                                                    |
|                              Error: INVENTORY_FETCH_FAILED                                        |
|                                                                                                    |
|                                                                                                    |
|                              [Retry]    [Contact Support]                                         |
|                                                                                                    |
|                                                                                                    |
+--------------------------------------------------------------------------------------------------+
```

---

## Key Components

### 1. KPI Summary Cards (4 Cards)

| Card | Data Source | Calculation | Click Action |
|------|-------------|-------------|--------------|
| **Total LP Count** | license_plates table | COUNT(*) WHERE status NOT IN ('consumed') | Navigate to License Plates list |
| **Total Value** | license_plates + products | SUM(quantity * product.unit_cost) WHERE status NOT IN ('consumed') | View by category breakdown |
| **Expiring Soon** | license_plates table | COUNT(*) WHERE expiry_date BETWEEN today() AND today() + 30 days AND status = 'available' | Switch to Expiring Items tab |
| **Expired** | license_plates table | COUNT(*) WHERE expiry_date < today() AND status = 'available' | Switch to Expiring Items tab with expired filter |

### 2. Tab Navigation

| Tab | Description | Key Features |
|-----|-------------|--------------|
| **Overview** | Inventory summary with grouping | Group by Product/Location/Warehouse toggle, filters, export |
| **Aging Report** | FIFO/FEFO aging analysis | Aging buckets, chart visualization, oldest stock list |
| **Expiring Items** | LPs approaching expiry | Configurable threshold slider, color-coded urgency, bulk actions |
| **Cycle Counts** | Inventory count management | Create/execute/complete counts, variance tracking |
| **Adjustments** | Stock adjustment history | Reason codes, approval workflow, audit trail |

### 3. Grouping Toggle (Overview Tab)

| Grouping | Description | Columns |
|----------|-------------|---------|
| **By Product** | Summary per product | Product, Available Qty, Reserved Qty, Blocked Qty, Total Qty, LP Count, Avg Age |
| **By Location** | Summary per location | Location, Warehouse, Product Count, Total Qty, LP Count, Utilization |
| **By Warehouse** | Summary per warehouse | Warehouse, Location Count, Product Count, Total Qty, LP Count, Value |

### 4. Aging Buckets Configuration

| Bucket | Days Range | Status | Color | Action |
|--------|------------|--------|-------|--------|
| 0-7 days | 0-7 | Fresh | Green | View LPs |
| 8-30 days | 8-30 | Good | Green | View LPs |
| 31-90 days | 31-90 | Aging | Yellow | View LPs, Prioritize |
| 90+ days | 91+ | Old | Red | View LPs, Alert Manager |

### 5. Expiry Indicators

| Condition | Days | Color | Badge | Priority |
|-----------|------|-------|-------|----------|
| Expired | < 0 | Red (#B91C1C) | EXPIRED | Urgent - Dispose |
| Critical | 0-7 | Orange (#EA580C) | < 7 days | Critical - Use First |
| Warning | 8-14 | Yellow (#CA8A04) | 7-14 days | Warning - Schedule |
| Monitor | 15-30 | Green (#16A34A) | 15-30 days | Monitor |

### 6. Cycle Count Types

| Type | Description | Scope |
|------|-------------|-------|
| **Full** | Count entire warehouse | All LPs in warehouse |
| **Partial** | Count specific area | Zone, location group, or product category |
| **Cycle** | Rotating count | ABC classification rotation |

### 7. Adjustment Reason Codes

| Code | Description | Approval Required |
|------|-------------|-------------------|
| damage | Physical damage to goods | No (if decrease <= 10%) |
| counting_error | Discrepancy found during count | No (if variance <= 5%) |
| expired | Product past expiry date | No |
| theft | Suspected or confirmed theft | Yes (always) |
| quality_issue | Failed QA inspection | Yes (always) |
| other | Other reason (requires notes) | Yes (if increase or decrease > 10%) |

---

## Main Actions

### Primary Actions (Header)

| Action | Location | Description |
|--------|----------|-------------|
| **New Adjustment** | Header button | Opens stock adjustment creation modal |
| **Export** | Header button | Exports current view to CSV/Excel |

### Tab-Specific Actions

#### Overview Tab
- **View Available LPs** - Navigate to LP list filtered by product + status=available
- **View Reserved LPs** - Navigate to LP list filtered by product + status=reserved
- **View Blocked LPs** - Navigate to LP list filtered by product + status=blocked

#### Aging Report Tab
- **View LPs** - Navigate to LP list filtered by age bucket
- **Prioritize** - Add to priority consumption list
- **Alert Manager** - Send notification about old stock
- **Export Report** - Download aging report as PDF/CSV

#### Expiring Items Tab
- **Move to Quarantine** - Bulk move selected LPs to quarantine location
- **Create Adjustment** - Bulk create adjustment for selected LPs
- **Print List** - Print expiring items list for warehouse team
- **Dispose** - Create disposal adjustment (qty to 0)
- **Use First** - Mark LP for priority consumption
- **Reserve** - Create reservation for immediate use
- **Schedule** - Add to production schedule

#### Cycle Counts Tab
- **New Cycle Count** - Opens cycle count creation modal
- **Start Count** - Begin counting (changes status to in_progress)
- **Continue Count** - Resume in-progress count
- **View Report** - View completed count report with variances
- **Approve Adjustments** - Approve variance adjustments
- **Export Count Sheet** - Download count sheet as PDF

#### Adjustments Tab
- **New Adjustment** - Opens adjustment creation modal
- **View Details** - View full adjustment record
- **View LP** - Navigate to LP detail page
- **Approve** - Approve pending adjustment
- **Reject** - Reject pending adjustment with reason
- **Reverse** - Create reversal adjustment (requires approval)

---

## States

| State | Description | Elements Shown |
|-------|-------------|----------------|
| **Loading** | Initial page load | Skeleton cards (4), skeleton tabs, skeleton table rows |
| **Empty** | No LPs exist in org | Empty state illustration, CTA buttons, tips |
| **Success** | Data loaded | KPI cards, tabs, active tab content, pagination |
| **Filtered Empty** | Filters return no results | "No items match your filters" message, clear filters button |
| **Error** | API failure | Error message, retry button, support link |

---

## Data Fields

### Overview - By Product

| Field | Source | Display | Notes |
|-------|--------|---------|-------|
| product_id | products.id | Internal | UUID |
| product_code | products.code | "RM-COCOA-001" | Unique code |
| product_name | products.name | "Cocoa Mass" | Display name |
| product_category | products.category | "Raw Materials" | Category |
| available_qty | SUM(lp.quantity WHERE status='available') | "180.00 kg" | Available stock |
| available_pct | available_qty / total_qty * 100 | "63%" | Percentage |
| reserved_qty | SUM(lp.quantity WHERE status='reserved') | "75.00 kg" | Reserved stock |
| reserved_pct | reserved_qty / total_qty * 100 | "26%" | Percentage |
| blocked_qty | SUM(lp.quantity WHERE status='blocked') | "30.00 kg" | Blocked stock |
| blocked_pct | blocked_qty / total_qty * 100 | "11%" | Percentage |
| total_qty | SUM(lp.quantity) | "285.00 kg" | Total stock |
| lp_count | COUNT(lp.id) | "12" | Number of LPs |
| avg_age_days | AVG(today - lp.created_at) | "45" | Average age |
| uom | products.uom | "kg" | Unit of measure |

### Aging Report

| Field | Source | Display | Notes |
|-------|--------|---------|-------|
| age_bucket | Calculated | "0-7 days" | Based on created_at |
| lp_count | COUNT(*) | "2,145" | LPs in bucket |
| total_qty | SUM(quantity) | "180,000 kg" | Quantity in bucket |
| total_value | SUM(qty * unit_cost) | "$410,250" | Value in bucket |
| pct_of_total | bucket_qty / total_qty * 100 | "33%" | Percentage |
| status | Derived | "Fresh", "Good", "Aging", "Old" | Status label |

### Expiring Items

| Field | Source | Display | Notes |
|-------|--------|---------|-------|
| lp_id | license_plates.id | Internal | UUID |
| lp_number | license_plates.lp_number | "LP-2025-1234" | LP identifier |
| batch_number | license_plates.batch_number | "BCH-890" | Batch |
| product_name | products.name | "Cocoa Mass" | Product |
| product_code | products.code | "RM-COCOA-001" | Code |
| quantity | license_plates.quantity | "50.0 kg" | Quantity |
| location_code | locations.location_code | "A-01-02" | Location |
| warehouse_name | warehouses.name | "Main WH" | Warehouse |
| expiry_date | license_plates.expiry_date | "2026-01-10" | Expiry |
| days_until_expiry | expiry_date - today() | "5", "-3" | Days (negative = expired) |
| urgency | Calculated | "expired", "critical", "warning", "monitor" | Color indicator |

### Cycle Counts

| Field | Source | Display | Notes |
|-------|--------|---------|-------|
| count_id | cycle_counts.id | Internal | UUID |
| count_number | cycle_counts.count_number | "CC-2026-00012" | Identifier |
| count_type | cycle_counts.count_type | "Full", "Partial", "Cycle" | Type |
| warehouse_name | warehouses.name | "Main WH" | Warehouse |
| scope | Derived | "Zone A", "All Locations" | Count scope |
| lp_count | COUNT(cycle_count_items) | "125" | LPs to count |
| scheduled_date | cycle_counts.scheduled_date | "2026-01-20" | Scheduled |
| status | cycle_counts.status | "planned", "in_progress", "completed" | Status |
| counted_qty | COUNT WHERE counted_qty IS NOT NULL | "87/150" | Progress |
| accuracy_pct | (total - variances) / total * 100 | "98.5%" | Accuracy |
| counter_name | users.full_name | "J. Smith" | Assigned counter |

### Adjustments

| Field | Source | Display | Notes |
|-------|--------|---------|-------|
| adjustment_id | stock_moves.id | Internal | UUID (move_type='adjustment') |
| adjustment_date | stock_moves.created_at | "2026-01-15 10:30" | Date/time |
| lp_number | license_plates.lp_number | "LP-2025-1234" | LP |
| batch_number | license_plates.batch_number | "BCH-890" | Batch |
| product_name | products.name | "Cocoa Mass" | Product |
| location_code | locations.location_code | "A-01-02" | Location |
| original_qty | Calculated from history | "100.0 kg" | Before adjustment |
| new_qty | license_plates.quantity | "75.0 kg" | After adjustment |
| variance_qty | new_qty - original_qty | "-25.0 kg" | Change |
| variance_value | variance_qty * unit_cost | "-$568" | Value change |
| reason_code | stock_moves.reason | "damage" | Reason |
| adjusted_by | users.full_name | "J. Smith" | User |
| status | Derived | "approved", "pending", "rejected" | Approval status |

---

## API Endpoints

### Inventory Summary (Overview Tab)

```
GET /api/warehouse/inventory?grouping=product&warehouse_id={uuid}&location_id={uuid}&category={category}&status=active&page=1&limit=50

Response:
{
  "success": true,
  "data": {
    "summary": {
      "total_lp_count": 8452,
      "total_qty": 547500.00,
      "total_value": 1245670.00,
      "expiring_soon_count": 47,
      "expired_count": 5
    },
    "items": [
      {
        "product_id": "uuid-cocoa",
        "product_code": "RM-COCOA-001",
        "product_name": "Cocoa Mass",
        "product_category": "Raw Materials",
        "uom": "kg",
        "available_qty": 180.00,
        "available_pct": 63,
        "reserved_qty": 75.00,
        "reserved_pct": 26,
        "blocked_qty": 30.00,
        "blocked_pct": 11,
        "total_qty": 285.00,
        "lp_count": 12,
        "avg_age_days": 45
      },
      ...
    ]
  },
  "meta": {
    "total": 45,
    "page": 1,
    "limit": 50,
    "pages": 1
  }
}
```

### Aging Report

```
GET /api/warehouse/inventory/aging?mode=fifo&warehouse_id={uuid}&product_id={uuid}&category={category}

Response:
{
  "success": true,
  "data": {
    "mode": "fifo",
    "buckets": [
      {
        "bucket": "0-7 days",
        "min_days": 0,
        "max_days": 7,
        "lp_count": 2145,
        "total_qty": 180000.00,
        "uom": "kg",
        "total_value": 410250.00,
        "pct_of_total": 33,
        "status": "fresh",
        "color": "green"
      },
      {
        "bucket": "8-30 days",
        "min_days": 8,
        "max_days": 30,
        "lp_count": 3420,
        "total_qty": 215000.00,
        "uom": "kg",
        "total_value": 486500.00,
        "pct_of_total": 39,
        "status": "good",
        "color": "green"
      },
      {
        "bucket": "31-90 days",
        "min_days": 31,
        "max_days": 90,
        "lp_count": 2345,
        "total_qty": 120000.00,
        "uom": "kg",
        "total_value": 272000.00,
        "pct_of_total": 22,
        "status": "aging",
        "color": "yellow"
      },
      {
        "bucket": "90+ days",
        "min_days": 91,
        "max_days": null,
        "lp_count": 542,
        "total_qty": 32500.00,
        "uom": "kg",
        "total_value": 76920.00,
        "pct_of_total": 6,
        "status": "old",
        "color": "red"
      }
    ],
    "oldest_stock": [
      {
        "product_name": "Cocoa Mass",
        "lp_number": "LP-2024-08-00123",
        "age_days": 134,
        "quantity": 50.00,
        "uom": "kg",
        "location_code": "A-01-02"
      },
      ...
    ],
    "totals": {
      "lp_count": 8452,
      "total_qty": 547500.00,
      "total_value": 1245670.00
    }
  }
}
```

### Expiring Items

```
GET /api/warehouse/inventory/expiring?days=30&warehouse_id={uuid}&product_id={uuid}&qa_status={status}&page=1&limit=50

Response:
{
  "success": true,
  "data": {
    "summary": {
      "expired_count": 5,
      "critical_count": 12,
      "warning_count": 15,
      "monitor_count": 20,
      "total_count": 52
    },
    "items": [
      {
        "lp_id": "uuid-lp-1234",
        "lp_number": "LP-2025-1234",
        "batch_number": "BCH-890",
        "product_id": "uuid-cocoa",
        "product_code": "RM-COCOA-001",
        "product_name": "Cocoa Mass",
        "quantity": 50.00,
        "uom": "kg",
        "location_code": "A-01-02",
        "warehouse_name": "Main WH",
        "expiry_date": "2026-01-10",
        "days_until_expiry": -5,
        "urgency": "expired"
      },
      ...
    ]
  },
  "meta": {
    "total": 52,
    "page": 1,
    "limit": 50,
    "pages": 2
  }
}
```

### Cycle Counts List

```
GET /api/warehouse/cycle-counts?warehouse_id={uuid}&status={status}&type={type}&page=1&limit=20

Response:
{
  "success": true,
  "data": {
    "summary": {
      "planned_count": 5,
      "in_progress_count": 2,
      "completed_count": 23,
      "with_variances_count": 8
    },
    "counts": [
      {
        "id": "uuid-count-012",
        "count_number": "CC-2026-00012",
        "count_type": "cycle",
        "warehouse_id": "uuid-wh-main",
        "warehouse_name": "Main WH",
        "scope": "Zone A",
        "scope_details": {
          "locations": 15,
          "lp_count": 125
        },
        "scheduled_date": "2026-01-20",
        "status": "planned",
        "created_by": "uuid-user-admin",
        "created_by_name": "Admin"
      },
      ...
    ]
  },
  "meta": {
    "total": 30,
    "page": 1,
    "limit": 20,
    "pages": 2
  }
}
```

### Create Cycle Count

```
POST /api/warehouse/cycle-counts
Body: {
  "count_type": "cycle",
  "warehouse_id": "uuid-wh-main",
  "scope_type": "zone",
  "scope_ids": ["uuid-zone-a"],
  "scheduled_date": "2026-01-20",
  "counter_id": "uuid-user-jsmith"
}

Response:
{
  "success": true,
  "data": {
    "id": "uuid-count-012",
    "count_number": "CC-2026-00012",
    "count_type": "cycle",
    "warehouse_name": "Main WH",
    "scope": "Zone A",
    "lp_count": 125,
    "scheduled_date": "2026-01-20",
    "status": "planned"
  }
}
```

### Stock Adjustment List

```
GET /api/warehouse/inventory/adjust?date_from={date}&date_to={date}&reason={code}&adjusted_by={uuid}&warehouse_id={uuid}&status={status}&page=1&limit=20

Response:
{
  "success": true,
  "data": {
    "summary": {
      "total_adjustments": 45,
      "qty_increased": 1250.00,
      "qty_increased_value": 28500.00,
      "qty_decreased": 890.00,
      "qty_decreased_value": 19800.00,
      "pending_approval": 3
    },
    "adjustments": [
      {
        "id": "uuid-adj-001",
        "adjustment_date": "2026-01-15T10:30:00Z",
        "lp_id": "uuid-lp-1234",
        "lp_number": "LP-2025-1234",
        "batch_number": "BCH-890",
        "product_id": "uuid-cocoa",
        "product_code": "RM-COCOA-001",
        "product_name": "Cocoa Mass",
        "location_code": "A-01-02",
        "warehouse_name": "Main WH",
        "original_qty": 100.00,
        "new_qty": 75.00,
        "variance_qty": -25.00,
        "uom": "kg",
        "variance_value": -568.00,
        "reason_code": "damage",
        "reason_notes": "Water damage from leak",
        "adjusted_by_id": "uuid-user-jsmith",
        "adjusted_by_name": "J. Smith",
        "status": "approved",
        "approved_by_name": "Manager"
      },
      ...
    ]
  },
  "meta": {
    "total": 45,
    "page": 1,
    "limit": 20,
    "pages": 3
  }
}
```

### Create Stock Adjustment

```
POST /api/warehouse/inventory/adjust
Body: {
  "lp_id": "uuid-lp-1234",
  "new_qty": 75.00,
  "reason_code": "damage",
  "reason_notes": "Water damage from leak"
}

Response:
{
  "success": true,
  "data": {
    "id": "uuid-adj-001",
    "lp_number": "LP-2025-1234",
    "original_qty": 100.00,
    "new_qty": 75.00,
    "variance_qty": -25.00,
    "reason_code": "damage",
    "status": "approved",
    "requires_approval": false
  }
}
```

### Approve/Reject Adjustment

```
POST /api/warehouse/inventory/adjust/:id/approve
Body: {
  "action": "approve",
  "notes": "Verified damage on site"
}

Response:
{
  "success": true,
  "data": {
    "id": "uuid-adj-003",
    "status": "approved",
    "approved_by": "uuid-manager",
    "approved_at": "2026-01-15T11:00:00Z"
  }
}
```

---

## Permissions

| Role | View Inventory | View Aging | View Expiring | Create Count | Execute Count | Create Adjust | Approve Adjust | Export |
|------|----------------|------------|---------------|--------------|---------------|---------------|----------------|--------|
| Admin | Yes | Yes | Yes | Yes | Yes | Yes | Yes | Yes |
| Warehouse Manager | Yes | Yes | Yes | Yes | Yes | Yes | Yes | Yes |
| Warehouse Operator | Yes | Yes | Yes | No | Yes | Limited | No | Yes |
| QA Inspector | Yes | Yes | Yes | No | No | Limited | No | Yes |
| Production Manager | Yes | Yes | Yes | No | No | No | No | Yes |
| Viewer | Yes | Yes | Yes | No | No | No | No | No |

**Limited adjustments**: Can only decrease qty, max 5%, specific reason codes (damage, counting_error)

---

## Validation

| Field | Rule | Error Message |
|-------|------|---------------|
| Grouping | Valid enum (product, location, warehouse) | "Invalid grouping type" |
| Warehouse filter | Valid UUID or 'all' | "Invalid warehouse filter" |
| Location filter | Valid UUID or 'all' | "Invalid location filter" |
| Aging mode | fifo or fefo | "Invalid aging mode" |
| Expiry days | 1-365 | "Days must be between 1 and 365" |
| Cycle count type | full, partial, or cycle | "Invalid count type" |
| Adjustment qty | >= 0 | "Quantity cannot be negative" |
| Adjustment reason | Valid reason code | "Invalid reason code" |
| Adjustment notes | Required if reason='other' | "Notes required for 'other' reason" |
| Page | >= 1 | "Invalid page number" |
| Limit | 1-100 | "Limit must be between 1 and 100" |

---

## Business Rules

### Inventory Grouping

```typescript
// By Product grouping
SELECT
  p.id, p.code, p.name, p.category,
  SUM(CASE WHEN lp.status = 'available' THEN lp.quantity ELSE 0 END) as available_qty,
  SUM(CASE WHEN lp.status = 'reserved' THEN lp.quantity ELSE 0 END) as reserved_qty,
  SUM(CASE WHEN lp.status = 'blocked' THEN lp.quantity ELSE 0 END) as blocked_qty,
  SUM(lp.quantity) as total_qty,
  COUNT(lp.id) as lp_count,
  AVG(EXTRACT(DAY FROM (CURRENT_DATE - lp.created_at))) as avg_age_days
FROM license_plates lp
JOIN products p ON lp.product_id = p.id
WHERE lp.org_id = ? AND lp.status != 'consumed'
GROUP BY p.id, p.code, p.name, p.category
ORDER BY total_qty DESC
```

### Aging Calculation

```typescript
// FIFO mode - age by receipt date
age_days = CURRENT_DATE - lp.created_at

// FEFO mode - age by expiry (inverted - days until expiry)
days_until_expiry = lp.expiry_date - CURRENT_DATE
// For FEFO report, show items with soonest expiry first
```

### Expiry Urgency Rules

```typescript
function getExpiryUrgency(daysUntilExpiry: number): ExpiryUrgency {
  if (daysUntilExpiry < 0) {
    return { level: 'expired', color: 'red', badge: 'EXPIRED', action: 'Dispose' };
  } else if (daysUntilExpiry <= 7) {
    return { level: 'critical', color: 'orange', badge: '< 7 days', action: 'Use First' };
  } else if (daysUntilExpiry <= 14) {
    return { level: 'warning', color: 'yellow', badge: '7-14 days', action: 'Schedule' };
  } else if (daysUntilExpiry <= 30) {
    return { level: 'monitor', color: 'green', badge: '15-30 days', action: 'Monitor' };
  }
  return { level: 'ok', color: 'none', badge: null, action: null };
}
```

### Adjustment Approval Rules

```typescript
function requiresApproval(originalQty: number, newQty: number, reasonCode: string): boolean {
  const variance = newQty - originalQty;
  const variancePct = Math.abs(variance) / originalQty * 100;

  // Always require approval for increases
  if (variance > 0) return true;

  // Always require approval for theft/quality
  if (['theft', 'quality_issue'].includes(reasonCode)) return true;

  // Require approval for decreases > 10%
  if (variancePct > 10) return true;

  return false;
}
```

### Cycle Count Variance Detection

```typescript
function detectVariance(expectedQty: number, countedQty: number): Variance {
  const variance = countedQty - expectedQty;
  const variancePct = expectedQty > 0 ? (variance / expectedQty) * 100 : 0;

  return {
    quantity: variance,
    percentage: variancePct,
    significant: Math.abs(variancePct) > 5, // 5% threshold
    requiresApproval: Math.abs(variancePct) > 10 // 10% requires manager approval
  };
}
```

---

## Accessibility

### Touch Targets
- All buttons: minimum 48x48dp
- Table row click area: full row height (72px)
- Tab buttons: 48dp height minimum
- Filter dropdowns: 48dp height
- Checkbox click area: 48x48dp

### Contrast
- Text on badges: 4.5:1 minimum
- Table text: 4.5:1 minimum
- Expiry indicators: 4.5:1 minimum (WCAG AA)
- Status badges: 3:1 minimum for non-text elements

### Screen Reader
- KPI cards: "Total License Plates card: 8,452 active license plates"
- Tabs: "Inventory browser tabs, 5 tabs, Overview tab selected"
- Grouping toggle: "Grouping options, By Product selected"
- Aging buckets: "Age 0 to 7 days: 2,145 license plates, 180,000 kilograms, 33 percent of total, status Fresh"
- Expiry badges: "License Plate LP-2025-1234, expired 5 days ago, urgent action required"
- Cycle count status: "Cycle count CC-2026-00012, status planned, scheduled January 20"

### Keyboard Navigation
- Tab: Move between interactive elements
- Enter: Activate button/link, select tab
- Space: Toggle checkbox, activate button
- Arrow keys: Navigate within dropdowns, switch tabs
- Escape: Close dropdown/modal
- Shift+Tab: Reverse navigation

### ARIA Attributes
- Tabs: role="tablist", role="tab" with aria-selected, aria-controls
- Table: role="table" with proper row/cell structure
- Status badges: role="status" aria-label="{status}"
- Expiry badges: role="alert" for expired items
- Progress indicators: role="progressbar" aria-valuenow aria-valuemax
- Filters: aria-expanded for dropdowns, aria-label for inputs

---

## Responsive Breakpoints

| Breakpoint | Layout | Changes |
|------------|--------|---------|
| Desktop (>1024px) | Full table with all columns | Full KPI cards (4 across), all tabs visible, all filters inline |
| Tablet (768-1024px) | Condensed table | 2x2 KPI grid, tabs scroll, primary filters visible |
| Mobile (<768px) | Card layout | Vertical KPI list, tabs horizontal scroll, filters in modal |

### Mobile-Specific
- Tabs become horizontal scroll with abbreviated labels
- Filters collapse into modal/drawer
- Table becomes card list
- Pagination becomes "Load More" button
- Bulk actions in bottom sheet
- Grouping toggle as dropdown

---

## Performance Notes

### Query Optimization
- Index on: `(org_id, status, created_at DESC)` for aging
- Index on: `(org_id, expiry_date, status)` for expiring items
- Index on: `(org_id, product_id, status)` for grouping
- Index on: `(org_id, warehouse_id, location_id)` for location grouping
- Materialized view for inventory summary (refresh every 5 min)

### Caching Strategy
```typescript
// Redis keys
'org:{orgId}:warehouse:inventory:summary'           // 60 sec TTL
'org:{orgId}:warehouse:inventory:by_product'        // 60 sec TTL
'org:{orgId}:warehouse:inventory:aging:{mode}'      // 60 sec TTL
'org:{orgId}:warehouse:inventory:expiring:{days}'   // 60 sec TTL
'org:{orgId}:warehouse:cycle-counts:list'           // 30 sec TTL
'org:{orgId}:warehouse:adjustments:list'            // 30 sec TTL
```

### Load Time Targets
- Initial page load (KPIs + Overview): <700ms
- Tab switch: <400ms
- Aging report calculation: <600ms
- Expiring items list: <500ms
- Cycle counts list: <400ms
- Adjustments list: <400ms
- Export generation: <3s for 10,000 records

---

## Reusable Components

The following existing warehouse components should be reused:

| Component | File | Usage |
|-----------|------|-------|
| LPStatusBadge | `components/warehouse/LPStatusBadge.tsx` | Status badges in tables |
| LPQAStatusBadge | `components/warehouse/LPQAStatusBadge.tsx` | QA status badges |
| LPExpiryIndicator | `components/warehouse/LPExpiryIndicator.tsx` | Expiry color indicators |
| LPKPICards | `components/warehouse/LPKPICards.tsx` | KPI card layout pattern |
| LPFilters | `components/warehouse/LPFilters.tsx` | Filter bar pattern |
| LPDataTable | `components/warehouse/LPDataTable.tsx` | Table component pattern |
| LPEmptyState | `components/warehouse/LPEmptyState.tsx` | Empty state layout |
| LPErrorState | `components/warehouse/LPErrorState.tsx` | Error state layout |
| LPSearchInput | `components/warehouse/LPSearchInput.tsx` | Search input with debounce |

### New Components to Create

| Component | Description |
|-----------|-------------|
| InventoryTabs | Tab navigation for 5 tabs |
| InventoryGroupingToggle | Radio group for product/location/warehouse |
| AgingBucketChart | Horizontal bar chart for aging distribution |
| AgingBucketTable | Table with aging bucket breakdown |
| ExpiryUrgencyBadge | Color-coded expiry urgency indicator |
| CycleCountStatusBadge | Status badge for cycle counts |
| CycleCountProgressBar | Progress indicator for in-progress counts |
| AdjustmentReasonBadge | Reason code badge with icon |
| AdjustmentApprovalButtons | Approve/Reject action buttons |
| CreateCycleCountModal | Modal for new cycle count |
| CreateAdjustmentModal | Modal for new adjustment |
| BulkExpiryActionsBar | Bulk action bar for expiring items |

---

## Testing Requirements

### Unit Tests
- KPI calculations (total LP count, total value, expiring soon, expired)
- Grouping logic (by product, by location, by warehouse)
- Aging bucket calculation (0-7, 8-30, 31-90, 90+ days)
- FIFO vs FEFO aging mode logic
- Expiry urgency calculation (expired, critical, warning, monitor)
- Adjustment approval rules (variance threshold, reason code)
- Cycle count variance detection (significant, requires approval)

### Integration Tests
- GET /api/warehouse/inventory with all grouping modes
- GET /api/warehouse/inventory/aging with FIFO/FEFO modes
- GET /api/warehouse/inventory/expiring with day thresholds
- GET /api/warehouse/cycle-counts with filters
- POST /api/warehouse/cycle-counts (create)
- GET /api/warehouse/inventory/adjust with filters
- POST /api/warehouse/inventory/adjust (create)
- POST /api/warehouse/inventory/adjust/:id/approve
- RLS policy enforcement (org_id isolation)
- Export CSV generation

### E2E Tests
- Page load with data shows all KPIs and Overview tab
- Tab navigation switches content correctly
- Grouping toggle changes table columns and data
- Aging report shows chart and bucket breakdown
- FIFO/FEFO toggle changes aging calculation
- Expiring items slider filters by days
- Color coding matches urgency level
- Bulk actions work for selected items
- Create cycle count modal workflow
- Start/Continue cycle count updates status
- Create adjustment modal workflow
- Approve/Reject adjustment updates status
- Export downloads CSV file
- Empty state shows correct message
- Error state shows retry button
- Responsive layout at all breakpoints

### Performance Tests
- Overview tab loads in <700ms with 10,000 LPs
- Aging report calculates in <600ms
- Expiring items filters in <500ms
- Tab switch responds in <400ms
- Export 10,000 records completes in <3s

---

## Quality Gates

Before handoff to FRONTEND-DEV:
- [x] All 5 states defined (Loading, Empty, Error, Success, Filtered Empty)
- [x] All 5 tabs wireframed (Overview, Aging, Expiring, Cycle Counts, Adjustments)
- [x] Responsive breakpoints documented (Desktop/Tablet/Mobile)
- [x] All API endpoints specified with request/response schemas
- [x] Accessibility checklist passed (touch targets, contrast, screen reader, keyboard, ARIA)
- [x] Performance targets defined
- [x] KPI cards defined (4 cards)
- [x] Grouping modes defined (3 modes: product/location/warehouse)
- [x] Aging buckets defined (4 buckets with FIFO/FEFO)
- [x] Expiry urgency levels defined (4 levels with colors)
- [x] Cycle count types defined (3 types: full/partial/cycle)
- [x] Adjustment reason codes defined (6 codes)
- [x] Approval rules documented
- [x] Reusable components identified
- [x] New components specified
- [x] Permissions matrix documented
- [x] Business rules documented
- [x] Validation rules defined

---

## Handoff to FRONTEND-DEV

```yaml
feature: Inventory Browser & Cycle Counts
story: WH-INV-001
prd_coverage: "WH-FR-023 (Cycle Count), WH-FR-024 (Stock Adjustment), Inventory Visibility"
approval_status:
  mode: "review_each"
  user_approved: false  # PENDING USER REVIEW
  screens_approved: []
  iterations_used: 0
deliverables:
  wireframe: docs/3-ARCHITECTURE/ux/wireframes/WH-INV-001-inventory-browser.md
  api_endpoints:
    - GET /api/warehouse/inventory (overview with grouping)
    - GET /api/warehouse/inventory/aging (FIFO/FEFO report)
    - GET /api/warehouse/inventory/expiring (expiring items list)
    - GET /api/warehouse/cycle-counts (cycle counts list)
    - POST /api/warehouse/cycle-counts (create count)
    - GET /api/warehouse/inventory/adjust (adjustments list)
    - POST /api/warehouse/inventory/adjust (create adjustment)
    - POST /api/warehouse/inventory/adjust/:id/approve
states_per_screen: [loading, empty, error, success, filtered_empty]
tabs: [overview, aging_report, expiring_items, cycle_counts, adjustments]
breakpoints:
  mobile: "<768px (card layout, load more, filters in modal)"
  tablet: "768-1024px (condensed table, 2x2 KPI grid)"
  desktop: ">1024px (full table, 4 KPI cards)"
accessibility:
  touch_targets: "48x48dp minimum"
  contrast: "4.5:1 minimum (WCAG 2.1 AA)"
  aria_roles: "tablist, tab, table, status, alert, progressbar"
  keyboard_nav: "Tab, Enter, Space, Arrow keys, Escape"
performance_targets:
  initial_load: "<700ms"
  tab_switch: "<400ms"
  aging_calculation: "<600ms"
  expiring_filter: "<500ms"
  export_generation: "<3s for 10,000 records"
key_features:
  - 5 tabs (Overview, Aging Report, Expiring Items, Cycle Counts, Adjustments)
  - 4 KPI cards (Total LPs, Total Value, Expiring Soon, Expired)
  - 3 grouping modes (By Product, By Location, By Warehouse)
  - 4 aging buckets (0-7d, 8-30d, 31-90d, 90+d)
  - 2 aging modes (FIFO by receipt, FEFO by expiry)
  - 4 expiry urgency levels (Expired, Critical, Warning, Monitor)
  - Configurable expiry threshold slider (7-90 days)
  - 3 cycle count types (Full, Partial, Cycle)
  - 6 adjustment reason codes with approval workflow
  - Bulk actions for expiring items
  - Export to CSV/Excel
reusable_components:
  - LPStatusBadge
  - LPQAStatusBadge
  - LPExpiryIndicator
  - LPKPICards
  - LPFilters
  - LPDataTable
  - LPEmptyState
  - LPErrorState
  - LPSearchInput
related_screens:
  - WH-001: Warehouse Dashboard
  - WH-002: License Plates List
  - WH-006: Stock Movements List
database_tables:
  - license_plates (primary)
  - products (JOIN)
  - locations (JOIN)
  - warehouses (JOIN)
  - cycle_counts (cycle counts tab)
  - cycle_count_items (cycle count items)
  - stock_moves (adjustments via move_type='adjustment')
  - users (JOINs)
```

---

**Status**: Ready for User Review
**Approval Mode**: review_each (default)
**User Approved**: Pending
**Iterations**: 0 of 3
**Estimated Effort**: 16-20 hours (complex multi-tab page with 5 major features)
**Quality Target**: 95%+
**PRD Coverage**: WH-FR-023, WH-FR-024, Inventory Visibility (100%)
**Wireframe Length**: ~1,400 lines

---

## Notes

### Design Decisions

1. **Tab-based Organization**: Consolidated 5 related features into tabs instead of separate pages for better UX and reduced navigation

2. **Grouping Toggle**: Overview tab supports 3 grouping modes to answer different inventory questions (what products do we have vs where is inventory vs warehouse comparison)

3. **Dual Aging Modes**: FIFO (receipt date) and FEFO (expiry date) aging for different use cases - FIFO for general rotation, FEFO for perishables

4. **Color-coded Expiry**: 4-level urgency system (expired/critical/warning/monitor) with consistent color scheme for quick visual identification

5. **Configurable Expiry Threshold**: Slider allows users to adjust "expiring soon" definition (7-90 days) based on product shelf life

6. **Approval Workflow**: Adjustments require approval when increasing qty, >10% decrease, or sensitive reasons (theft/quality)

7. **Component Reuse**: Leverages 9 existing warehouse components for consistency and faster development

8. **Export Options**: CSV and Excel export on each tab for reporting and offline analysis

### Future Enhancements

- **Real-time Updates**: WebSocket for inventory changes
- **Inventory Forecasting**: Predict when items will be needed based on production schedule
- **Automated Cycle Count Scheduling**: ABC classification with automatic rotation
- **Mobile Scanner Integration**: Direct link to scanner workflows
- **Alerts & Notifications**: Email/push for expiring items and low stock
- **Custom Aging Buckets**: User-configurable age ranges
- **Inventory Analytics Dashboard**: Trends, turnover rates, dead stock analysis
- **Integration with Quality Module**: Link QA inspections to adjustments
