# 10.17 - Bottleneck Analysis

**Priority**: P1
**Story Points**: M (Medium)
**Type**: fullstack
**Phase**: 3
**Model**: OPUS

**State:** ready
**Estimate:** M (3-4 days)
**Primary PRD:** `docs/1-BASELINE/product/modules/oee.md` (FR-OEE-024)

---

## Goal

Identify production line bottlenecks by analyzing operation cycle times, machine utilization, and WIP (work-in-progress). Highlight slowest operations constraining throughput and recommend capacity improvements.

---

## User Story

As a **Production Planner**, I want to **identify bottleneck operations on each line** so that **I can optimize line balance and increase overall throughput**.

---

## Scope

- Bottleneck identification (operation with longest cycle time or lowest capacity)
- Line balance analysis (cycle time comparison across operations)
- Constraint analysis (Theory of Constraints)
- Capacity utilization by operation
- Bottleneck impact calculation (potential throughput improvement)
- GET /api/oee/analytics/bottlenecks
- Bottleneck visualization (line diagram with cycle times)

---

## Acceptance Criteria

```gherkin
Scenario: Identify line bottleneck
  Given production line with 4 operations:
    | Operation | Cycle Time | Capacity |
    | Mixing | 60 sec/unit | 60 units/hr |
    | Filling | 45 sec/unit | 80 units/hr |
    | Labeling | 90 sec/unit | 40 units/hr |
    | Packing | 50 sec/unit | 72 units/hr |
  When analyzing bottleneck
  Then bottleneck = Labeling (90 sec, slowest)
  And line capacity constrained to 40 units/hr
  And message: "Labeling is the bottleneck (90s). If improved to 60s, line capacity increases to 60 units/hr (+50%)"

Scenario: Line balance visualization
  Given operations with cycle times
  When viewing line balance diagram
  Then horizontal bar chart shows:
    - Each operation as bar (length = cycle time)
    - Bottleneck highlighted in red
    - Target cycle time line (dashed)
  And imbalance % calculated
```

---

## Deliverables

- [ ] Bottleneck analysis algorithm
- [ ] Line balance API endpoints
- [ ] Bottleneck visualization component
- [ ] Capacity impact calculator
- [ ] Bottleneck analysis page

---

**Lines**: ~180
**Phase**: 3
