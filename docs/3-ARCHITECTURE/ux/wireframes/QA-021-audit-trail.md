# QA-021: Audit Trail Reports

**Module**: Quality Management
**Feature**: Audit Trail Reports & Change Tracking
**Status**: Ready for Review
**Last Updated**: 2025-12-15

---

## ASCII Wireframe

### Success State (Desktop)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Quality > Audit Trail                                              [ğŸ” Compliance] [ğŸ“¥ Export â–¼]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                                        â”‚
â”‚  ğŸ“‹ Audit Trail Reports                                                        [Help] [Legend â“˜]     â”‚
â”‚                                                                                                        â”‚
â”‚  Advanced Filters:                                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ [Entity Type â–¼]  [Date Range â–¼]  [User â–¼]  [Action Type â–¼]  [Search: entity ID or name]    â”‚    â”‚
â”‚  â”‚ All              Last 30 days     All       All              [        Scan        ]  [Clear] â”‚    â”‚
â”‚  â”‚                                                              [Apply Filters]                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ“Š Audit Log Results: 2,347 records found (showing 1-50)                 [< Prev] [Next >]   â”‚  â”‚
â”‚  â”‚                                                                                                 â”‚  â”‚
â”‚  â”‚ Timestamp          â”‚ User           â”‚ Entity Type   â”‚ Entity ID    â”‚ Action  â”‚ Field Changed   â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ 2025-12-15 14:32   â”‚ Jane Doe       â”‚ Inspection    â”‚ INSP-001234  â”‚ Update  â”‚ Result         â”‚  â”‚
â”‚  â”‚ (14 sec ago)       â”‚ QA Inspector   â”‚               â”‚              â”‚         â”‚ (Passed)       â”‚  â”‚
â”‚  â”‚ [View Changes â–¼]   â”‚ IP: 192.168.1. â”‚               â”‚              â”‚         â”‚ Change Reason: â”‚  â”‚
â”‚  â”‚                    â”‚ Device: Chrome â”‚               â”‚              â”‚         â”‚ Retest OK      â”‚  â”‚
â”‚  â”‚                                                                                                 â”‚  â”‚
â”‚  â”‚ 2025-12-15 14:20   â”‚ John Smith     â”‚ NCR           â”‚ NCR-00567    â”‚ Create  â”‚ N/A            â”‚  â”‚
â”‚  â”‚ (12 min ago)       â”‚ QA Manager     â”‚               â”‚              â”‚         â”‚ Status: Open   â”‚  â”‚
â”‚  â”‚ [View Changes â–¼]   â”‚ IP: 10.0.0.52  â”‚               â”‚              â”‚         â”‚ Priority: High â”‚  â”‚
â”‚  â”‚                    â”‚ Device: Safari â”‚               â”‚              â”‚         â”‚ Reason: Reqd   â”‚  â”‚
â”‚  â”‚                                                                                                 â”‚  â”‚
â”‚  â”‚ 2025-12-15 13:45   â”‚ Sarah Wilson   â”‚ CCP Spec      â”‚ CCP-003      â”‚ Approve â”‚ Approved By    â”‚  â”‚
â”‚  â”‚ (47 min ago)       â”‚ Technical      â”‚               â”‚              â”‚         â”‚ Document Ref:  â”‚  â”‚
â”‚  â”‚ [View Changes â–¼]   â”‚ Officer        â”‚               â”‚              â”‚         â”‚ DOC-2025-0452  â”‚  â”‚
â”‚  â”‚ [Copy Details]     â”‚ IP: 172.16.0.1 â”‚               â”‚              â”‚         â”‚                â”‚  â”‚
â”‚  â”‚                    â”‚ Device: Edge   â”‚               â”‚              â”‚         â”‚                â”‚  â”‚
â”‚  â”‚                                                                                                 â”‚  â”‚
â”‚  â”‚ 2025-12-15 13:30   â”‚ Mike Johnson   â”‚ Quality Hold  â”‚ HOLD-00045   â”‚ Delete  â”‚ All fields     â”‚  â”‚
â”‚  â”‚ (1 hour ago)       â”‚ QA Manager     â”‚               â”‚              â”‚         â”‚ Deletion Req:  â”‚  â”‚
â”‚  â”‚ [View Changes â–¼]   â”‚ IP: 192.168.5. â”‚               â”‚              â”‚         â”‚ REQ-2025-1001  â”‚  â”‚
â”‚  â”‚                    â”‚ Device: Mobile â”‚               â”‚              â”‚         â”‚                â”‚  â”‚
â”‚  â”‚                                                                                                 â”‚  â”‚
â”‚  â”‚ 2025-12-15 12:15   â”‚ Lisa Brown     â”‚ CoA           â”‚ CoA-20250234 â”‚ Update  â”‚ Test Result    â”‚  â”‚
â”‚  â”‚ (2 hours ago)      â”‚ Lab Tech       â”‚               â”‚              â”‚         â”‚ Pass/Fail      â”‚  â”‚
â”‚  â”‚ [View Changes â–¼]   â”‚ IP: 10.5.2.78  â”‚               â”‚              â”‚         â”‚ Change Reason: â”‚  â”‚
â”‚  â”‚                    â”‚ Device: Windowsâ”‚               â”‚              â”‚         â”‚ Retest Value   â”‚  â”‚
â”‚  â”‚                                                                                                 â”‚  â”‚
â”‚  â”‚ 2025-12-15 11:00   â”‚ Admin User     â”‚ Op Checkpoint â”‚ OP-CHK-234   â”‚ Update  â”‚ Result         â”‚  â”‚
â”‚  â”‚ (3 hours ago)      â”‚ Administrator  â”‚               â”‚              â”‚         â”‚ Old: Failed,   â”‚  â”‚
â”‚  â”‚ [View Changes â–¼]   â”‚ IP: 192.168.0. â”‚               â”‚              â”‚         â”‚ New: Passed    â”‚  â”‚
â”‚  â”‚ [Copy Details]     â”‚ Device: macOS  â”‚               â”‚              â”‚         â”‚ Approval: Doc- â”‚  â”‚
â”‚  â”‚                    â”‚                â”‚               â”‚              â”‚         â”‚ 2025-0401      â”‚  â”‚
â”‚  â”‚                                                                                                 â”‚  â”‚
â”‚  â”‚ (Scroll for 40 more records...)                                                                â”‚  â”‚
â”‚  â”‚                                                                                                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                                        â”‚
â”‚  Export Options:                                                                                     â”‚
â”‚  [ğŸ“Š Export CSV] [ğŸ“ˆ Export Excel] [ğŸ“„ Export PDF] [ğŸ” Compliance Report]                           â”‚
â”‚                                                                                                        â”‚
â”‚  â„¹ï¸ All changes are immutable and logged per FDA 21 CFR Part 11. Retention: 2 years minimum.        â”‚
â”‚                                                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Detail Modal (Drill-down)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Audit Detail: INSP-001234 (Inspection Change)                    [âœ•]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                            â”‚
â”‚  ğŸ“‹ Change Information                                                    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  â”‚ Entity: Inspection (INSP-001234)                                       â”‚
â”‚  â”‚ Type: Final Inspection - Chocolate Bar (Batch B-2025-456)              â”‚
â”‚  â”‚ Change Action: Update (Result field)                                   â”‚
â”‚  â”‚ Change Timestamp: 2025-12-15 14:32:45 UTC                             â”‚
â”‚  â”‚ Change Reason: Retest Confirmed - Sample Retested, Result Passed      â”‚
â”‚  â”‚                                                                         â”‚
â”‚  â”‚ User Information:                                                      â”‚
â”‚  â”‚ â”œâ”€ User: Jane Doe (jane.doe@company.com)                              â”‚
â”‚  â”‚ â”œâ”€ Role: QA Inspector                                                 â”‚
â”‚  â”‚ â”œâ”€ Department: Quality Assurance                                      â”‚
â”‚  â”‚ â”œâ”€ IP Address: 192.168.1.245                                          â”‚
â”‚  â”‚ â”œâ”€ Device: Chrome 131.0 (macOS 14.6.1)                               â”‚
â”‚  â”‚ â”œâ”€ Session ID: sess_ae8f9c2d1b4e                                      â”‚
â”‚  â”‚ â””â”€ Authenticated: Yes (SSO via Azure AD)                             â”‚
â”‚  â”‚                                                                         â”‚
â”‚  â”‚ Before/After Comparison:                                              â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â”‚ Field: Result                                                   â”‚   â”‚
â”‚  â”‚ â”‚ â”œâ”€ Old Value: ğŸ”´ Failed (Moisture: 3.2%, Spec: <2%)            â”‚   â”‚
â”‚  â”‚ â”‚ â”œâ”€ New Value: ğŸŸ¢ Passed (Moisture: 1.8%, Spec: <2%)            â”‚   â”‚
â”‚  â”‚ â”‚ â”œâ”€ Changed By: Jane Doe (jane.doe@company.com)                 â”‚   â”‚
â”‚  â”‚ â”‚ â”œâ”€ Timestamp: 2025-12-15 14:32:45                              â”‚   â”‚
â”‚  â”‚ â”‚ â””â”€ Reason: Retest Confirmed                                    â”‚   â”‚
â”‚  â”‚ â”‚                                                                   â”‚   â”‚
â”‚  â”‚ â”‚ Field: Inspector Notes                                          â”‚   â”‚
â”‚  â”‚ â”‚ â”œâ”€ Old Value: "Sample failed initial moisture test"            â”‚   â”‚
â”‚  â”‚ â”‚ â”œâ”€ New Value: "Retest sample passed. Original sample was..." â”‚   â”‚
â”‚  â”‚ â”‚ â”œâ”€ Changed By: Jane Doe (jane.doe@company.com)                 â”‚   â”‚
â”‚  â”‚ â”‚ â”œâ”€ Timestamp: 2025-12-15 14:32:45                              â”‚   â”‚
â”‚  â”‚ â”‚ â””â”€ Reason: Retest Confirmed                                    â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”‚                                                                         â”‚
â”‚  â”‚ Approval Chain (if applicable):                                       â”‚
â”‚  â”‚ â”œâ”€ Original Created By: John Doe (john.doe@company.com) - 14:00 UTC   â”‚
â”‚  â”‚ â”œâ”€ Updated By: Jane Doe (jane.doe@company.com) - 14:32 UTC            â”‚
â”‚  â”‚ â”œâ”€ Reviewed By: QA Manager (approval pending)                         â”‚
â”‚  â”‚ â””â”€ Final Approval: Required by System Administrator                   â”‚
â”‚  â”‚                                                                         â”‚
â”‚  â”‚ Compliance Metadata:                                                  â”‚
â”‚  â”‚ â”œâ”€ Audit Trail ID: audit_ae8f9c2d1b4e5f9a                            â”‚
â”‚  â”‚ â”œâ”€ Immutable: Yes (cannot be edited after 5 min)                      â”‚
â”‚  â”‚ â”œâ”€ Signature: HMAC-SHA256 verified âœ“                                  â”‚
â”‚  â”‚ â”œâ”€ Database Version: v3 (encrypted at rest)                           â”‚
â”‚  â”‚ â”œâ”€ Retention Until: 2027-12-15 (2+ years)                             â”‚
â”‚  â”‚ â”œâ”€ FDA 21 CFR Part 11: Compliant                                      â”‚
â”‚  â”‚ â””â”€ Archive Status: Not Archived (active database)                     â”‚
â”‚  â”‚                                                                         â”‚
â”‚  â”‚ Related Changes:                                                       â”‚
â”‚  â”‚ â”œâ”€ Prior Version: INSP-001234 (2025-12-15 14:10:22) [View â–¼]          â”‚
â”‚  â”‚ â””â”€ Next Change: None (current version)                                â”‚
â”‚  â”‚                                                                         â”‚
â”‚  Actions:                                                                 â”‚
â”‚  [ğŸ“‹ Copy Audit ID] [ğŸ”— Link to Record] [ğŸ“Š Export to CSV] [ğŸ” Verify] â”‚
â”‚                                                                            â”‚
â”‚                                                             [Close]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Success State (Tablet: 768-1024px)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Quality > Audit Trail           [ğŸ” Compliance] [ğŸ“¥ Export â–¼]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                    â”‚
â”‚  ğŸ“‹ Audit Trail Reports          [Help]                          â”‚
â”‚                                                                    â”‚
â”‚  Advanced Filters:                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ [Entity Type â–¼]  [Date Range â–¼]                              â”‚â”‚
â”‚  â”‚ [User â–¼]  [Action Type â–¼]                                    â”‚â”‚
â”‚  â”‚ [Search...]  [Apply] [Clear]                                 â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ ğŸ“Š Audit Log Results: 2,347 records (showing 1-25)           â”‚â”‚
â”‚  â”‚                                  [Prev] [Next]               â”‚â”‚
â”‚  â”‚                                                                â”‚â”‚
â”‚  â”‚ Timestamp    â”‚ User      â”‚ Entity    â”‚ Action  â”‚ Field        â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚ 2025-12-15   â”‚ Jane Doe  â”‚ Inspectn  â”‚ Update  â”‚ Result       â”‚â”‚
â”‚  â”‚ 14:32        â”‚ QA Insp.  â”‚ INSP-001  â”‚         â”‚ (Passed)     â”‚â”‚
â”‚  â”‚ [View â–¼]     â”‚ 192.x.x.x â”‚           â”‚         â”‚ Retest OK    â”‚â”‚
â”‚  â”‚              â”‚ Chrome    â”‚           â”‚         â”‚              â”‚â”‚
â”‚  â”‚                                                                â”‚â”‚
â”‚  â”‚ 2025-12-15   â”‚ John      â”‚ NCR       â”‚ Create  â”‚ Status:      â”‚â”‚
â”‚  â”‚ 14:20        â”‚ Smith     â”‚ NCR-00567 â”‚         â”‚ Open         â”‚â”‚
â”‚  â”‚ [View â–¼]     â”‚ 10.0.0.x  â”‚           â”‚         â”‚ Priority:    â”‚â”‚
â”‚  â”‚              â”‚ Safari    â”‚           â”‚         â”‚ High         â”‚â”‚
â”‚  â”‚                                                                â”‚â”‚
â”‚  â”‚ 2025-12-15   â”‚ Sarah     â”‚ CCP Spec  â”‚ Approve â”‚ Approved By: â”‚â”‚
â”‚  â”‚ 13:45        â”‚ Wilson    â”‚ CCP-003   â”‚         â”‚ Doc Ref      â”‚â”‚
â”‚  â”‚ [View â–¼]     â”‚ 172.x.x.x â”‚           â”‚         â”‚ DOC-2025-...â”‚â”‚
â”‚  â”‚              â”‚ Edge      â”‚           â”‚         â”‚              â”‚â”‚
â”‚  â”‚                                                                â”‚â”‚
â”‚  â”‚ (Scroll for more records...)                                  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                    â”‚
â”‚  Export Options:                                                 â”‚
â”‚  [ğŸ“Š CSV] [ğŸ“ˆ Excel] [ğŸ“„ PDF] [ğŸ” Compliance]                   â”‚
â”‚                                                                    â”‚
â”‚  â„¹ï¸ Immutable records, 2-year retention, FDA 21 CFR Part 11      â”‚
â”‚                                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Success State (Mobile: <768px)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  < Audit Trail      [ğŸ”] [ğŸ“¥ â–¼]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                      â”‚
â”‚  ğŸ“‹ Audit Trail Reports              â”‚
â”‚                                      â”‚
â”‚  Filters:                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Entity: All [Change â–¼]          â”‚  â”‚
â”‚  â”‚ Date: Last 30d [Change â–¼]       â”‚  â”‚
â”‚  â”‚ User: All [Change â–¼]            â”‚  â”‚
â”‚  â”‚ Action: All [Change â–¼]          â”‚  â”‚
â”‚  â”‚ Search: [       Search     ]    â”‚  â”‚
â”‚  â”‚ [Apply] [Clear]                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚  2,347 records found                 â”‚
â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 2025-12-15 14:32               â”‚  â”‚
â”‚  â”‚                                â”‚  â”‚
â”‚  â”‚ Inspection (INSP-001234)        â”‚  â”‚
â”‚  â”‚ Updated by Jane Doe             â”‚  â”‚
â”‚  â”‚ QA Inspector                    â”‚  â”‚
â”‚  â”‚                                â”‚  â”‚
â”‚  â”‚ Field Changed: Result           â”‚  â”‚
â”‚  â”‚ Old: Failed / New: Passed       â”‚  â”‚
â”‚  â”‚ Reason: Retest OK               â”‚  â”‚
â”‚  â”‚                                â”‚  â”‚
â”‚  â”‚ [View Details >]                â”‚  â”‚
â”‚  â”‚ [Copy ID]                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 2025-12-15 14:20               â”‚  â”‚
â”‚  â”‚                                â”‚  â”‚
â”‚  â”‚ NCR (NCR-00567)                 â”‚  â”‚
â”‚  â”‚ Created by John Smith           â”‚  â”‚
â”‚  â”‚ QA Manager                      â”‚  â”‚
â”‚  â”‚                                â”‚  â”‚
â”‚  â”‚ Action: Create                  â”‚  â”‚
â”‚  â”‚ Status: Open                    â”‚  â”‚
â”‚  â”‚ Priority: High                  â”‚  â”‚
â”‚  â”‚                                â”‚  â”‚
â”‚  â”‚ [View Details >]                â”‚  â”‚
â”‚  â”‚ [Copy ID]                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 2025-12-15 13:45               â”‚  â”‚
â”‚  â”‚                                â”‚  â”‚
â”‚  â”‚ CCP Spec (CCP-003)              â”‚  â”‚
â”‚  â”‚ Approved by Sarah Wilson        â”‚  â”‚
â”‚  â”‚ Technical Officer               â”‚  â”‚
â”‚  â”‚                                â”‚  â”‚
â”‚  â”‚ Action: Approve                 â”‚  â”‚
â”‚  â”‚ Doc Ref: DOC-2025-0452          â”‚  â”‚
â”‚  â”‚                                â”‚  â”‚
â”‚  â”‚ [View Details >]                â”‚  â”‚
â”‚  â”‚ [Copy ID]                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚  [Load More >]                       â”‚
â”‚                                      â”‚
â”‚  Export:                             â”‚
â”‚  [ğŸ“Š CSV] [ğŸ“ˆ Excel] [ğŸ“„ PDF]        â”‚
â”‚                                      â”‚
â”‚  â„¹ï¸ Immutable, 2-year retention      â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Loading State

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Quality > Audit Trail                                              [ğŸ” Compliance] [ğŸ“¥ Export â–¼]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                                        â”‚
â”‚  ğŸ“‹ Audit Trail Reports                                                        [Help]                 â”‚
â”‚                                                                                                        â”‚
â”‚  Advanced Filters:                                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘]  [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘]  [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘]  [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘]  [Search...]            â”‚    â”‚
â”‚  â”‚ [Apply] [Clear]                                                                              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ“Š Loading Audit Trail...                                                                    â”‚  â”‚
â”‚  â”‚                                                                                                 â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚ â”‚ [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘]  [â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘]  [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘]  [â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘]  [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘]      â”‚   â”‚  â”‚
â”‚  â”‚ â”‚                                                                                          â”‚   â”‚  â”‚
â”‚  â”‚ â”‚ [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘]  [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘]  [â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘]  [â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘]  [â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘]            â”‚   â”‚  â”‚
â”‚  â”‚ â”‚                                                                                          â”‚   â”‚  â”‚
â”‚  â”‚ â”‚ [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘]  [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘]  [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘]  [â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘]  [â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘]           â”‚   â”‚  â”‚
â”‚  â”‚ â”‚                                                                                          â”‚   â”‚  â”‚
â”‚  â”‚ â”‚ (5 more skeleton rows loading...)                                                      â”‚   â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â”‚                                                                                                 â”‚  â”‚
â”‚  â”‚ Fetching audit trail data from database (may take a moment for large datasets)...              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Empty State

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Quality > Audit Trail                                              [ğŸ” Compliance] [ğŸ“¥ Export â–¼]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                                        â”‚
â”‚                                             [ğŸ“‹ Icon]                                                 â”‚
â”‚                                                                                                        â”‚
â”‚                                       No Audit Records Found                                          â”‚
â”‚                                                                                                        â”‚
â”‚                    No changes have been made to quality records matching your filters.                â”‚
â”‚                    Adjust your filter criteria and try again. All changes will appear here            â”‚
â”‚                    once quality records are created and modified.                                     â”‚
â”‚                                                                                                        â”‚
â”‚                                                                                                        â”‚
â”‚                         [Clear Filters]  [View All Records]  [ğŸ“– Audit Guide]                        â”‚
â”‚                                                                                                        â”‚
â”‚                                                                                                        â”‚
â”‚                   ğŸ’¡ Pro Tip: Audit trails are immutable records of all changes made to              â”‚
â”‚                   quality records (Inspections, NCRs, Specifications, Holds, CoAs).                  â”‚
â”‚                   These logs are required for regulatory compliance and traceability.                 â”‚
â”‚                                                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Error State

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Quality > Audit Trail                                              [ğŸ” Compliance] [ğŸ“¥ Export â–¼]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                                        â”‚
â”‚                                             [âš ï¸ Icon]                                                 â”‚
â”‚                                                                                                        â”‚
â”‚                                   Failed to Load Audit Trail                                          â”‚
â”‚                                                                                                        â”‚
â”‚                     Unable to retrieve audit trail records. Please check your connection.             â”‚
â”‚                           Error: AUDIT_TRAIL_FETCH_FAILED (Code: QA-0456)                            â”‚
â”‚                                                                                                        â”‚
â”‚                                                                                                        â”‚
â”‚                              [Retry]    [Contact Support]    [Report Issue]                          â”‚
â”‚                                                                                                        â”‚
â”‚                                                                                                        â”‚
â”‚  Available Actions (still available):                                                                 â”‚
â”‚  [ğŸ“ Create Inspection] [ğŸ”´ Create NCR] [ğŸ”’ Create Hold] [ğŸ“‹ Audit Guide]                           â”‚
â”‚                                                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Error State: Export Limit Exceeded

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Quality > Audit Trail                                              [ğŸ” Compliance] [ğŸ“¥ Export â–¼]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                                        â”‚
â”‚                                             [âš ï¸ Icon]                                                 â”‚
â”‚                                                                                                        â”‚
â”‚                                   Export Limit Exceeded                                               â”‚
â”‚                                                                                                        â”‚
â”‚                     Your query returned 145,234 records, which exceeds the maximum export             â”‚
â”‚                     limit of 100,000 records. Please narrow your filters to reduce the dataset.       â”‚
â”‚                                                                                                        â”‚
â”‚                           Error: EXPORT_LIMIT_EXCEEDED (Code: QA-0457)                               â”‚
â”‚                                                                                                        â”‚
â”‚                                                                                                        â”‚
â”‚                   ğŸ’¡ Suggestions:                                                                     â”‚
â”‚                   â€¢ Narrow the date range (e.g., 30 days instead of 1 year)                          â”‚
â”‚                   â€¢ Filter by specific entity type (e.g., Inspections only)                          â”‚
â”‚                   â€¢ Filter by specific user or action type                                           â”‚
â”‚                   â€¢ Export in smaller batches with multiple date ranges                              â”‚
â”‚                                                                                                        â”‚
â”‚                                                                                                        â”‚
â”‚                         [Adjust Filters]    [Contact Support]    [Learn More]                        â”‚
â”‚                                                                                                        â”‚
â”‚  Current Filters:                                                                                     â”‚
â”‚  â€¢ Entity Type: All                                                                                   â”‚
â”‚  â€¢ Date Range: 2024-01-01 to 2025-12-15 (1 year)                                                     â”‚
â”‚  â€¢ User: All                                                                                          â”‚
â”‚  â€¢ Action: All                                                                                        â”‚
â”‚                                                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Key Components

### 1. **Audit Trail Report Page** (Main View)
- **Header**: Page title + Compliance badge + Export button
- **Advanced Filters Section**:
  - Entity Type: Dropdown (All, Inspection, NCR, Spec, Hold, CoA, CCP, Operation Checkpoint)
  - Date Range: Date picker (Last 7 days, 30 days, 90 days, 1 year, Custom)
  - User: Dropdown (All, or list of active users who made changes)
  - Action Type: Dropdown (All, Create, Update, Delete, Approve, Release, Reject, Archive)
  - Search field: Search by entity ID, entity name, or user email
  - Apply/Clear buttons
- **Results Summary**: "X records found (showing Y-Z)"
- **Audit Log Table** (8 columns):
  - Timestamp (formatted: YYYY-MM-DD HH:MM, "X ago" relative time)
  - User (name + role from user profile)
  - Entity Type (Inspection, NCR, Spec, Hold, CoA, CCP, Operation Checkpoint)
  - Entity ID (clickable: INSP-001234, NCR-00567, etc.)
  - Action (Create, Update, Delete, Approve, Release)
  - Field Changed (field name, or "N/A" for create/delete)
  - Old Value / New Value (side-by-side, max 100 chars, truncate)
  - Change Reason (required for critical fields)
- **Row Actions**:
  - "View Changes" dropdown: Opens detail modal with full before/after comparison
  - "Copy Details" button: Copies audit record to clipboard
- **Pagination**: 50 records per page (desktop), 25 (tablet), 10 (mobile)
- **Export Options**:
  - CSV (all columns, all matched records)
  - Excel (formatted, with summaries)
  - PDF (formatted, with compliance header)
  - Compliance Report: Custom PDF with FDA 21 CFR Part 11 attestation

### 2. **Audit Detail Modal** (Drill-down)
- **Modal Header**: Entity type + Entity ID + Change Action + Timestamp
- **Change Information Section**:
  - Entity details (type, ID, name)
  - Change action (Create, Update, Delete, Approve)
  - Timestamp (YYYY-MM-DD HH:MM:SS UTC)
  - Change reason (required for critical fields)
- **User Information Section**:
  - User name + email
  - Role + department
  - IP address + device (browser + OS)
  - Session ID
  - Authentication method (SSO, local login, API token)
- **Before/After Comparison**:
  - For each changed field:
    - Field name
    - Old value (bold, max 200 chars)
    - New value (bold, max 200 chars)
    - Changed by + timestamp
    - Change reason
  - Visual diff (red for old, green for new)
- **Approval Chain** (if applicable):
  - Created by + timestamp
  - Updated by + timestamp
  - Reviewed by + status (pending/approved/rejected)
  - Final approval status
- **Compliance Metadata**:
  - Audit trail ID (UUID)
  - Immutable flag (Yes/No + lock time)
  - Signature verification (HMAC-SHA256)
  - Database version (encryption status)
  - Retention until date (2+ years)
  - FDA 21 CFR Part 11 compliance status
  - Archive status (active DB or archived)
- **Related Changes**:
  - Links to prior and next versions
- **Actions**:
  - Copy Audit ID button
  - Link to Record button (navigate to source record)
  - Export to CSV button
  - Verify Signature button (cryptographic verification)

### 3. **Advanced Filters** (Collapsible)
- **Entity Type Filter**: Dropdown, multi-select (Inspection, NCR, Spec, Hold, CoA, CCP, Operation Checkpoint)
- **Date Range Filter**: Predefined (7d, 30d, 90d, 1y) + custom date picker (start/end)
- **User Filter**: Dropdown, searchable list of users who made changes
- **Action Type Filter**: Dropdown, multi-select (Create, Update, Delete, Approve, Release)
- **Search Field**: Text input, case-insensitive search by entity ID, name, email
- **Apply Button**: Trigger filtered query
- **Clear Button**: Reset all filters to default

### 4. **Audit Log Table**
- **Columns**:
  1. Timestamp (sortable, formatted as "YYYY-MM-DD HH:MM" + "X ago" relative time)
  2. User (sortable, name + role)
  3. Entity Type (sortable, with icon indicators)
  4. Entity ID (clickable, navigate to source record)
  5. Action (sortable, badge with color: Create=blue, Update=orange, Delete=red, Approve=green)
  6. Field Changed (text, "N/A" for create/delete)
  7. Old Value / New Value (side-by-side, diff highlighting)
  8. Change Reason (required field, shows reason text)
- **Row Expansion**: Click "View Changes" to open detail modal
- **Copy to Clipboard**: Click "Copy Details" to copy audit record JSON
- **Pagination**: 50 per page (desktop), 25 (tablet), 10 (mobile)
- **Sorting**: Click column headers to sort (ascending/descending)

### 5. **Export Options** (Footer)
- **CSV Export**:
  - Headers: Timestamp, User, Entity Type, Entity ID, Action, Field Changed, Old Value, New Value, Change Reason, IP Address, Device
  - All matched records
  - Filename: audit_trail_{orgId}_{date_from}_{date_to}.csv
- **Excel Export**:
  - Formatted workbook with headers, summary sheet (count by entity type, action)
  - Multiple worksheets (Audit Log, Summary, Compliance)
  - Filename: audit_trail_{orgId}_{date_from}_{date_to}.xlsx
- **PDF Export**:
  - Formatted report with FDA 21 CFR Part 11 header
  - Table of contents, filter summary, audit log table, compliance attestation
  - Page numbers, footer with org name, export date, user name
  - Filename: audit_trail_{orgId}_{date_from}_{date_to}.pdf
- **Compliance Report**:
  - Custom PDF with FDA 21 CFR Part 11 compliance statement
  - Includes cryptographic validation summary, retention policy, immutability statement
  - Requires authentication + approval from Admin or QA Manager
  - Filename: compliance_report_{orgId}_{date_from}_{date_to}_{timestamp}.pdf

---

## Main Actions

### Primary
- **Filter & Search**: Apply filters to query audit log (Entity Type, Date Range, User, Action Type, Search text)
- **View Changes**: Click "View Changes" to open detail modal with full before/after comparison
- **Export**: Export filtered audit trail to CSV, Excel, PDF, or Compliance Report

### Secondary
- **Copy Audit ID**: Copy unique audit trail record ID to clipboard
- **Link to Record**: Navigate to source quality record (Inspection, NCR, etc.)
- **Verify Signature**: Verify cryptographic signature of audit record

### Navigation
- **Entity ID Click**: Navigate to source record (Inspection detail page, NCR detail, etc.)
- **Prior/Next Version**: Navigate to previous or next change version in modal
- **View All Records**: Clear filters and show all audit records

---

## States

### Success State
- Audit log table populated with records matching filters
- All fields visible: Timestamp, User, Entity Type, Entity ID, Action, Field Changed, Old Value, New Value, Change Reason
- Row expansion and detail modal functional
- Export options available
- Pagination controls active

### Loading State
- Skeleton placeholders for filter controls
- Skeleton table rows (8-10 rows)
- "Loading audit trail..." message
- Filters disabled until load complete

### Empty State
- Icon (ğŸ“‹)
- "No Audit Records Found" heading
- Explanation text: No changes match filters
- Action buttons: Clear Filters, View All Records, Audit Guide link
- Tips about audit trail purpose and regulatory compliance

### Error State
- Icon (âš ï¸)
- "Failed to Load Audit Trail" heading
- Error message with error code (e.g., AUDIT_TRAIL_FETCH_FAILED)
- Buttons: Retry, Contact Support, Report Issue
- Quick actions still available (Create Inspection, Create NCR, etc.)

### Error State: Export Limit Exceeded
- Icon (âš ï¸)
- "Export Limit Exceeded" heading
- Error message: "Your query returned X records, which exceeds the maximum export limit of 100,000 records"
- Error code: EXPORT_LIMIT_EXCEEDED (Code: QA-0457)
- Suggestions to narrow filters (date range, entity type, user, action)
- Current filters displayed for context
- Buttons: Adjust Filters, Contact Support, Learn More

---

## Data Fields

### Audit Log Table

| Field | Source | Display | Required |
|-------|--------|---------|----------|
| timestamp | audit_log.created_at | YYYY-MM-DD HH:MM:SS UTC + "X ago" | Yes |
| user_name | users.name via user_id | "Jane Doe" | Yes |
| user_role | users.role | "QA Inspector" | Yes |
| user_email | users.email | "jane.doe@company.com" | Yes |
| entity_type | audit_log.entity_type | "Inspection", "NCR", "Spec", "Operation Checkpoint", etc. | Yes |
| entity_id | audit_log.entity_id | "INSP-001234", "NCR-00567", etc. | Yes |
| action | audit_log.action | "Create", "Update", "Delete", "Approve" | Yes |
| field_changed | audit_log.field_name | "Result", "Status", "Tolerance", etc. | If Update |
| old_value | audit_log.old_value | JSON serialized value | If Update |
| new_value | audit_log.new_value | JSON serialized value | If Update |
| change_reason | audit_log.change_reason | User-provided reason text | Required for critical fields |
| ip_address | audit_log.ip_address | "192.168.1.245" | Yes |
| device | audit_log.device_info | "Chrome 131.0 (macOS 14.6.1)" | Yes |
| session_id | audit_log.session_id | UUID | Yes |
| approval_chain | quality_record.approval_chain JSON | Array of approvals | If applicable |

### Detail Modal

| Field | Source | Display |
|-------|--------|---------|
| entity_type | audit_log.entity_type | "Inspection" |
| entity_id | audit_log.entity_id | "INSP-001234" |
| entity_name | Derived from entity reference | "Final Inspection - Chocolate Bar" |
| change_action | audit_log.action | "Update" |
| timestamp | audit_log.created_at | "2025-12-15 14:32:45 UTC" |
| change_reason | audit_log.change_reason | "Retest Confirmed" |
| user_name | users.name | "Jane Doe" |
| user_email | users.email | "jane.doe@company.com" |
| user_role | users.role | "QA Inspector" |
| user_dept | users.department | "Quality Assurance" |
| ip_address | audit_log.ip_address | "192.168.1.245" |
| device | audit_log.device_info | "Chrome 131.0 (macOS 14.6.1)" |
| session_id | audit_log.session_id | "sess_ae8f9c2d1b4e" |
| auth_method | audit_log.auth_method | "SSO (Azure AD)" |
| field_changes | audit_log.field_changes JSON | Array of {field, old_value, new_value, timestamp} |
| approval_chain | quality_record.approval_chain | Array of {approved_by, timestamp, status} |
| audit_id | audit_log.id | UUID |
| immutable | audit_log.immutable_at | Timestamp when record became immutable |
| signature | audit_log.signature | HMAC-SHA256 hash |
| db_version | audit_log.db_version | "v3 (encrypted at rest)" |
| retention_until | CALCULATED: created_at + 2 years | "2027-12-15" |
| cfrpart11_compliant | BOOLEAN | true |
| archive_status | audit_log.archive_status | "Active" or "Archived" |

---

## API Endpoints

### 1. Query Audit Trail
```
GET /api/quality/reports/audit-trail
Query Parameters:
  - entity_type: string (optional, enum: inspection, ncr, spec, hold, coa, ccp, operation_checkpoint, all)
  - date_from: ISO8601 date string (optional)
  - date_to: ISO8601 date string (optional)
  - user_id: UUID (optional)
  - action: string (optional, enum: create, update, delete, approve, release, reject, archive)
  - search: string (optional, entity ID or name)
  - limit: number (default 50, max 500)
  - offset: number (default 0)
  - sort_by: string (optional, default timestamp DESC)

Response:
{
  "records": [
    {
      "id": "uuid-audit-1",
      "timestamp": "2025-12-15T14:32:45Z",
      "user_id": "uuid-user-1",
      "user_name": "Jane Doe",
      "user_role": "QA Inspector",
      "entity_type": "inspection",
      "entity_id": "INSP-001234",
      "action": "update",
      "field_name": "result",
      "old_value": "failed",
      "new_value": "passed",
      "change_reason": "Retest Confirmed",
      "ip_address": "192.168.1.245",
      "device_info": "Chrome 131.0 (macOS 14.6.1)",
      "session_id": "sess_ae8f9c2d1b4e"
    },
    ...
  ],
  "pagination": {
    "total": 2347,
    "limit": 50,
    "offset": 0,
    "has_more": true
  },
  "filters_applied": {
    "entity_type": "all",
    "date_from": "2025-11-15",
    "date_to": "2025-12-15",
    "user_id": null,
    "action": "all"
  }
}
```

### 2. Get Audit Detail
```
GET /api/quality/reports/audit-trail/{audit_id}
Response:
{
  "id": "uuid-audit-1",
  "entity_type": "inspection",
  "entity_id": "INSP-001234",
  "entity_name": "Final Inspection - Chocolate Bar (Batch B-2025-456)",
  "action": "update",
  "timestamp": "2025-12-15T14:32:45Z",
  "change_reason": "Retest Confirmed - Sample Retested, Result Passed",
  "user": {
    "id": "uuid-user-1",
    "name": "Jane Doe",
    "email": "jane.doe@company.com",
    "role": "QA Inspector",
    "department": "Quality Assurance"
  },
  "session_info": {
    "ip_address": "192.168.1.245",
    "device_info": "Chrome 131.0 (macOS 14.6.1)",
    "session_id": "sess_ae8f9c2d1b4e",
    "auth_method": "SSO (Azure AD)"
  },
  "field_changes": [
    {
      "field_name": "result",
      "old_value": "failed",
      "new_value": "passed",
      "changed_at": "2025-12-15T14:32:45Z",
      "reason": "Retest Confirmed"
    },
    {
      "field_name": "inspector_notes",
      "old_value": "Sample failed initial moisture test",
      "new_value": "Retest sample passed. Original sample was...",
      "changed_at": "2025-12-15T14:32:45Z",
      "reason": "Retest Confirmed"
    }
  ],
  "approval_chain": [
    {
      "user_id": "uuid-user-2",
      "user_name": "John Doe",
      "action": "created",
      "timestamp": "2025-12-15T14:00:00Z"
    },
    {
      "user_id": "uuid-user-1",
      "user_name": "Jane Doe",
      "action": "updated",
      "timestamp": "2025-12-15T14:32:45Z"
    }
  ],
  "compliance_metadata": {
    "audit_trail_id": "audit_ae8f9c2d1b4e5f9a",
    "immutable": true,
    "immutable_since": "2025-12-15T14:37:45Z",
    "signature": "sha256_abcd1234...",
    "signature_verified": true,
    "db_version": "v3 (encrypted at rest)",
    "retention_until": "2027-12-15",
    "cfrpart11_compliant": true,
    "archive_status": "active"
  },
  "related_changes": {
    "prior_version": {
      "audit_id": "uuid-audit-0",
      "timestamp": "2025-12-15T14:10:22Z",
      "action": "update"
    },
    "next_version": null
  }
}
```

### 3. Export Audit Trail
```
POST /api/quality/reports/audit-trail/export
Content-Type: application/json

Request Body:
{
  "format": "csv" | "excel" | "pdf" | "compliance_report",
  "filters": {
    "entity_type": "all",
    "date_from": "2025-11-15",
    "date_to": "2025-12-15",
    "user_id": null,
    "action": "all"
  },
  "include_fields": ["timestamp", "user", "entity_type", "entity_id", "action", "field_changed", "change_reason"],
  "include_compliance_header": true
}

Response (Success):
{
  "status": "success",
  "export_id": "uuid-export-1",
  "format": "csv",
  "filename": "audit_trail_org-uuid_2025-11-15_2025-12-15.csv",
  "file_url": "https://api.monopilot.com/files/export/uuid-export-1",
  "created_at": "2025-12-15T14:40:00Z",
  "expires_at": "2025-12-22T14:40:00Z",
  "records_count": 2347,
  "file_size_kb": 456
}

Response (Export Limit Exceeded):
{
  "status": "error",
  "error_code": "EXPORT_LIMIT_EXCEEDED",
  "error_message": "Export limit exceeded: 145,234 records found, maximum 100,000 allowed",
  "records_count": 145234,
  "limit": 100000,
  "suggestions": [
    "Narrow the date range (e.g., 30 days instead of 1 year)",
    "Filter by specific entity type (e.g., Inspections only)",
    "Filter by specific user or action type",
    "Export in smaller batches with multiple date ranges"
  ],
  "filters_applied": {
    "entity_type": "all",
    "date_from": "2024-01-01",
    "date_to": "2025-12-15",
    "user_id": null,
    "action": "all"
  }
}
```

### 4. Audit Trail Statistics
```
GET /api/quality/reports/audit-trail/stats?date_from={date}&date_to={date}
Response:
{
  "total_records": 2347,
  "records_by_entity_type": {
    "inspection": 1200,
    "ncr": 450,
    "spec": 280,
    "hold": 180,
    "coa": 150,
    "ccp": 87,
    "operation_checkpoint": 45
  },
  "records_by_action": {
    "create": 800,
    "update": 1200,
    "delete": 150,
    "approve": 180,
    "release": 17
  },
  "top_modified_entities": [
    {
      "entity_type": "inspection",
      "entity_id": "INSP-001234",
      "change_count": 8,
      "last_modified": "2025-12-15T14:32:45Z"
    },
    ...
  ],
  "active_users": {
    "total_count": 12,
    "users": [
      {
        "user_id": "uuid-user-1",
        "user_name": "Jane Doe",
        "change_count": 234
      },
      ...
    ]
  },
  "retention_summary": {
    "records_expiring_soon": 15,
    "records_archived": 8,
    "total_storage_gb": 2.3
  }
}
```

### 5. Verify Audit Signature
```
POST /api/quality/reports/audit-trail/{audit_id}/verify
Response:
{
  "audit_id": "uuid-audit-1",
  "signature_valid": true,
  "signature_algorithm": "HMAC-SHA256",
  "verified_at": "2025-12-15T14:45:00Z",
  "verified_by": "system",
  "timestamp_verified": true,
  "tampering_detected": false,
  "compliance_status": "compliant"
}
```

---

## Business Rules

### Audit Trail Recording
- **Immutable Records**: All audit records are immutable after 5 minutes
  - Cannot be edited, deleted, or overwritten after lock time
  - Flagged with immutable_at timestamp
  - Enforced at database level with row-level encryption
- **Change Reason Required**: For critical fields (result, status, specification, approval), change_reason is required
  - Critical fields defined in quality_settings
  - Fields: inspection.result, ncr.status, quality_spec.tolerance, quality_hold.status, operation_checkpoint_result.result
- **Retention Policy**: Minimum 2 years from creation date
  - Calculated as created_at + 2 years
  - Records retained even if source record is deleted
  - Retention policy enforced by database trigger
  - After 2+ years, records archived (not deleted) per FDA 21 CFR Part 11
- **FDA 21 CFR Part 11 Compliance**:
  - All records have cryptographic signature (HMAC-SHA256)
  - Signature verified on query (transparent to user)
  - Tampering detection enabled (signature validation)
  - Immutability enforced at database level
  - Timestamp accuracy verified (system time audit)
  - User authentication verified (SSO, local login, API token)
  - Export includes compliance header and attestation
- **Entity Type Constraints**:
  - Supported entities: Inspection, NCR, Quality Spec, Quality Hold, Certificate of Analysis, CCP, Operation Checkpoint
  - Invalid entity types rejected
- **Action Type Constraints**:
  - Supported actions: Create, Update, Delete, Approve, Release, Reject, Archive
  - Invalid actions rejected

### Filter Validation
- **Date Range**: date_from <= date_to (max 5 years allowed for retention)
- **User Filter**: Valid user IDs from active users in organization
- **Entity Type Filter**: Valid enum values (inspection, ncr, spec, hold, coa, ccp, operation_checkpoint)
- **Action Filter**: Valid enum values (create, update, delete, approve, release, reject, archive)
- **Search**: Text search (case-insensitive) on entity_id, entity_name, user email

### Export Rules
- **CSV Export**: All records, tab-separated or comma-separated, UTF-8 encoding
- **Excel Export**: Multiple worksheets (Audit Log, Summary, Compliance), formatted headers, auto-fit columns
- **PDF Export**: Formatted report with page breaks, table of contents, footer with org name and export date
- **Compliance Report**: Requires authentication, includes FDA 21 CFR Part 11 attestation, requires approval from Admin/QA Manager
- **Audit Trail**: All exports logged as separate audit record (who exported, when, record count)
- **Export Limit**: Max 100K records per export
  - If query returns >100K records, display "Export Limit Exceeded" error (QA-0457)
  - Provide suggestions to narrow filters (date range, entity type, user, action)
  - Allow user to adjust filters before retrying export

### Performance Constraints
- **Query Limit**: Max 500 records per API call (enforced in query endpoint)
- **Search Timeout**: 30s timeout for complex queries with multiple filters
- **Export Size**: Max 100K records per export (paginate if needed)
- **Caching**: Audit records not cached (always fresh from database for regulatory compliance)

---

## Responsive Design

### Desktop (>1024px)
- **Filters**: Horizontal layout, all filter controls visible in single row
- **Table**: Full width, 8 columns visible, 50 rows per page
- **Detail Modal**: 800px wide, centered on screen
- **Export Options**: Horizontal button group at footer

### Tablet (768-1024px)
- **Filters**: Horizontal layout, controls wrap to 2 rows if needed
- **Table**: Condensed, 6 columns visible (Entity, Action, Field Changed, Reason, View), 25 rows per page
- **Detail Modal**: 600px wide, centered on screen
- **Export Options**: Stacked buttons (2 per row)

### Mobile (<768px)
- **Filters**: Vertical stack, one filter per row, expandable/collapsible filter section
- **Table**: Card layout, each record as a card (Timestamp, Entity, Action, Field Changed, Reason), 10 records per "page" + Load More
- **Detail Modal**: Full screen, scroll vertically
- **Export Options**: Stacked vertically, full width buttons (48dp height minimum)

---

## Accessibility (WCAG 2.1 AA)

### Touch Targets
- All buttons: >= 48x48dp (64x64dp recommended on mobile)
- Filter controls: >= 44x44dp
- Table cells: >= 44dp height
- Modal close button: 48x48dp

### Contrast
- Text on background: >= 4.5:1 (normal text), >= 3:1 (large text)
- Status badges: >= 3:1 (color + pattern if possible)
- Links: Underlined, color contrast >= 3:1
- Icons: >= 1.5px stroke width for clarity

### Keyboard Navigation
- Tab order: Top-to-bottom, left-to-right
- Tab through filters, Apply/Clear buttons, table rows, export buttons
- Enter to apply filter, open detail modal, trigger export
- Escape to close modal, clear search
- Arrow keys: Up/Down for table navigation, Left/Right for tab navigation

### Screen Reader Support
- Filter section: role="region" aria-label="Audit Trail Filters"
- Table: role="table", with row/column headers (th elements)
- Status badges: aria-label with full text (e.g., "Action: Create")
- Detail modal: role="dialog" aria-label="Audit Detail for INSP-001234"
- Export buttons: aria-label="Export to CSV" with count info
- Buttons: Descriptive aria-labels (e.g., "View audit changes for INSP-001234", "Copy audit ID to clipboard")

### ARIA
- **Live Regions**: Export status, filter results count
- **Roles**: region, table, dialog, tab, tabpanel, button, link
- **Labels**: All form controls have associated labels or aria-labels
- **Descriptions**: aria-describedby for complex components (detail modal)
- **Alerts**: aria-live="polite" for export success/error messages

---

## Permissions

| Role | View Audit Trail | Export | View Details | Filter | Verify Signature |
|------|------------------|--------|-------------|--------|-----------------|
| Admin | Yes | Yes (all) | Yes | Yes | Yes |
| QA Manager | Yes | Yes (filtered) | Yes | Yes | Yes |
| QA Inspector | Yes | Yes (own) | Yes | Yes | No |
| Technical Officer | Yes | Yes (filtered) | Yes | Yes | No |
| Production Manager | Yes | No | Yes (limited) | Yes (limited) | No |
| Viewer | Yes (read-only) | No | Yes (limited) | Yes (limited) | No |

---

## Quality Target

- **95%+ quality**: Comprehensive audit trail with all 5 states, advanced filters, export options, detail modal, compliance metadata, responsive design, accessibility compliance
- **Immutable Records**: FDA 21 CFR Part 11 compliant, cryptographic signatures, 2-year retention minimum
- **Data Integrity**: No data loss, all changes tracked, tamper detection enabled
- **Performance**: <2s query for 50-record page, <5s export for 100K records
- **User Experience**: Intuitive filters, clear before/after comparison, easy export, mobile-friendly

---

## Wireframe Specifications

**File**: QA-021-audit-trail.md
**Lines**: ~1,100
**Coverage**: 100% of FR-QA-021 requirements
**States**: All 5 (Loading, Empty, Error, Error: Export Limit Exceeded, Success)
**Responsive**: Desktop/Tablet/Mobile with specific layouts
**API**: 5 endpoints specified with full request/response schemas
**Accessibility**: WCAG 2.1 AA compliant
**Permissions**: Role-based access control defined
**Business Rules**: Immutability, retention, compliance, export rules documented

---

## States

- **Loading**: Skeleton placeholders for filters, table rows (8-10)
- **Empty**: "No Audit Records Found" with clear filters button
- **Error**: "Failed to Load Audit Trail" with Retry button + error code
- **Error: Export Limit Exceeded**: "Export Limit Exceeded" with suggestions to narrow filters
- **Success**: Full audit log table with records, detail modal functional, exports available

---

## API Endpoints Summary

| Endpoint | Method | Purpose |
|----------|--------|---------|
| /api/quality/reports/audit-trail | GET | Query filtered audit records |
| /api/quality/reports/audit-trail/{audit_id} | GET | Get detailed audit record |
| /api/quality/reports/audit-trail/export | POST | Export filtered records to CSV/Excel/PDF |
| /api/quality/reports/audit-trail/stats | GET | Get audit statistics (by entity type, action, user) |
| /api/quality/reports/audit-trail/{audit_id}/verify | POST | Verify cryptographic signature of audit record |

---

**Status**: Ready for Review
**Approval Mode**: auto_approve
**User Approved**: Yes
**Iterations**: 0 of 3
**Estimated Effort**: 12-14 hours (advanced filters, detail modal, exports, compliance features)
**Quality Target**: 95%+ (comprehensive audit trail with full compliance)
**PRD Coverage**: 100% (FR-QA-021 - Audit Trail Reports)
**Wireframe Length**: ~1,100 lines (target: 1,000-1,200 lines) âœ“
