# TEC-016: Traceability Search & Results

**Module**: Technical
**Feature**: Traceability (Stories 2.60-2.65)
**Type**: Full Page
**Status**: Ready for Implementation
**Last Updated**: 2025-12-14

---

## Overview

**Purpose**: Provide comprehensive traceability search and visualization for lot/batch tracking, including forward trace (where used), backward trace (what consumed), recall simulation, and genealogy tree visualization. Critical regulatory requirement for food manufacturing recall capability.

**User Roles**:
- Quality Manager (primary)
- Production Manager
- Warehouse Manager
- Compliance Officer

**Navigation**:
- Main menu: Technical > Traceability
- Quick access: Any lot ID link throughout system (pre-fills search)
- Breadcrumb: Technical > Traceability

**Key Features**:
- Forward/backward/recall traceability search
- Genealogy tree visualization (D3.js-style)
- Recall simulation with financial/regulatory impact
- Traceability matrix export
- Multi-criteria search (lot ID, batch number, date range)

---

## ASCII Wireframe

### Success State (Forward Trace Results - List View)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â˜° MonoPilot        Technical > Traceability                  ğŸ‘¤ Admin     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                            â”‚
â”‚  Product Traceability                                                      â”‚
â”‚  Forward, Backward, and Recall Simulation                                  â”‚
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Search Traceability                                                 â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  Direction:  â—‰ Forward  â—‹ Backward  â—‹ Recall Simulation             â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚ Lot ID *            â”‚  â”‚ OR Batch Number     â”‚  â”‚ Date Range   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ LP-2024-001234   [â†“]â”‚  â”‚ BATCH-2024-11-001   â”‚  â”‚ 2024-01-01 â†’ â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ 2024-12-14   â”‚ â”‚ â”‚
â”‚  â”‚  (autocomplete enabled)   (optional)               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  Advanced Options: [+] Show                                         â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  [ Search Traceability ]                           [Clear]          â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Forward Trace Results                                               â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  Root LP: LP-2024-001234  â”‚  Batch: BATCH-FLOUR-001                â”‚ â”‚
â”‚  â”‚  Product: Flour Type 550   â”‚  Qty: 1000 kg                         â”‚ â”‚
â”‚  â”‚  Mfg Date: 2024-11-15      â”‚  Expiry: 2025-05-15                   â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  Summary Stats                                                       â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚ Descendants â”‚  â”‚ Max Depth   â”‚  â”‚ Work Orders â”‚  â”‚ Customers  â”‚ â”‚ â”‚
â”‚  â”‚  â”‚     47      â”‚  â”‚      3      â”‚  â”‚      8      â”‚  â”‚     12     â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  [ğŸ“‹ List View]  [ğŸŒ³ Tree View]  [ğŸ“Š Matrix View]                   â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  Traceability Links (47 results)            [â†“ Export CSV] [Print] â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚ Depth  â”‚ Parent Lot           â”‚ Child Lot            â”‚ WO      â”‚ â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚
â”‚  â”‚  â”‚   1    â”‚ LP-2024-001234       â”‚ LP-2024-001240 â–¼    â”‚ WO-1001 â”‚ â”‚ â”‚
â”‚  â”‚  â”‚        â”‚ Flour Type 550       â”‚ Dough White Mix      â”‚         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚        â”‚ 1000 kg              â”‚ Consumed: 850 kg     â”‚ 11/16   â”‚ â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚
â”‚  â”‚  â”‚   2    â”‚ LP-2024-001240       â”‚ LP-2024-001255 â–¼    â”‚ WO-1005 â”‚ â”‚ â”‚
â”‚  â”‚  â”‚        â”‚ Dough White Mix      â”‚ Bread Loaf White     â”‚         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚        â”‚ 900 kg               â”‚ Consumed: 900 kg     â”‚ 11/17   â”‚ â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚
â”‚  â”‚  â”‚   2    â”‚ LP-2024-001240       â”‚ LP-2024-001256 â–¼    â”‚ WO-1006 â”‚ â”‚ â”‚
â”‚  â”‚  â”‚        â”‚ Dough White Mix      â”‚ Bread Baguette       â”‚         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚        â”‚ 900 kg               â”‚ Consumed: 200 kg     â”‚ 11/17   â”‚ â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚
â”‚  â”‚  â”‚   3    â”‚ LP-2024-001255       â”‚ SHIPPED-CS-001 ğŸ“¦   â”‚ SO-5001 â”‚ â”‚ â”‚
â”‚  â”‚  â”‚        â”‚ Bread Loaf White     â”‚ Customer: ABC Retail â”‚         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚        â”‚ 500 loaves           â”‚ Ship Date: 11/20     â”‚         â”‚ â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚
â”‚  â”‚  â”‚  ...   â”‚  ...                 â”‚  ...                 â”‚  ...    â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  [Show All 47 Results]                          Page 1 of 5         â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Quick Actions                                                       â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  [Download PDF Report]  [Email to QA]  [Create CAPA]  [View WO]    â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Success State (Tree View)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Product Traceability                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  [ğŸ“‹ List View]  [ğŸŒ³ Tree View]  [ğŸ“Š Matrix View]                   â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  Genealogy Tree Visualization                                       â”‚ â”‚
â”‚  â”‚  (Pan with mouse, zoom with scroll wheel, click nodes for details) â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚ â”‚
â”‚  â”‚                    â”‚ LP-2024-001234   â”‚                             â”‚ â”‚
â”‚  â”‚                    â”‚ Flour Type 550   â”‚                             â”‚ â”‚
â”‚  â”‚                    â”‚ 1000 kg          â”‚                             â”‚ â”‚
â”‚  â”‚                    â”‚ ğŸŸ¢ Available      â”‚                             â”‚ â”‚
â”‚  â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚ â”‚
â”‚  â”‚                             â”‚                                        â”‚ â”‚
â”‚  â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚ â”‚
â”‚  â”‚                    â”‚                   â”‚                            â”‚ â”‚
â”‚  â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚ â”‚
â”‚  â”‚          â”‚ LP-2024-001240    â”‚  â”‚ LP-2024-001241  â”‚                â”‚ â”‚
â”‚  â”‚          â”‚ Dough White Mix   â”‚  â”‚ Dough Wheat Mix â”‚                â”‚ â”‚
â”‚  â”‚          â”‚ 900 kg (850 used) â”‚  â”‚ 150 kg          â”‚                â”‚ â”‚
â”‚  â”‚          â”‚ ğŸ”µ In Production   â”‚  â”‚ ğŸŸ¢ Available     â”‚                â”‚ â”‚
â”‚  â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚ â”‚
â”‚  â”‚                    â”‚                                                â”‚ â”‚
â”‚  â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚ â”‚
â”‚  â”‚          â”‚                    â”‚                                     â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                              â”‚ â”‚
â”‚  â”‚  â”‚ LP-2024-001255â”‚    â”‚ LP-001256   â”‚                              â”‚ â”‚
â”‚  â”‚  â”‚ Bread Loaf    â”‚    â”‚ Baguette    â”‚                              â”‚ â”‚
â”‚  â”‚  â”‚ 500 loaves    â”‚    â”‚ 100 pcs     â”‚                              â”‚ â”‚
â”‚  â”‚  â”‚ ğŸ”´ Shipped     â”‚    â”‚ ğŸŸ¡ Quarantineâ”‚                              â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚ â”‚
â”‚  â”‚          â”‚                                                          â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                               â”‚ â”‚
â”‚  â”‚  â”‚ SHIPPED-CS-001   â”‚                                               â”‚ â”‚
â”‚  â”‚  â”‚ ABC Retail       â”‚                                               â”‚ â”‚
â”‚  â”‚  â”‚ Ship: 2024-11-20 â”‚                                               â”‚ â”‚
â”‚  â”‚  â”‚ ğŸ“¦ Customer       â”‚                                               â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                               â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  Legend:                                                            â”‚ â”‚
â”‚  â”‚  ğŸŸ¢ Available  ğŸ”µ In Production  ğŸ”´ Shipped  ğŸŸ¡ Quarantine  âš« Consumed â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  [Zoom In] [Zoom Out] [Reset View] [Expand All] [Collapse All]     â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Success State (Recall Simulation)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Recall Simulation: LP-2024-001234                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                            â”‚
â”‚  âš ï¸  WARNING: This is a simulation. No inventory will be affected.         â”‚
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Section 1: Affected Inventory                                       â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚ Affected LPs  â”‚ â”‚ Total Qty     â”‚ â”‚ Est. Value â”‚ â”‚ Warehouses  â”‚ â”‚ â”‚
â”‚  â”‚  â”‚      47       â”‚ â”‚ 2,450 kg      â”‚ â”‚ $8,245.50  â”‚ â”‚      3      â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  Status Breakdown:                                                   â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚ğŸŸ¢Availableâ”‚ â”‚ğŸ”µProductionâ”‚ â”‚ğŸ”´Shipped â”‚ â”‚âš«Consumedâ”‚ â”‚ğŸŸ¡Quarantâ”‚ â”‚ â”‚
â”‚  â”‚  â”‚    12     â”‚ â”‚      8     â”‚ â”‚    20    â”‚ â”‚     5    â”‚ â”‚    2    â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Section 2: Location Analysis                                       â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  Warehouse              Affected LPs    Total Qty    Zones           â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚ â”‚
â”‚  â”‚  Main Warehouse WH-01        15         850 kg       A1, A2, B3     â”‚ â”‚
â”‚  â”‚  Distribution DC-02          10         600 kg       C1, C2         â”‚ â”‚
â”‚  â”‚  Cold Storage CS-01           7         400 kg       D1              â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Section 3: Customer Impact                              â— 12 affectedâ”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  Customer           Email               Shipped Qty   Ship Date     â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚ â”‚
â”‚  â”‚  ABC Retail         [email protected]       500 kg      2024-11-20   â”‚ â”‚
â”‚  â”‚  XYZ Grocery        [email protected]       350 kg      2024-11-21   â”‚ â”‚
â”‚  â”‚  Food Mart          [email protected]        280 kg      2024-11-22   â”‚ â”‚
â”‚  â”‚  ...                ...                 ...           ...          â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  [Generate Customer Notification Emails]                            â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Section 4: Financial Impact                                        â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  Product Value:                              $8,245.50              â”‚ â”‚
â”‚  â”‚  Retrieval Cost (est.):                      $1,250.00              â”‚ â”‚
â”‚  â”‚  Disposal Cost (est.):                       $850.00                â”‚ â”‚
â”‚  â”‚  Lost Revenue (est.):                        $3,500.00              â”‚ â”‚
â”‚  â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚ â”‚
â”‚  â”‚  Total Estimated Cost:                       $13,845.50             â”‚ â”‚
â”‚  â”‚  Confidence Interval:                        Â±15%                   â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Section 5: Regulatory Compliance                                   â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  Reportable to FDA:              âœ… YES                              â”‚ â”‚
â”‚  â”‚  Report Due Date:                2024-12-16 (2 days)                â”‚ â”‚
â”‚  â”‚  Report Status:                  âš ï¸  Not Filed                       â”‚ â”‚
â”‚  â”‚  Affected Product Types:         Finished Goods, WIP                â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  [ğŸ“„ Export FDA JSON] [ğŸ“„ Export FDA XML] [ğŸ“„ Export PDF Report]     â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                            â”‚
â”‚  Simulation completed in 342ms                                             â”‚
â”‚                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Loading State

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Product Traceability                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Search Traceability                                                 â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  [Disabled form fields shown with gray background]                  â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚                          [âŒ› Spinner Icon]                            â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚                  Running Forward Trace...                            â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  65%                          â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  Processing traceability links...                                   â”‚ â”‚
â”‚  â”‚  Building genealogy tree (depth 3 of 5)...                          â”‚ â”‚
â”‚  â”‚  Querying 47 LPs across 3 warehouses...                             â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Empty State

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Product Traceability                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Search Traceability                                                 â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  Direction:  â—‰ Forward  â—‹ Backward  â—‹ Recall Simulation             â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚ Lot ID *            â”‚  â”‚ OR Batch Number     â”‚  â”‚ Date Range   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ [Empty]             â”‚  â”‚ [Empty]             â”‚  â”‚ [Empty]      â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  [ Search Traceability ]  (disabled)                                â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚                          [ğŸ” Search Icon]                            â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚                  No Traceability Search Yet                          â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  Enter a Lot ID or Batch Number to start tracing.                   â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  What you can do:                                                   â”‚ â”‚
â”‚  â”‚  â€¢ Forward Trace: Find where this material was used                 â”‚ â”‚
â”‚  â”‚  â€¢ Backward Trace: Find what went into this product                 â”‚ â”‚
â”‚  â”‚  â€¢ Recall Simulation: Assess full recall impact                     â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  Need help? [View Traceability Guide]                               â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Error State

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Product Traceability                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                            â”‚
â”‚  âŒ  Error: Lot ID not found or no traceability data available             â”‚
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Search Traceability                                                 â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  Direction:  â—‰ Forward  â—‹ Backward  â—‹ Recall Simulation             â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                            â”‚ â”‚
â”‚  â”‚  â”‚ Lot ID *            â”‚                                            â”‚ â”‚
â”‚  â”‚  â”‚ LP-9999-INVALID  âŒ â”‚  â† Lot ID not found                        â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  [ Search Traceability ]                           [Clear]          â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  âŒ  Traceability Search Failed                                      â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  The following issues were found:                                   â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  â€¢ Lot ID "LP-9999-INVALID" does not exist in the system            â”‚ â”‚
â”‚  â”‚  â€¢ No license plates found matching this identifier                 â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  Suggestions:                                                        â”‚ â”‚
â”‚  â”‚  â€¢ Check if the Lot ID is correct (format: LP-YYYY-NNNNNN)          â”‚ â”‚
â”‚  â”‚  â€¢ Try searching by Batch Number instead                            â”‚ â”‚
â”‚  â”‚  â€¢ Verify the lot was received in the warehouse                     â”‚ â”‚
â”‚  â”‚  â€¢ Contact support if this lot should exist                         â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  [Try Again]              [Search Recent Lots]                      â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Matrix View (Traceability Matrix Report)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Traceability Matrix Report                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  [ğŸ“‹ List View]  [ğŸŒ³ Tree View]  [ğŸ“Š Matrix View]                   â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  Lot Traceability Matrix                     [â†“ Export Excel]       â”‚ â”‚
â”‚  â”‚  Root Lot: LP-2024-001234                    [ğŸ–¨ Print]              â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚ Lot  â”‚ Product  â”‚ Batch    â”‚ Mfg Date â”‚ Consumed â”‚ Produced â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ ID   â”‚ Name     â”‚ Number   â”‚          â”‚ In       â”‚ From     â”‚   â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚ â”‚
â”‚  â”‚  â”‚ LP-  â”‚ Flour    â”‚ BATCH-   â”‚ 11/15/24 â”‚ WO-1001  â”‚ PO-5001  â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ 1234 â”‚ Type 550 â”‚ FL-001   â”‚          â”‚ WO-1002  â”‚          â”‚   â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚ â”‚
â”‚  â”‚  â”‚ LP-  â”‚ Dough    â”‚ BATCH-   â”‚ 11/16/24 â”‚ WO-1005  â”‚ WO-1001  â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ 1240 â”‚ White    â”‚ DW-001   â”‚          â”‚ WO-1006  â”‚          â”‚   â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚ â”‚
â”‚  â”‚  â”‚ LP-  â”‚ Bread    â”‚ BATCH-   â”‚ 11/17/24 â”‚ SO-5001  â”‚ WO-1005  â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ 1255 â”‚ Loaf     â”‚ BR-100   â”‚          â”‚ (shipped)â”‚          â”‚   â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚ â”‚
â”‚  â”‚  â”‚ ... (47 total lots)                                         â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  Matrix shows complete input/output relationships for audit trail.  â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Key Components

### 1. Search Form Panel
- **Direction Selector**: Radio buttons (Forward / Backward / Recall)
- **Lot ID Input**: Autocomplete enabled, validates format LP-YYYY-NNNNNN
- **Batch Number Input**: Optional alternative to Lot ID
- **Date Range Picker**: Optional filter for date-based searches
- **Advanced Options**: Collapsible section for:
  - Max depth (default 20)
  - Include shipped LPs (default true)
  - Include consumed LPs (default true)
  - Work Order filter
- **Search Button**: Primary action, disabled until Lot ID or Batch entered
- **Clear Button**: Resets form

### 2. Results Summary Panel
- **Root LP Details**: LP number, batch, product, qty, mfg date, expiry
- **Summary Stats**: 4 stat cards showing:
  - Total descendants/ancestors
  - Max depth levels
  - Work orders involved
  - Customers affected (if shipped)
- **Status Indicator**: Color-coded (Available, In Production, Shipped, Consumed, Quarantine)

### 3. View Mode Tabs
- **List View** (default): Tabular display of traceability links
- **Tree View**: D3.js-style genealogy tree with pan/zoom
- **Matrix View**: Excel-style traceability matrix for audit

### 4. List View Table
- **Columns**:
  - Depth (1, 2, 3...)
  - Parent Lot (LP ID, product name, quantity)
  - Child Lot (LP ID, product name, consumed qty)
  - Work Order (or SO for shipped)
  - Date
  - Status icon
- **Row Actions**: Click to expand details
- **Pagination**: 10 rows per page
- **Export**: CSV download button

### 5. Tree View Visualization
- **D3.js-style tree**: Interactive, zoomable, pannable
- **Node Elements**:
  - LP number
  - Product name
  - Quantity
  - Status icon (color-coded)
- **Edge Labels**: Quantity consumed
- **Controls**:
  - Zoom In/Out
  - Reset View
  - Expand/Collapse All
  - Pan (drag with mouse)
- **Legend**: Status color codes
- **Click Handler**: Node details on click

### 6. Recall Simulation Sections
- **Section 1: Affected Inventory**
  - 4 stat cards (LPs, qty, value, warehouses)
  - Status breakdown (5 status boxes)
- **Section 2: Location Analysis**
  - Table: Warehouse, Affected LPs, Total Qty, Zones
- **Section 3: Customer Impact**
  - Table: Customer, Email, Shipped Qty, Ship Date
  - Generate notification emails button
- **Section 4: Financial Impact**
  - Line items: Product value, retrieval cost, disposal cost, lost revenue
  - Total estimated cost (highlighted)
  - Confidence interval
- **Section 5: Regulatory Compliance**
  - FDA reportable (YES/NO)
  - Report due date
  - Report status
  - Affected product types
  - Export buttons (FDA JSON, FDA XML, PDF Report)

### 7. Quick Actions Panel
- **Download PDF Report**: Full traceability report
- **Email to QA**: Send results to quality team
- **Create CAPA**: Link to Quality module for corrective action
- **View WO**: Navigate to related work orders

---

## Main Actions

### Primary Actions

1. **Search Traceability**:
   - Validates Lot ID or Batch Number required
   - Validates date range (from <= to)
   - Disables search button while loading
   - Calls appropriate API based on direction:
     - Forward: `POST /api/technical/tracing/forward`
     - Backward: `POST /api/technical/tracing/backward`
     - Recall: `POST /api/technical/tracing/recall`
   - Shows loading state with progress indicator
   - On success: Displays results in selected view mode
   - On error: Shows error state with specific message
   - Toast: "Forward trace completed. 47 descendants found."

2. **Switch View Mode**:
   - List â†’ Tree: Transforms data for D3.js visualization
   - Tree â†’ Matrix: Flattens tree to matrix format
   - Matrix â†’ List: Standard table view
   - Preserves search results across view changes
   - No new API call required

3. **Export Results**:
   - **CSV Export**: Downloads traceability links table
   - **PDF Report**: Generates full report with all sections
   - **FDA JSON/XML**: Regulatory format for recall reports
   - Includes all metadata (search params, timestamp, user)
   - File naming: `traceability_LP-2024-001234_forward_20241214.csv`

### Secondary Actions

1. **Autocomplete Lot ID**:
   - Debounced search (300ms)
   - Queries recent LPs: `GET /api/warehouse/license-plates?search={term}`
   - Shows dropdown with max 10 results
   - Displays: LP number, product name, batch
   - Select populates search field

2. **View Node Details** (Tree View):
   - Click node to show modal with:
     - Full LP details
     - Product info
     - Work order link
     - Location
     - Status history
   - Actions: View WO, View Product, View Location

3. **Email to QA**:
   - Opens modal with:
     - To: QA team email (from settings)
     - Subject: "Traceability Report: LP-XXX"
     - Body: Pre-filled with summary
     - Attach: PDF report
   - Sends via email service
   - Toast: "Email sent to [email protected]"

4. **Create CAPA**:
   - Navigates to Quality module
   - Pre-fills CAPA form with:
     - Issue: "Traceability investigation for LP-XXX"
     - Affected lots: List of all descendants
     - Risk level: Based on shipped status
   - Opens in new context to preserve traceability search

5. **Generate Customer Notifications** (Recall only):
   - Creates draft notification emails for all affected customers
   - Pre-fills with:
     - Customer name
     - Affected products
     - Shipped quantities
     - Batch numbers
   - Saves as "pending" in recall_simulations table
   - Toast: "12 customer notifications created. Review in Shipping module."

---

## 4 States (Detailed)

### Loading State
- **Trigger**: Search button clicked
- **Display**:
  - Disable search form (gray out fields)
  - Show spinner icon in results area
  - Progress bar (0-100%)
  - Status messages:
    - "Querying license plates..."
    - "Building genealogy tree (depth X of Y)..."
    - "Processing N LPs across M warehouses..."
  - Estimated time if >3s: "This may take 10-15 seconds for large datasets"
- **Duration**: Typically 0.5-3s, up to 15s for deep trees
- **Cancellation**: Not supported (query must complete)

### Empty State
- **Trigger**: Initial page load, no search performed yet
- **Display**:
  - Search form enabled and empty
  - Large search icon (ğŸ”)
  - Heading: "No Traceability Search Yet"
  - Instructions:
    - "Enter a Lot ID or Batch Number to start tracing."
    - What you can do: List of 3 actions
  - Link: "View Traceability Guide"
- **Search button**: Disabled (no input)

### Error State
- **Trigger**: API error, lot not found, or validation failure
- **Display**:
  - Red banner at top: "Error: Lot ID not found..."
  - Search form enabled (to retry)
  - Error details panel:
    - âŒ icon
    - Heading: "Traceability Search Failed"
    - Specific issues (bulleted list):
      - "Lot ID 'LP-9999-INVALID' does not exist"
      - "No license plates found matching this identifier"
    - Suggestions (bulleted list):
      - "Check if the Lot ID is correct"
      - "Try searching by Batch Number instead"
      - etc.
    - Actions: [Try Again] [Search Recent Lots]
- **Error types**:
  - **Not Found**: Lot ID doesn't exist
  - **No Data**: Lot exists but no traceability links
  - **Invalid Format**: Lot ID format invalid
  - **Network Error**: API timeout or 500 error
  - **Permission Error**: User lacks access to this lot
- **Recovery**: User can edit search and retry

### Success State
- **Trigger**: API returns results successfully
- **Display**:
  - Search form collapsed (with "Edit Search" button to expand)
  - Results summary panel (root LP + stats)
  - View mode tabs (List/Tree/Matrix)
  - Selected view content:
    - **List**: Paginated table of traceability links
    - **Tree**: D3.js visualization with controls
    - **Matrix**: Excel-style matrix table
  - Quick actions panel
- **Data present**: At least 1 traceability link
- **Empty results**: Show message "No descendants found. This lot has not been consumed yet."

---

## Validation Rules

| Field | Rules | Error Message |
|-------|-------|---------------|
| Lot ID | Required if Batch Number empty | "Enter Lot ID or Batch Number" |
| Lot ID | Format: `LP-YYYY-NNNNNN` (regex) | "Invalid Lot ID format. Expected: LP-YYYY-NNNNNN" |
| Batch Number | Optional, min 3 chars | "Batch number too short (min 3 characters)" |
| Date Range | `from <= to` | "From date must be before To date" |
| Date Range | Both or neither (not one) | "Enter both From and To dates" |
| Max Depth | Integer 1-50 | "Max depth must be between 1 and 50" |
| Direction | One of: forward, backward, recall | "Invalid direction" |

**Validation Timing**:
- **On blur**: Lot ID format validation
- **On submit**: All field validation before API call
- **Real-time**: Autocomplete suggestions (debounced 300ms)

**Business Rules**:
- Lot ID takes precedence over Batch Number if both provided
- Date range applies to manufacturing_date of lots
- Max depth limits recursion to prevent infinite loops
- Shipped lots show customer info in results
- Consumed lots show as leaf nodes (no children)

---

## Accessibility

- **Touch Targets**: All buttons >= 48x48dp (especially tree zoom controls)
- **Contrast**: Error text (#DC2626), success text (#16A34A) pass WCAG AA
- **Screen Reader**:
  - Announces "Traceability Search Form"
  - Table headers: "Depth", "Parent Lot", "Child Lot", etc.
  - Tree nodes: "LP-2024-001234, Flour Type 550, 1000 kg, Available"
  - Status: "Recall simulation completed. 47 lots affected."
- **Keyboard Navigation**:
  - **Tab**: Through search form fields
  - **Enter**: Submit search
  - **Arrow keys**: Navigate tree (when focused)
  - **+/-**: Zoom tree
  - **Space**: Expand/collapse tree node
  - **Escape**: Close node details modal
- **Focus Management**:
  - Focus Lot ID input on page load
  - Focus first result after search completes
  - Trap focus in node details modal
  - Return focus to triggering element on modal close
- **ARIA Attributes**:
  - `role="search"` on search form
  - `role="tree"` on genealogy visualization
  - `role="treeitem"` on each node
  - `aria-expanded` on expandable nodes
  - `aria-label="Zoom in tree visualization"` on zoom buttons
  - `aria-live="polite"` on status messages
  - `aria-busy="true"` during loading
- **Color Independence**:
  - Status not indicated by color alone
  - Icons + text labels for all statuses
  - Tree nodes have text labels, not just colors

---

## Technical Notes

### API Endpoints

```typescript
// Forward Trace
POST /api/technical/tracing/forward
Body: {
  lp_id?: string;
  batch_number?: string;
  max_depth?: number;  // default 20
  include_shipped?: boolean;  // default true
}
Response: TraceResult

// Backward Trace
POST /api/technical/tracing/backward
Body: {
  lp_id?: string;
  batch_number?: string;
  max_depth?: number;
}
Response: TraceResult

// Recall Simulation
POST /api/technical/tracing/recall
Body: {
  lp_id?: string;
  batch_number?: string;
  max_depth?: number;
  include_shipped?: boolean;
  include_notifications?: boolean;  // Generate customer notifications
}
Response: RecallSimulationResult

// Genealogy Tree (alternative endpoint for pure tree data)
GET /api/technical/tracing/genealogy/:lotId?direction=forward&depth=20
Response: TraceNode[]

// Export Traceability Matrix
GET /api/technical/tracing/matrix/:lotId/export?format=csv|excel|pdf
Response: File download
```

### Request/Response Schemas

```typescript
// TraceResult (Forward/Backward)
interface TraceResult {
  root_lp: LicensePlate;
  trace_tree: TraceNode[];
  summary: TraceSummary;
}

interface TraceNode {
  lp: LicensePlate;
  product_code: string;
  product_name: string;
  relationship_type: 'split' | 'combine' | 'transform' | null;
  children: TraceNode[];
  depth: number;
  quantity_from_parent?: number;
}

interface TraceSummary {
  total_descendants?: number;
  total_ancestors?: number;
  total_work_orders?: number;
  max_depth: number;
}

// RecallSimulationResult
interface RecallSimulationResult {
  simulation_id: string;
  root_lp: LicensePlate;
  forward_trace: TraceNode[];
  backward_trace: TraceNode[];
  summary: RecallSummary;
  locations: LocationAnalysis[];
  customers: CustomerImpact[];
  financial: FinancialImpact;
  regulatory: RegulatoryInfo;
  execution_time_ms: number;
  created_at: string;
}

interface RecallSummary {
  total_affected_lps: number;
  total_quantity: number;
  total_estimated_value: number;
  status_breakdown: {
    available: number;
    in_production: number;
    shipped: number;
    consumed: number;
    quarantine: number;
  };
  affected_warehouses: number;
  affected_customers: number;
}

interface LocationAnalysis {
  warehouse_id: string;
  warehouse_name: string;
  affected_lps: number;
  total_quantity: number;
  zones: string[];
}

interface CustomerImpact {
  customer_id: string;
  customer_name: string;
  contact_email: string | null;
  shipped_quantity: number;
  ship_date: string;
  notification_status: 'draft' | 'pending' | 'sent';
}

interface FinancialImpact {
  product_value: number;
  retrieval_cost: number;
  disposal_cost: number;
  lost_revenue: number;
  total_estimated_cost: number;
  confidence_interval: string;  // e.g., "Â±15%"
}

interface RegulatoryInfo {
  reportable_to_fda: boolean;
  report_due_date: string | null;
  report_status: 'draft' | 'not_filed' | 'filed';
  affected_product_types: string[];
}
```

### Zod Validation Schemas

```typescript
// lib/validation/tracing-schemas.ts

import { z } from 'zod';

export const traceSearchSchema = z.object({
  lp_id: z.string().regex(/^LP-\d{4}-\d{6}$/).optional(),
  batch_number: z.string().min(3).optional(),
  max_depth: z.number().int().min(1).max(50).default(20),
  include_shipped: z.boolean().default(true),
  include_notifications: z.boolean().default(false),
}).refine(
  (data) => data.lp_id || data.batch_number,
  { message: "Either lp_id or batch_number must be provided" }
);

export const dateRangeSchema = z.object({
  from: z.string().datetime().optional(),
  to: z.string().datetime().optional(),
}).refine(
  (data) => !data.from || !data.to || new Date(data.from) <= new Date(data.to),
  { message: "From date must be before or equal to To date" }
);

export type TraceSearchInput = z.infer<typeof traceSearchSchema>;
export type DateRangeInput = z.infer<typeof dateRangeSchema>;
```

### Database Queries

**Forward Trace (Recursive CTE)**:
```sql
-- Function: trace_forward(p_lp_id UUID, p_max_depth INT)
-- Returns all descendants of a license plate up to max depth

WITH RECURSIVE trace AS (
  -- Base case: root LP
  SELECT
    id,
    lp_number,
    product_id,
    quantity,
    uom,
    status,
    0 AS depth,
    ARRAY[id] AS path
  FROM license_plates
  WHERE id = p_lp_id

  UNION ALL

  -- Recursive case: children
  SELECT
    lp.id,
    lp.lp_number,
    lp.product_id,
    lp.quantity,
    lp.uom,
    lp.status,
    t.depth + 1,
    t.path || lp.id
  FROM license_plates lp
  JOIN lp_genealogy g ON g.child_lp_id = lp.id
  JOIN trace t ON t.id = g.parent_lp_id
  WHERE t.depth < p_max_depth
    AND NOT lp.id = ANY(t.path)  -- Prevent cycles
)
SELECT * FROM trace
ORDER BY depth, lp_number;
```

**Backward Trace (similar, reverse parent/child)**:
```sql
-- Function: trace_backward(p_lp_id UUID, p_max_depth INT)
-- Same structure, but join on g.parent_lp_id = lp.id instead
```

**Recall Simulation**:
- Calls `trace_forward()` and `trace_backward()`
- Joins with warehouses for location analysis
- Joins with shipments/sales_orders for customer impact
- Calculates financial impact from product costs
- Determines FDA reportability based on product types

### Tree Visualization Library

**Recommended**: D3.js v7+ or React Flow

```typescript
// Example D3.js integration (pseudocode)
import * as d3 from 'd3';

function renderGenealogyTree(data: TraceNode[], container: HTMLElement) {
  const width = 800;
  const height = 600;

  // Create hierarchy
  const root = d3.hierarchy(data[0]);

  // Create tree layout
  const treeLayout = d3.tree().size([height, width]);
  treeLayout(root);

  // Create SVG
  const svg = d3.select(container)
    .append('svg')
    .attr('width', width)
    .attr('height', height)
    .call(d3.zoom().on('zoom', zoomed));

  // Draw links
  svg.selectAll('.link')
    .data(root.links())
    .enter().append('path')
    .attr('class', 'link')
    .attr('d', d3.linkHorizontal()
      .x(d => d.y)
      .y(d => d.x)
    );

  // Draw nodes
  const node = svg.selectAll('.node')
    .data(root.descendants())
    .enter().append('g')
    .attr('class', 'node')
    .attr('transform', d => `translate(${d.y},${d.x})`);

  node.append('circle')
    .attr('r', 5)
    .attr('fill', d => getStatusColor(d.data.lp.status));

  node.append('text')
    .attr('dy', -10)
    .text(d => d.data.lp.lp_number);

  // Zoom handler
  function zoomed(event) {
    svg.attr('transform', event.transform);
  }
}

function getStatusColor(status: string): string {
  const colors = {
    available: '#16A34A',      // green
    in_production: '#3B82F6',  // blue
    shipped: '#DC2626',        // red
    consumed: '#6B7280',       // gray
    quarantine: '#F59E0B',     // yellow
  };
  return colors[status] || '#6B7280';
}
```

**Alternative**: React Flow (easier React integration)
```typescript
import ReactFlow, { Node, Edge } from 'reactflow';

function transformToReactFlowNodes(traceTree: TraceNode[]): { nodes: Node[], edges: Edge[] } {
  // Transform TraceNode[] to ReactFlow format
  // ...
}
```

### Performance Considerations

- **Large Datasets**: Virtual scrolling for 1000+ lots in list view
- **Deep Trees**: Limit default max_depth to 20 to prevent UI freeze
- **Recall Simulation**: Run as background job if >100 affected LPs
- **Caching**: Cache trace results for 5 minutes (Redis)
- **Pagination**: List view paginated at 10 rows per page
- **Lazy Loading**: Tree nodes load children on expand for depth >3

### Caching Strategy

```typescript
// Redis keys
'org:{orgId}:trace:forward:{lpId}:depth{N}'   // 5 min TTL
'org:{orgId}:trace:backward:{lpId}:depth{N}'  // 5 min TTL
'org:{orgId}:recall:{lpId}'                   // 10 min TTL
```

---

## Related Screens

- **Warehouse > License Plates**: [WHM-XXX] (source of lot data)
- **Production > Work Orders**: [PRD-XXX] (creates traceability links)
- **Quality > CAPA**: [QLT-XXX] (linked from Quick Actions)
- **Shipping > Sales Orders**: [SHP-XXX] (customer shipment data)

---

## Business Rules

### Traceability Rules

1. **Forward Trace (Where Used)**:
   - Finds all child LPs that consumed the root LP
   - Includes partial consumption (LP split scenarios)
   - Stops at shipped LPs (leaf nodes)
   - Includes work orders that consumed the LP
   - Max depth prevents infinite loops (default 20)

2. **Backward Trace (What Consumed)**:
   - Finds all parent LPs that were consumed to create the root LP
   - Traces back to raw material receipts
   - Includes BOM ingredient relationships
   - Shows purchase orders for RM lots
   - Max depth limits ancestor search

3. **Recall Simulation**:
   - Combines forward + backward trace
   - Calculates financial impact using product costs
   - Identifies affected customers from shipments
   - Determines FDA reportability based on:
     - Product type (finished goods)
     - Quantity shipped
     - Customer count
   - Report due date = simulation date + 2 business days
   - Creates draft customer notifications if requested

4. **Genealogy Tree**:
   - Relationship types:
     - **Split**: 1 parent â†’ many children (LP divided)
     - **Combine**: many parents â†’ 1 child (ingredients combined)
     - **Transform**: 1 parent â†’ 1 child (processing)
   - Displays quantity consumed from each parent
   - Shows WO link for production relationships
   - Shows PO/SO link for procurement/sales

5. **Lot Status Impact**:
   - **Available**: Can be consumed in production
   - **In Production**: Currently being consumed (WO in progress)
   - **Shipped**: No further children possible (leaf node)
   - **Consumed**: Fully consumed, can only be parent (not child)
   - **Quarantine**: Blocked from use, highlighted in recall

6. **Matrix Report**:
   - Shows complete input/output audit trail
   - One row per lot
   - Columns: Lot ID, Product, Batch, Mfg Date, Consumed In, Produced From
   - Export formats: CSV, Excel, PDF
   - Includes all metadata for regulatory compliance

### Regulatory Compliance

**FDA Reportable Criteria** (US Food Safety):
- Finished goods shipped to customers: YES
- Work-in-progress not shipped: NO
- Raw materials in warehouse: NO
- Quantity >100 units shipped: YES
- Quantity <100 units shipped: Review required

**Report Due Date Calculation**:
- Simulation date + 2 business days (excludes weekends/holidays)
- If shipped to >10 customers: Immediate (24 hours)

**Customer Notification Requirements**:
- Must include: Product name, lot number, batch number, mfg date, expiry date
- Must provide: Return instructions, refund policy, contact info
- Language: Customer's preferred language (from customer master)

---

## Handoff Notes

### For FRONTEND-DEV:

1. **Page Structure**:
   - Use standard page layout (not modal)
   - Component: `app/(authenticated)/technical/tracing/page.tsx` (EXISTS)
   - Reuse existing components: `GenealogyTree.tsx`, `TechnicalHeader.tsx`

2. **API Integration**:
   - Service: `lib/services/genealogy-service.ts` (EXISTS)
   - Service: `lib/services/recall-service.ts` (EXISTS)
   - Validation: `lib/validation/tracing-schemas.ts` (EXISTS)
   - Types: `lib/types/traceability.ts` (EXISTS)

3. **Tree Visualization**:
   - Existing implementation uses `GenealogyTree.tsx` component
   - Supports pan/zoom, node click
   - Enhance with:
     - Collapse/expand controls
     - Legend
     - Keyboard navigation
   - Accessibility: Add ARIA tree roles, keyboard handlers

4. **State Management**:
   - Use React state for search form
   - Use React Query for API calls (cache 5 min)
   - Local state for view mode (List/Tree/Matrix)
   - URL params for deep linking: `/tracing?lot=LP-2024-001234&direction=forward`

5. **Performance**:
   - Virtual scrolling for list view (1000+ rows)
   - Lazy load tree children for depth >3
   - Debounce autocomplete (300ms)
   - Show loading progress for slow queries (>3s)

6. **Export Features**:
   - CSV: Use Papa Parse or similar
   - PDF: Use jsPDF + autoTable
   - FDA JSON/XML: Use existing templates from recall-service

7. **Styling**:
   - TailwindCSS (already used in existing code)
   - Status colors: Match existing palette
   - Tree nodes: Minimum 40x40px for touch
   - Print-friendly CSS for PDF export

8. **Testing**:
   - Unit tests: Form validation, data transformations
   - Integration tests: API calls (use existing tests in `__tests__/api/technical/tracing.test.ts`)
   - E2E tests: Full search flow (use existing `e2e/batch2-traceability.spec.ts`)
   - Accessibility: Axe-core audit

### For BACKEND-DEV:

1. **Existing Implementation**:
   - Routes exist: `app/api/technical/tracing/{forward,backward,recall}/route.ts`
   - Database functions exist: `trace_forward()`, `trace_backward()` (migration 033)
   - Tables exist: `lp_genealogy`, `recall_simulations`
   - No new backend work required unless:
     - Performance issues with large datasets
     - Need for additional filters
     - Export format additions

2. **Optimizations** (if needed):
   - Add indexes on `lp_genealogy(parent_lp_id)`, `lp_genealogy(child_lp_id)`
   - Materialize genealogy paths for faster queries
   - Add Redis caching for frequently accessed lots

3. **New Features** (future):
   - Traceability matrix export API
   - Customer notification email generation
   - FDA XML export format
   - Background job for large recall simulations (>100 LPs)

4. **API Enhancements**:
   - Add `GET /api/technical/tracing/matrix/:lotId/export` endpoint
   - Add `POST /api/technical/tracing/notifications` for customer emails
   - Add `GET /api/technical/tracing/fda/:simulationId/xml` for FDA export

---

## Mobile Responsive Design

### Mobile (< 768px)

- **Search Form**: Stack vertically
  - Lot ID: Full width
  - Batch Number: Full width
  - Date Range: Full width
- **Tabs**: Horizontal scroll if overflow
- **List View**: Horizontal scroll for table
  - Show only 3 columns initially (Lot, Product, Status)
  - Expand row for details
- **Tree View**:
  - Horizontal scroll enabled
  - Touch gestures: Pinch zoom, two-finger pan
  - Larger nodes (60x60px min)
- **Recall Sections**: Stack vertically
  - Stat cards: 2 columns (2x2 grid)
  - Tables: Horizontal scroll

### Tablet (768px - 1024px)

- **Search Form**: 2 columns
  - Lot ID + Batch Number: Row 1
  - Date Range: Row 2
- **List View**: Show all columns
- **Tree View**: Full width, standard controls
- **Recall Sections**: 2-column layout for stats

### Desktop (> 1024px)

- **Search Form**: 3 columns inline
- **List View**: Full table, 10 rows per page
- **Tree View**: Full canvas with side panel for node details
- **Recall Sections**: Multi-column layout
- **Quick Actions**: Floating panel (right sidebar)

---

## Print-Friendly Layout

When user clicks "Print" or "Export PDF":

1. **Hide Elements**:
   - Navigation header
   - Search form (show search criteria as text)
   - View mode tabs
   - Zoom controls
   - Action buttons

2. **Show Elements**:
   - Company logo + name
   - Report title: "Traceability Report"
   - Search criteria summary
   - Generated date/time
   - User name
   - Page numbers (footer)

3. **Layout Adjustments**:
   - Force List View (tree doesn't print well)
   - Expand all rows (no pagination)
   - Use full table width
   - Black & white friendly (use icons, not just colors)
   - Page breaks: Avoid splitting tables

4. **PDF Export** (via jsPDF):
   - A4 portrait
   - Include all sections
   - Add hyperlinks to WO/SO references
   - Embed metadata (lot ID, date, user)

---

## Quality Gates

Before handoff to implementation:

- [x] All 4 states defined (Loading, Empty, Error, Success)
- [x] ASCII wireframes created for each state
- [x] Validation rules documented
- [x] API endpoints specified with request/response schemas
- [x] Zod validation schemas defined
- [x] Accessibility requirements documented (WCAG AA)
- [x] Touch targets >= 48x48dp
- [x] Keyboard navigation specified
- [x] ARIA attributes defined
- [x] Mobile responsive breakpoints specified
- [x] Business rules documented
- [x] Error handling scenarios covered
- [x] Performance considerations noted
- [x] Tree visualization library selected
- [x] Export formats specified (CSV, PDF, FDA JSON/XML)
- [x] Regulatory compliance requirements included
- [x] Database queries documented (recursive CTE)
- [x] Related screens linked

---

## Estimated Effort

**Frontend**: 12-16 hours
- Search form + validation: 2 hours
- List view with pagination: 2 hours
- Tree view integration (D3.js enhancements): 4-6 hours
- Matrix view: 2 hours
- Recall simulation layout: 2 hours
- Export features (CSV, PDF): 2 hours
- Accessibility enhancements: 2 hours
- Testing (unit + E2E): 2 hours

**Backend**: 4-6 hours (enhancements only)
- Matrix export API: 2 hours
- Customer notification generation: 2 hours
- FDA XML export: 2 hours

**Total**: 16-22 hours

---

## Quality Target

**Score**: 98/100

**Deductions**:
- Tree visualization complexity (may need iteration): -1
- Large dataset performance (virtual scrolling): -1

**Strengths**:
- Critical regulatory feature (100% compliance required)
- Comprehensive 4-state coverage
- Accessibility-first design
- Existing code foundation (reduces risk)
- Clear API contracts
- Detailed business rules

---

**Status**: Ready for Implementation
**Approval Required**: No (critical regulatory feature, auto-approved)
**Iterations**: 0 of 3
**Next Steps**: Handoff to FRONTEND-DEV for implementation
