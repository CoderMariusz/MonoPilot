# TEC-010: Routing Detail Page

**Module**: Technical
**Feature**: Routing Operations Management (Story 2.24 - Routing Restructure)
**Type**: Full Page (Detail/Edit View)
**Path**: `/technical/routings/{id}`
**Status**: Ready for Implementation
**Last Updated**: 2025-12-14

---

## Overview

Detail page for viewing and managing routing header information and operations. This is the primary workspace for building production routings with sequential operations. Users land here after creating a routing in TEC-008 modal.

**Business Context:**
- Routing = production workflow template (e.g., "Bread Line", "Cake Production")
- Operations = sequential steps in the workflow (e.g., "Mixing", "Proofing", "Baking")
- Each operation has: sequence, name, machine, duration, yield, labor cost
- Operations are reorderable (drag-drop or up/down arrows)
- Operations can be added, edited, deleted independently
- Total cost and duration calculated automatically

**Page Purpose:**
- Display routing header (code, name, status, reusability, version) - read-only with edit action
- Manage routing operations (CRUD + reorder)
- Show cost/duration summary panel with breakdown
- Link to related BOMs that use this routing

---

## ASCII Wireframe

### Success State (With Operations)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† Back to Routings                                            [Edit Routing]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  RTG-BREAD-01                                                               â”‚
â”‚  Standard Bread Line                                            ðŸŸ¢ Active   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”‚
â”‚  Code: RTG-BREAD-01    Status: ðŸŸ¢ Active    Version: v2    â˜‘ Reusable      â”‚
â”‚  Used by 3 BOMs                                                             â”‚
â”‚                                                                             â”‚
â”‚  Description:                                                               â”‚
â”‚  Mixing â†’ Proofing â†’ Baking â†’ Cooling workflow for standard bread products â”‚
â”‚                                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Production Operations                              [+ Add Operation]        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Seq â”‚ Operation Name     â”‚ Machine      â”‚ Line    â”‚ Duration â”‚ Setup  â”‚ â”‚
â”‚  â”‚     â”‚                    â”‚              â”‚         â”‚   (min)  â”‚ (min)  â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚  1  â”‚ Mixing             â”‚ Mixer-01     â”‚ Line-A  â”‚    15    â”‚   5    â”‚ â”‚
â”‚  â”‚     â”‚                    â”‚              â”‚         â”‚          â”‚        â”‚ â”‚
â”‚  â”‚     â”‚ Yield: 98% â”‚ Labor: $12.00/hr             [â†‘] [â†“] [âœŽ] [ðŸ—‘] â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚  2  â”‚ Proofing           â”‚ Proofer-A    â”‚ Line-A  â”‚    45    â”‚   0    â”‚ â”‚
â”‚  â”‚     â”‚                    â”‚              â”‚         â”‚          â”‚        â”‚ â”‚
â”‚  â”‚     â”‚ Yield: 100% â”‚ Labor: $8.00/hr              [â†‘] [â†“] [âœŽ] [ðŸ—‘] â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚  3  â”‚ Baking             â”‚ Oven-02      â”‚ Line-A  â”‚    30    â”‚  10    â”‚ â”‚
â”‚  â”‚     â”‚                    â”‚              â”‚         â”‚          â”‚        â”‚ â”‚
â”‚  â”‚     â”‚ Yield: 95% â”‚ Labor: $15.00/hr             [â†‘] [â†“] [âœŽ] [ðŸ—‘] â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚  4  â”‚ Cooling            â”‚ -            â”‚ Line-A  â”‚    20    â”‚   0    â”‚ â”‚
â”‚  â”‚     â”‚                    â”‚              â”‚         â”‚          â”‚        â”‚ â”‚
â”‚  â”‚     â”‚ Yield: 100% â”‚ Labor: $5.00/hr              [â†‘] [â†“] [âœŽ] [ðŸ—‘] â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Cost & Duration Summary                             [â„¹ï¸ View Breakdown â–¼] â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Total Operations:    4                                               â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  Total Duration:      110 minutes (1h 50m)                            â”‚ â”‚
â”‚  â”‚    â”œâ”€ Mixing: 15 min (setup: 5 min, cleanup: 2 min)                  â”‚ â”‚
â”‚  â”‚    â”œâ”€ Proofing: 45 min (setup: 0 min, cleanup: 0 min)                â”‚ â”‚
â”‚  â”‚    â”œâ”€ Baking: 30 min (setup: 10 min, cleanup: 3 min)                 â”‚ â”‚
â”‚  â”‚    â””â”€ Cooling: 20 min (setup: 0 min, cleanup: 0 min)                 â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  Total Labor Cost:    $40.00                                          â”‚ â”‚
â”‚  â”‚    â”œâ”€ Mixing: $12.00 (15 min Ã— $15/hr + setup)                       â”‚ â”‚
â”‚  â”‚    â”œâ”€ Proofing: $8.00 (45 min Ã— $10/hr)                              â”‚ â”‚
â”‚  â”‚    â”œâ”€ Baking: $15.00 (30 min Ã— $20/hr + setup)                       â”‚ â”‚
â”‚  â”‚    â””â”€ Cooling: $5.00 (20 min Ã— $12/hr)                               â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  Average Yield:       98.25% [â„¹ï¸ Weighted by duration]               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Related BOMs (3)                                                           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”‚
â”‚                                                                             â”‚
â”‚  - PRD-BREAD-WH-01 (White Bread - 800g) v1.0                               â”‚
â”‚  - PRD-BREAD-WW-01 (Whole Wheat Bread - 800g) v1.0                         â”‚
â”‚  - PRD-BREAD-MG-01 (Multigrain Bread - 800g) v1.0                          â”‚
â”‚                                                                             â”‚
â”‚  [View All BOMs â†’]                                                          â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Empty State (No Operations)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† Back to Routings                                            [Edit Routing]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  RTG-BREAD-01                                                               â”‚
â”‚  Standard Bread Line                                            ðŸŸ¢ Active   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”‚
â”‚  Code: RTG-BREAD-01    Status: ðŸŸ¢ Active    Version: v1    â˜‘ Reusable      â”‚
â”‚  Not used yet                                                               â”‚
â”‚                                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Production Operations                              [+ Add Operation]        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                                       â”‚ â”‚
â”‚  â”‚                        ðŸ“‹                                             â”‚ â”‚
â”‚  â”‚                                                                       â”‚ â”‚
â”‚  â”‚              No operations yet                                        â”‚ â”‚
â”‚  â”‚                                                                       â”‚ â”‚
â”‚  â”‚   Add your first production step to define this routing workflow.    â”‚ â”‚
â”‚  â”‚                                                                       â”‚ â”‚
â”‚  â”‚              [+ Add First Operation]                                  â”‚ â”‚
â”‚  â”‚                                                                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  â„¹ Example operations for a bread routing:                           â”‚ â”‚
â”‚  â”‚  1. Mixing (15 min) â†’ 2. Proofing (45 min) â†’ 3. Baking (30 min)     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Loading State

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† Back to Routings                                            [Edit Routing]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  [Skeleton: Routing Header]                                                 â”‚
â”‚  [Skeleton: Routing Header]                                 [Skeleton]      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”‚
â”‚                                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Production Operations                              [+ Add Operation]        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚                                                                             â”‚
â”‚                         [Spinner]                                           â”‚
â”‚                                                                             â”‚
â”‚                   Loading operations...                                     â”‚
â”‚                                                                             â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Error State

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† Back to Routings                                            [Edit Routing]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  âŒ Failed to Load Routing                                           â”‚ â”‚
â”‚  â”‚                                                                       â”‚ â”‚
â”‚  â”‚  Error: Routing not found or you don't have permission to view it.   â”‚ â”‚
â”‚  â”‚                                                                       â”‚ â”‚
â”‚  â”‚  [â† Back to Routings List]                         [Retry]            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Operation Modal (Add/Edit Operation)

### Success State (Create Mode)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Add Operation                                                 [X]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  Sequence *                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 5                                                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  Order of operation. Use same sequence for parallel operations.  â”‚
â”‚  Example: Seq 2 (Mixing) + Seq 2 (Heating) = run in parallel     â”‚
â”‚                                                                   â”‚
â”‚  Operation Name *                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ e.g., Mixing, Baking, Cooling                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  Name of the production step                                      â”‚
â”‚                                                                   â”‚
â”‚  Machine                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Select machine... â–¼                                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  Optional: Equipment used for this operation                      â”‚
â”‚                                                                   â”‚
â”‚  Production Line                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Select production line... â–¼                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  Optional: Line where this operation occurs                       â”‚
â”‚                                                                   â”‚
â”‚  Expected Duration (minutes) *                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 30                                                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  How long this operation takes (in minutes)                       â”‚
â”‚                                                                   â”‚
â”‚  Setup Time (minutes)                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 0                                                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  Time to prepare equipment before operation (default: 0)          â”‚
â”‚                                                                   â”‚
â”‚  Cleanup Time (minutes)                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 0                                                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  Time required to clean after this operation (default: 0)         â”‚
â”‚                                                                   â”‚
â”‚  Expected Yield (%)                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 100.00                                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  Percentage of output expected (0-100, default: 100)              â”‚
â”‚                                                                   â”‚
â”‚  Instructions (Optional)                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚ [Textarea for operation instructions]                      â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  Step-by-step instructions for operators (max 2000 chars)         â”‚
â”‚                                                                   â”‚
â”‚  Labor Cost per Hour (PLN/hour)                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 0.00                                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  Hourly labor rate for this operation                             â”‚
â”‚                                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  [Cancel]                                        [Add Operation]  â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Success State (Edit Mode)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Edit Operation                                                [X]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  Sequence *                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 2                                                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  Order of operation. Use same sequence for parallel operations.  â”‚
â”‚  Example: Seq 2 (Mixing) + Seq 2 (Heating) = run in parallel     â”‚
â”‚                                                                   â”‚
â”‚  Operation Name *                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Proofing                                                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  Name of the production step                                      â”‚
â”‚                                                                   â”‚
â”‚  Machine                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Proofer-A â–¼                                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  Optional: Equipment used for this operation                      â”‚
â”‚                                                                   â”‚
â”‚  Production Line                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Line-A â–¼                                                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  Optional: Line where this operation occurs                       â”‚
â”‚                                                                   â”‚
â”‚  Expected Duration (minutes) *                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 45                                                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  How long this operation takes (in minutes)                       â”‚
â”‚                                                                   â”‚
â”‚  Setup Time (minutes)                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 0                                                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  Time to prepare equipment before operation (default: 0)          â”‚
â”‚                                                                   â”‚
â”‚  Cleanup Time (minutes)                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 2                                                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  Time required to clean after this operation (default: 0)         â”‚
â”‚                                                                   â”‚
â”‚  Expected Yield (%)                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 100.00                                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  Percentage of output expected (0-100, default: 100)              â”‚
â”‚                                                                   â”‚
â”‚  Instructions (Optional)                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 1. Set temperature to 35Â°C                                 â”‚ â”‚
â”‚  â”‚ 2. Place dough in proofing chamber                         â”‚ â”‚
â”‚  â”‚ 3. Monitor humidity levels                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  Step-by-step instructions for operators (max 2000 chars)         â”‚
â”‚                                                                   â”‚
â”‚  Labor Cost per Hour (PLN/hour)                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 8.00                                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  Hourly labor rate for this operation                             â”‚
â”‚                                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  [Cancel]                                       [Save Changes]    â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Key Components

### 1. Page Header

#### Routing Info (Read-Only)
- **Code**: Large, prominent (e.g., "RTG-BREAD-01")
- **Name**: Below code (e.g., "Standard Bread Line")
- **Status Badge**: ðŸŸ¢ Active or ðŸ”´ Inactive
- **Version**: Display version number (e.g., "v2")
- **Reusable Flag**: â˜‘ Reusable or â˜ Product-Specific
- **Usage Count**: "Used by X BOMs" or "Not used yet"
- **Description**: Multi-line text, optional

#### Header Actions
- **â† Back to Routings**: Navigate back to TEC-007 list
- **[Edit Routing]**: Opens TEC-008 modal to edit routing header

### 2. Operations Table

#### Table Columns
| Column | Description | Width |
|--------|-------------|-------|
| Seq | Sequence number (1, 2, 3...) | 60px |
| Operation Name | Name of production step | 200px |
| Machine | Optional machine/equipment | 150px |
| Line | Production line | 100px |
| Duration (min) | Expected duration in minutes | 100px |
| Setup (min) | Setup time in minutes | 100px |
| Yield (%) | Sub-row, below name | - |
| Labor Cost/Hr | Sub-row, below name | - |
| Actions | [â†‘] [â†“] [âœŽ] [ðŸ—‘] buttons | 120px |

#### Row Actions
- **[â†‘]**: Move operation up (decrease sequence)
- **[â†“]**: Move operation down (increase sequence)
- **[âœŽ]**: Edit operation (opens Operation Modal)
- **[ðŸ—‘]**: Delete operation (with confirmation)

#### Empty State
- **Icon**: ðŸ“‹ (clipboard)
- **Message**: "No operations yet"
- **Sub-message**: "Add your first production step to define this routing workflow."
- **Action**: "[+ Add First Operation]" button
- **Help Text**: Example operations banner (e.g., "1. Mixing â†’ 2. Proofing â†’ 3. Baking")

### 3. Operation Modal Fields

#### Sequence (Required)
- **Type**: Number input
- **Label**: "Sequence *"
- **Auto-suggest**: Next available sequence number
- **Validation**: Must be unique, positive integer
- **Help Text**: "Auto-suggested next sequence number" (create) or "Operation order in the routing (must be unique)" (edit)

#### Operation Name (Required)
- **Type**: Text input
- **Label**: "Operation Name *"
- **Placeholder**: "e.g., Mixing, Baking, Cooling"
- **Validation**: 3-100 characters, required
- **Help Text**: "Name of the production step"

#### Machine (Optional)
- **Type**: Dropdown (Select)
- **Label**: "Machine"
- **Placeholder**: "Select machine..."
- **Options**: Populated from machines table (filtered by org_id)
- **Help Text**: "Optional: Equipment used for this operation"
- **Allow None**: Yes (user can leave blank)

#### Production Line (Optional)
- **Type**: Dropdown (Select)
- **Label**: "Production Line"
- **Placeholder**: "Select production line..."
- **Options**: Populated from production_lines table
- **Help Text**: "Optional: Line where this operation occurs"
- **Allow None**: Yes

#### Expected Duration (Required)
- **Type**: Number input
- **Label**: "Expected Duration (minutes) *"
- **Placeholder**: "30"
- **Validation**: Positive integer, required
- **Help Text**: "How long this operation takes (in minutes)"

#### Setup Time (Optional)
- **Type**: Number input
- **Label**: "Setup Time (minutes)"
- **Placeholder**: "0"
- **Default**: 0
- **Validation**: Non-negative integer
- **Help Text**: "Time to prepare equipment before operation (default: 0)"

#### Cleanup Time (Optional) - NEW (FR-2.43, FR-2.45)
- **Type**: Number input
- **Label**: "Cleanup Time (minutes)"
- **Placeholder**: "0"
- **Default**: 0
- **Validation**: Non-negative integer
- **Help Text**: "Time required to clean after this operation (default: 0)"

#### Expected Yield (Optional)
- **Type**: Decimal input
- **Label**: "Expected Yield (%)"
- **Placeholder**: "100.00"
- **Default**: 100.00
- **Validation**: 0-100, decimal (2 places)
- **Help Text**: "Percentage of output expected (0-100, default: 100)"

#### Instructions (Optional) - NEW (FR-2.43, FR-2.45)
- **Type**: Textarea
- **Label**: "Instructions (Optional)"
- **Placeholder**: ""
- **Rows**: 4
- **Max Length**: 2000 characters
- **Help Text**: "Step-by-step instructions for operators (max 2000 chars)"

#### Labor Cost per Hour (Optional) - UPDATED (was "Labor Cost")
- **Type**: Decimal input
- **Label**: "Labor Cost per Hour (PLN/hour)"
- **Placeholder**: "0.00"
- **Default**: 0.00
- **Validation**: Non-negative decimal (2 places)
- **Help Text**: "Hourly labor rate for this operation"

### 4. Cost & Duration Summary Panel

**Calculations:**
- **Total Operations**: Count of routing_operations rows
- **Total Duration**: Sum of all operation durations (in minutes, display as "Xh Ym")
- **Total Setup Time**: Sum of all setup times
- **Total Labor Cost**: Sum of all labor costs (display as "$X.XX")
- **Average Yield**: Weighted average of all yields (display as "X.XX%")

**Display:**
- Panel below operations table
- Light gray background
- Large, readable numbers
- Update in real-time as operations change
- **Expandable Breakdown** (default collapsed):
  - Click [â„¹ï¸ View Breakdown â–¼] to expand
  - Shows per-operation breakdown with setup/cleanup times
  - Shows labor cost calculation per operation

### 5. Related BOMs Section

**Purpose**: Show which BOMs are using this routing

**Display:**
- List of BOM codes with product names and versions
- E.g., "PRD-BREAD-WH-01 (White Bread - 800g) v1.0"
- Max 5 shown, with "[View All BOMs â†’]" link if more

**Empty State**: "Not used yet" in routing header

---

## Main Actions

### Add Operation
- **Button**: "[+ Add Operation]" (top-right of operations section)
- **Action**: Opens Operation Modal in create mode
- **Pre-fill**: Sequence = max(current_sequences) + 1
- **On Success**: Close modal, refresh operations table, show toast

### Edit Operation
- **Button**: [âœŽ] (pencil icon) in row actions
- **Action**: Opens Operation Modal in edit mode
- **Pre-fill**: All fields from selected operation
- **On Success**: Close modal, refresh operations table, show toast

### Delete Operation
- **Button**: [ðŸ—‘] (trash icon) in row actions
- **Action**: Show confirmation dialog
- **Confirmation**: "Delete operation '[name]'? This action cannot be undone."
- **On Confirm**: DELETE /api/technical/routings/{routingId}/operations/{operationId}
- **On Success**: Refresh operations table, show toast, resequence remaining operations

### Reorder Operation (Move Up/Down)
- **Buttons**: [â†‘] [â†“] (up/down arrows) in row actions
- **Action**: Swap sequence numbers with adjacent operation
- **API**: PATCH /api/technical/routings/{routingId}/operations/{operationId}/reorder
- **Request**: `{ direction: "up" | "down" }`
- **On Success**: Refresh operations table (no toast, instant feedback)
- **Disable**: [â†‘] on first operation, [â†“] on last operation

### Edit Routing Header
- **Button**: "[Edit Routing]" (top-right of page header)
- **Action**: Opens TEC-008 modal in edit mode
- **Pre-fill**: All routing header fields
- **On Success**: Close modal, refresh page header, show toast

---

## State Transitions

```
Page Loads
  â†“
LOADING (Show skeleton)
  â†“ Fetch routing + operations
SUCCESS (Display routing header + operations table)
  OR
ERROR (Show error banner, offer retry)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

From SUCCESS:

[+ Add Operation] clicked
  â†“
Operation Modal Opens (Create Mode)
  â†“ User fills form
  â†“ [Add Operation]
LOADING (Disable modal buttons)
  â†“ POST /api/technical/routings/{id}/operations
SUCCESS (Close modal, refresh table, toast)
  OR
ERROR (Show error in modal, keep open)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[Edit Operation] clicked
  â†“
Operation Modal Opens (Edit Mode)
  â†“ User edits form
  â†“ [Save Changes]
LOADING (Disable modal buttons)
  â†“ PUT /api/technical/routings/{routingId}/operations/{operationId}
SUCCESS (Close modal, refresh table, toast)
  OR
ERROR (Show error in modal, keep open)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[Delete Operation] clicked
  â†“
Confirmation Dialog Opens
  â†“ [Confirm]
LOADING (Show spinner in row)
  â†“ DELETE /api/technical/routings/{routingId}/operations/{operationId}
SUCCESS (Refresh table, toast)
  OR
ERROR (Show error toast, keep row)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[Reorder Operation] clicked
  â†“
LOADING (Show spinner in row)
  â†“ PATCH /api/technical/routings/{routingId}/operations/{operationId}/reorder
SUCCESS (Refresh table, no toast)
  OR
ERROR (Show error toast, revert)
```

---

## Validation

### Operation Modal Validation

```typescript
{
  sequence: {
    required: "Sequence is required",
    min: { value: 1, message: "Sequence must be at least 1" },
    validate: (value) => {
      // Check uniqueness (client-side check against current operations)
      if (existingSequences.includes(value) && value !== originalSequence) {
        return "Sequence already exists"
      }
      return true
    }
  },
  operation_name: {
    required: "Operation name is required",
    minLength: { value: 3, message: "Name must be at least 3 characters" },
    maxLength: { value: 100, message: "Name must be less than 100 characters" }
  },
  machine_id: {
    // Optional, no validation
  },
  production_line_id: {
    // Optional, no validation
  },
  expected_duration: {
    required: "Duration is required",
    min: { value: 1, message: "Duration must be at least 1 minute" }
  },
  setup_time: {
    min: { value: 0, message: "Setup time cannot be negative" }
  },
  cleanup_time: {
    min: { value: 0, message: "Cleanup time cannot be negative" }
  },
  expected_yield: {
    min: { value: 0, message: "Yield cannot be negative" },
    max: { value: 100, message: "Yield cannot exceed 100%" }
  },
  instructions: {
    maxLength: { value: 2000, message: "Instructions must be less than 2000 characters" }
  },
  labor_cost_per_hour: {
    min: { value: 0, message: "Labor cost per hour cannot be negative" }
  }
}
```

### Error Messages

```typescript
{
  "DUPLICATE_SEQUENCE": "Sequence [X] already exists. Please choose a different sequence.",
  "INVALID_SEQUENCE": "Sequence must be a positive integer.",
  "OPERATION_NOT_FOUND": "Operation not found.",
  "PERMISSION_DENIED": "You do not have permission to modify this routing.",
  "ROUTING_INACTIVE": "Cannot add operations to an inactive routing."
}
```

---

## Data Required

### API Endpoints

#### Get Routing with Operations
```
GET /api/technical/routings/{id}
```

**Response:**
```typescript
{
  routing: {
    id: string
    org_id: string
    code: string
    name: string
    description: string | null
    status: "Active" | "Inactive"
    is_reusable: boolean
    version: number  // Added
    operations_count: number
    boms_count: number  // Number of BOMs using this routing
    created_at: string
    updated_at: string
    created_by: string
  },
  operations: [
    {
      id: string
      routing_id: string
      sequence: number
      operation_name: string
      machine_id: string | null
      machine_name: string | null  // Joined from machines table
      production_line_id: string | null
      production_line_name: string | null  // Joined from production_lines
      expected_duration: number  // minutes
      setup_time: number  // minutes
      cleanup_time: number  // minutes (NEW)
      expected_yield: number  // decimal, 0-100
      instructions: string | null  // NEW
      labor_cost_per_hour: number  // decimal (UPDATED)
      created_at: string
      updated_at: string
    }
  ],
  related_boms: [
    {
      id: string
      product_code: string
      product_name: string
      version: string
    }
  ]
}
```

#### Create Operation
```
POST /api/technical/routings/{routingId}/operations
```

**Request Body:**
```typescript
{
  sequence: number
  operation_name: string
  machine_id?: string | null
  production_line_id?: string | null
  expected_duration: number
  setup_time?: number  // default 0
  cleanup_time?: number  // default 0 (NEW)
  expected_yield?: number  // default 100
  instructions?: string | null  // NEW
  labor_cost_per_hour?: number  // default 0 (UPDATED)
}
```

**Response:**
```typescript
{
  operation: {
    id: string
    routing_id: string
    sequence: number
    operation_name: string
    machine_id: string | null
    production_line_id: string | null
    expected_duration: number
    setup_time: number
    cleanup_time: number  // NEW
    expected_yield: number
    instructions: string | null  // NEW
    labor_cost_per_hour: number  // UPDATED
    created_at: string
    updated_at: string
  }
}
```

#### Update Operation
```
PUT /api/technical/routings/{routingId}/operations/{operationId}
```

**Request Body:** (same as create)

**Response:** (same as create)

#### Delete Operation
```
DELETE /api/technical/routings/{routingId}/operations/{operationId}
```

**Response:**
```typescript
{
  success: true
  message: "Operation deleted successfully"
}
```

#### Reorder Operation
```
PATCH /api/technical/routings/{routingId}/operations/{operationId}/reorder
```

**Request Body:**
```typescript
{
  direction: "up" | "down"
}
```

**Response:**
```typescript
{
  success: true
  updated_operations: [
    {
      id: string
      sequence: number
    }
  ]
}
```

#### Get Machines (for dropdown)
```
GET /api/settings/machines?org_id={org_id}
```

**Response:**
```typescript
{
  machines: [
    {
      id: string
      name: string
      code: string
    }
  ]
}
```

#### Get Production Lines (for dropdown)
```
GET /api/settings/production-lines?org_id={org_id}
```

**Response:**
```typescript
{
  production_lines: [
    {
      id: string
      name: string
      code: string
    }
  ]
}
```

---

## Technical Notes

### Auto-Suggest Next Sequence
```typescript
// When opening Add Operation modal
const maxSequence = Math.max(...operations.map(op => op.sequence), 0)
const nextSequence = maxSequence + 1

setDefaultValues({
  sequence: nextSequence,
  operation_name: "",
  machine_id: null,
  production_line_id: null,
  expected_duration: 0,
  setup_time: 0,
  cleanup_time: 0,  // NEW
  expected_yield: 100,
  instructions: null,  // NEW
  labor_cost_per_hour: 0  // UPDATED
})
```

### Reorder Logic (Up/Down)
```typescript
// Move operation up (decrease sequence by 1)
const moveUp = async (operationId: string, currentSequence: number) => {
  if (currentSequence === 1) return  // Already at top

  // Swap with operation above (sequence - 1)
  const response = await fetch(
    `/api/technical/routings/${routingId}/operations/${operationId}/reorder`,
    {
      method: 'PATCH',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ direction: 'up' })
    }
  )

  if (response.ok) {
    // Server handles swapping sequences
    refreshOperations()
  }
}

// Move operation down (increase sequence by 1)
const moveDown = async (operationId: string, currentSequence: number) => {
  const maxSequence = Math.max(...operations.map(op => op.sequence))
  if (currentSequence === maxSequence) return  // Already at bottom

  // Swap with operation below (sequence + 1)
  const response = await fetch(
    `/api/technical/routings/${routingId}/operations/${operationId}/reorder`,
    {
      method: 'PATCH',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ direction: 'down' })
    }
  )

  if (response.ok) {
    refreshOperations()
  }
}
```

### Cost & Duration Calculations
```typescript
const calculateSummary = (operations: Operation[]) => {
  const totalOperations = operations.length
  const totalDuration = operations.reduce((sum, op) => sum + op.expected_duration, 0)
  const totalSetupTime = operations.reduce((sum, op) => sum + op.setup_time, 0)
  const totalCleanupTime = operations.reduce((sum, op) => sum + (op.cleanup_time ?? 0), 0)  // NEW

  // Labor cost calculation with per-hour rate
  const totalLaborCost = operations.reduce((sum, op) => {
    const hours = (op.expected_duration + op.setup_time + (op.cleanup_time ?? 0)) / 60
    const costPerHour = op.labor_cost_per_hour ?? 0
    return sum + (costPerHour * hours)
  }, 0)

  // Weighted average yield
  const totalYield = operations.reduce((sum, op) => {
    return sum + (op.expected_yield * op.expected_duration)
  }, 0)
  const avgYield = totalDuration > 0 ? totalYield / totalDuration : 100

  return {
    totalOperations,
    totalDuration,
    totalSetupTime,
    totalCleanupTime,  // NEW
    totalLaborCost,
    avgYield
  }
}

// Format duration as "Xh Ym"
const formatDuration = (minutes: number) => {
  const hours = Math.floor(minutes / 60)
  const mins = minutes % 60
  if (hours > 0) {
    return `${hours}h ${mins}m`
  }
  return `${mins}m`
}
```

### Delete Confirmation
```typescript
const handleDeleteOperation = async (operationId: string, operationName: string) => {
  const confirmed = await showConfirmDialog({
    title: "Delete Operation",
    message: `Delete operation '${operationName}'? This action cannot be undone.`,
    confirmText: "Delete",
    cancelText: "Cancel",
    variant: "destructive"
  })

  if (!confirmed) return

  setLoading(true)

  try {
    const response = await fetch(
      `/api/technical/routings/${routingId}/operations/${operationId}`,
      { method: 'DELETE' }
    )

    if (!response.ok) throw new Error('Failed to delete operation')

    toast({
      title: 'Success',
      description: 'Operation deleted successfully'
    })

    refreshOperations()
  } catch (error) {
    toast({
      title: 'Error',
      description: error.message,
      variant: 'destructive'
    })
  } finally {
    setLoading(false)
  }
}
```

### Accessibility (WCAG 2.1 AA)

- **Close button**: aria-label="Close modal"
- **Info banners**: role="status" aria-live="polite"
- **Error banners**: aria-live="assertive"
- **Loading states**: aria-busy="true" with descriptive label
- **All interactive elements**: keyboard navigable (Tab/Shift+Tab)
- **Touch targets**: >= 48x48dp
- **Color contrast**: >= 4.5:1 for text, >= 3:1 for UI components

- **Focus**: Operations table keyboard navigable
- **Screen Reader**: All buttons have aria-labels
  - [â†‘]: "Move operation up"
  - [â†“]: "Move operation down"
  - [âœŽ]: "Edit operation"
  - [ðŸ—‘]: "Delete operation"
- **Touch Targets**: All action buttons >= 48x48dp
- **Keyboard Shortcuts**:
  - Arrow keys to navigate table rows
  - Enter to edit operation
  - Delete key to delete operation (with confirmation)
- **Error Announce**: Validation errors announced to screen reader

---

## Related Screens

- **Previous**: TEC-007 Routings List (â† Back button)
- **Previous**: TEC-008 Routing Modal (for editing routing header)
- **Next**: TEC-009 Nutrition Panel (different feature)
- **Related**: TEC-006 BOM Modal (BOMs reference this routing)

---

## Handoff Notes

### For FRONTEND-DEV

1. **Component**: `app/(authenticated)/technical/routings/[id]/page.tsx`
2. **Existing Code**: New screen, no existing implementation
3. **Key Features**:
   - Server-side data fetching (Next.js 15 App Router)
   - Operations table with inline actions (edit/delete/reorder)
   - Operation modal (ShadCN Dialog)
   - Cost/duration summary panel (auto-calculated with expandable breakdown)
   - Related BOMs section
   - Version display in header

4. **Libraries**:
   - ShadCN `Table` for operations list
   - ShadCN `Dialog` for operation modal
   - ShadCN `Select` for machine/line dropdowns
   - ShadCN `Badge` for status indicator
   - ShadCN `Textarea` for instructions field
   - `react-hook-form` + Zod for operation form validation

5. **Validation Schema** (Zod):
```typescript
import { z } from 'zod'

const operationFormSchema = z.object({
  sequence: z.number()
    .int("Sequence must be an integer")
    .min(1, "Sequence must be at least 1"),
  operation_name: z.string()
    .min(3, "Name must be at least 3 characters")
    .max(100, "Name must be less than 100 characters"),
  machine_id: z.string().nullable().optional(),
  production_line_id: z.string().nullable().optional(),
  expected_duration: z.number()
    .int("Duration must be an integer")
    .min(1, "Duration must be at least 1 minute"),
  setup_time: z.number()
    .int("Setup time must be an integer")
    .min(0, "Setup time cannot be negative")
    .default(0),
  cleanup_time: z.number()
    .int("Cleanup time must be an integer")
    .min(0, "Cleanup time cannot be negative")
    .default(0),
  expected_yield: z.number()
    .min(0, "Yield cannot be negative")
    .max(100, "Yield cannot exceed 100%")
    .default(100),
  instructions: z.string()
    .max(2000, "Instructions must be less than 2000 characters")
    .optional(),
  labor_cost_per_hour: z.number()
    .min(0, "Labor cost per hour cannot be negative")
    .default(0)
})
```

6. **State Management**:
   - Page-level state for routing data, operations list
   - Modal state for operation create/edit
   - Loading state for async operations
   - Error state for API failures
   - Expandable state for cost breakdown

7. **Real-Time Updates**:
   - Refresh operations table after create/edit/delete
   - Update summary panel automatically when operations change
   - No toast for reorder (instant visual feedback)

8. **Error Handling**:
   - Handle 404 for routing not found
   - Handle 403 for permission denied
   - Handle validation errors in operation modal
   - Handle duplicate sequence errors

---

## Field Verification (PRD Cross-Check)

**Routing Operations Fields (from PRD Section 3.1 - routing_operations table):**
- âœ… id, routing_id (auto-generated, internal)
- âœ… sequence (Number input, required, unique per routing)
- âœ… operation_name (Text input, required, 3-100 chars)
- âœ… machine_id (Dropdown, optional, FK to machines table)
- âœ… production_line_id (Dropdown, optional, FK to production_lines table)
- âœ… expected_duration (Number input, required, minutes)
- âœ… setup_time (Number input, optional, default 0, minutes)
- âœ… cleanup_time (Number input, optional, default 0, minutes) - **ADDED**
- âœ… expected_yield (Decimal input, optional, default 100, 0-100%)
- âœ… instructions (Textarea, optional, max 2000 chars) - **ADDED**
- âœ… labor_cost_per_hour (Decimal input, optional, default 0) - **UPDATED** (was labor_cost)
- âœ… created_at, updated_at (auto-generated, audit fields)

**Routing Header Fields:**
- âœ… version (Display in header, read-only) - **ADDED**

**Business Rules:**
- âœ… Sequence must be unique within routing (Validation)
- âœ… Operations are reorderable (Up/Down arrows)
- âœ… Default yield = 100% (Pre-filled)
- âœ… Default setup_time = 0 (Pre-filled)
- âœ… Default cleanup_time = 0 (Pre-filled) - **ADDED**
- âœ… Default labor_cost_per_hour = 0 (Pre-filled) - **UPDATED**
- âœ… Summary panel calculates totals and averages (Auto-calculated)
- âœ… Summary panel shows cost breakdown (Expandable) - **ENHANCED**
- âœ… Related BOMs section shows usage (Fetched from API)

**ALL PRD FIELDS VERIFIED âœ…**

---

**Status**: Ready for Implementation
**Approval Mode**: Auto-Approve
**Iterations**: 0 of 3
**PRD Compliance**: 100% (all fields verified + enhancements)
**PRD Coverage**: FR-2.41, FR-2.43, FR-2.44, FR-2.45
