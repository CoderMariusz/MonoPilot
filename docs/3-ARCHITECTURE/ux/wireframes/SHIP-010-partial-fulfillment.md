# SHIP-010: Partial Fulfillment & Backorder Creation

**Module**: Shipping Management
**Feature**: Partial SO Fulfillment with Backorder Creation (FR-7.15, FR-7.16)
**Status**: Ready for Review
**Last Updated**: 2025-12-15
**Quality Score**: 96.75% (3 Minor Issues Fixed)

---

## ASCII Wireframe

### Success State - Partial Fulfillment Modal (Desktop: >1024px)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ• Partial Shipment - Sales Order SO-2025-0142                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ORDER SUMMARY                                                                                    â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚                                                                                                   â”‚    â”‚
â”‚  â”‚  Order #: SO-2025-0142  â”‚ Customer: Acme Foods  â”‚ Status: Confirmed                             â”‚    â”‚
â”‚  â”‚  Order Date: 2025-11-15  â”‚ Promised Ship: 2025-12-20  â”‚ Total Amount: $15,240.00               â”‚    â”‚
â”‚  â”‚                                                                                                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ SHIPMENT LINE ITEMS - Allocated Qty vs. Ship Qty                                                 â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚                                                                                                   â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚    â”‚
â”‚  â”‚  â”‚ Line Product (Size)              â”‚Allocatedâ”‚ Availableâ”‚ Shipâ”‚ Backorderâ”‚ Status   â”‚         â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”‚    â”‚
â”‚  â”‚  â”‚ 1  Premium Yogurt (500mL)        â”‚ 950 âœ“   â”‚  950     â”‚  850 â”‚   100   â”‚ âš  Partialâ”‚         â”‚    â”‚
â”‚  â”‚  â”‚    [Qty allocated: 950 units]    â”‚         â”‚          â”‚ [â†•]  â”‚ [Auto]  â”‚          â”‚         â”‚    â”‚
â”‚  â”‚  â”‚                                   â”‚         â”‚          â”‚      â”‚          â”‚          â”‚         â”‚    â”‚
â”‚  â”‚  â”‚ 2  Organic Cheese (1kg)          â”‚ 300 âœ“   â”‚  300     â”‚  300 â”‚    0    â”‚ âœ“ Full  â”‚         â”‚    â”‚
â”‚  â”‚  â”‚    [Qty allocated: 300 units]    â”‚         â”‚          â”‚ [â†•]  â”‚ [Auto]  â”‚          â”‚         â”‚    â”‚
â”‚  â”‚  â”‚                                   â”‚         â”‚          â”‚      â”‚          â”‚          â”‚         â”‚    â”‚
â”‚  â”‚  â”‚ 3  Whole Milk (1L)               â”‚ 500 âœ—   â”‚    0     â”‚    0 â”‚   500   â”‚ âœ— Cannotâ”‚         â”‚    â”‚
â”‚  â”‚  â”‚    [Qty allocated: 0 units]      â”‚         â”‚          â”‚ [â†•]  â”‚ [Auto]  â”‚  Ship    â”‚         â”‚    â”‚
â”‚  â”‚  â”‚                                   â”‚         â”‚          â”‚      â”‚          â”‚          â”‚         â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚    â”‚
â”‚  â”‚                                                                                                   â”‚    â”‚
â”‚  â”‚  Legend:                                                                                         â”‚    â”‚
â”‚  â”‚  âœ“ Allocated (ready to ship)                                                                    â”‚    â”‚
â”‚  â”‚  âš  Partially allocated (can ship available qty, remainder backordered)                          â”‚    â”‚
â”‚  â”‚  âœ— Not allocated (cannot ship, must backorder full qty)                                         â”‚    â”‚
â”‚  â”‚                                                                                                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ SHIPMENT SPLIT LOGIC                                                                             â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚                                                                                                   â”‚    â”‚
â”‚  â”‚  For each line item, specify:                                                                   â”‚    â”‚
â”‚  â”‚  â€¢ Qty to Ship: Amount to include in THIS shipment (cannot exceed allocated qty)                â”‚    â”‚
â”‚  â”‚  â€¢ Qty Backorder: Automatically calculated (allocated_qty - ship_qty)                           â”‚    â”‚
â”‚  â”‚  â€¢ Backorder Status: New sales order (backorder SO) will be created for shortfall               â”‚    â”‚
â”‚  â”‚                                                                                                   â”‚    â”‚
â”‚  â”‚  SHIPMENT TOTALS                                                                                â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚    â”‚
â”‚  â”‚  â”‚ Total Qty to Ship:      1,150 units    (ship line 1 + 2)               â”‚                   â”‚    â”‚
â”‚  â”‚  â”‚ Total Qty Backordered:    600 units    (100 from line 1, 500 from 3) â”‚                   â”‚    â”‚
â”‚  â”‚  â”‚ Shipment Value:        $9,455.00      (proportional to shipped qty)   â”‚                   â”‚    â”‚
â”‚  â”‚  â”‚ Backorder Value:       $5,785.00      (proportional to backordered qty)â”‚                   â”‚    â”‚
â”‚  â”‚  â”‚                                                                         â”‚                   â”‚    â”‚
â”‚  â”‚  â”‚ New Backorder SO:       BO-SO-2025-0142-001 (auto-generated)           â”‚                   â”‚    â”‚
â”‚  â”‚  â”‚ Backorder Status:       Pending (awaiting production/allocation)       â”‚                   â”‚    â”‚
â”‚  â”‚  â”‚ Backorder Linked to:    Original SO-2025-0142 (link in system)         â”‚                   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚    â”‚
â”‚  â”‚                                                                                                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ CUSTOMER NOTIFICATION                                                                            â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚                                                                                                   â”‚    â”‚
â”‚  â”‚  [âœ“] Send Partial Shipment Notification to Customer                                             â”‚    â”‚
â”‚  â”‚                                                                                                   â”‚    â”‚
â”‚  â”‚  ğŸ“§ Notification Template:                                                                      â”‚    â”‚
â”‚  â”‚     "We're shipping 1,150 units of your order SO-2025-0142 today.                              â”‚    â”‚
â”‚  â”‚      Due to inventory availability, 600 units will ship separately as backorder BO-SO-2025-...  â”‚    â”‚
â”‚  â”‚      Estimated ship date: [estimated_date]"                                                     â”‚    â”‚
â”‚  â”‚                                                                                                   â”‚    â”‚
â”‚  â”‚  Email Recipient: [order_contact@acmefoods.com]  [Change Contact]                              â”‚    â”‚
â”‚  â”‚                                                                                                   â”‚    â”‚
â”‚  â”‚  [âœ“] Also notify via SMS (if enabled)                                                           â”‚    â”‚
â”‚  â”‚  [âœ“] Create fulfillment note (visible in SO detail)                                             â”‚    â”‚
â”‚  â”‚                                                                                                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ CONFIRMATION                                                                                     â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚                                                                                                   â”‚    â”‚
â”‚  â”‚  âš  WARNING: This will create a PARTIAL shipment + BACKORDER                                     â”‚    â”‚
â”‚  â”‚                                                                                                   â”‚    â”‚
â”‚  â”‚  Current Action:                                                                                â”‚    â”‚
â”‚  â”‚  âœ“ Ship 1,150 units in THIS shipment ($9,455.00)                                               â”‚    â”‚
â”‚  â”‚  âœ“ Create Backorder BO-SO-2025-0142-001 for 600 units ($5,785.00)                              â”‚    â”‚
â”‚  â”‚  âœ“ Link backorder to original SO-2025-0142                                                      â”‚    â”‚
â”‚  â”‚  âœ“ Send notification to customer (partial shipment + ETA for backorder)                        â”‚    â”‚
â”‚  â”‚  âœ“ Set original SO status â†’ "Partially Shipped"                                                â”‚    â”‚
â”‚  â”‚  âœ“ Create new backorder SO status â†’ "Pending"                                                  â”‚    â”‚
â”‚  â”‚                                                                                                   â”‚    â”‚
â”‚  â”‚  [Cancel]  [Review Splits]  [Confirm Partial Shipment]                                         â”‚    â”‚
â”‚  â”‚                                                                                                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Success State - Partial Fulfillment Modal (Tablet: 768-1024px)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ• Partial Shipment: SO-2025-0142                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  SO-2025-0142 | Acme Foods | $15,240.00                 â”‚
â”‚  Promised: 2025-12-20 | Status: Confirmed                â”‚
â”‚                                                           â”‚
â”‚  SHIPMENT LINES                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                                                           â”‚
â”‚  Line 1: Premium Yogurt (500mL)                          â”‚
â”‚  Allocated: 950 âœ“ | Ship: 850 | Backorder: 100          â”‚
â”‚                                                           â”‚
â”‚  [Qty Slider: 0 â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€ 950]  [100 units shortage] â”‚
â”‚  Status: âš  Partial Shipment                             â”‚
â”‚                                                           â”‚
â”‚  Line 2: Organic Cheese (1kg)                            â”‚
â”‚  Allocated: 300 âœ“ | Ship: 300 | Backorder: 0            â”‚
â”‚                                                           â”‚
â”‚  [Qty Slider: 0 â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€ 300]  [Full shipment]    â”‚
â”‚  Status: âœ“ Full Shipment                                â”‚
â”‚                                                           â”‚
â”‚  Line 3: Whole Milk (1L)                                â”‚
â”‚  Allocated: 0 âœ— | Ship: 0 | Backorder: 500             â”‚
â”‚                                                           â”‚
â”‚  [Qty Slider: disabled]  [Cannot ship - no inventory]   â”‚
â”‚  Status: âœ— Backorder Only                               â”‚
â”‚                                                           â”‚
â”‚  TOTALS                                                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  To Ship:    1,150 units ($9,455.00)                    â”‚
â”‚  Backorder:    600 units ($5,785.00)                    â”‚
â”‚                                                           â”‚
â”‚  Backorder SO: BO-SO-2025-0142-001 (Pending)            â”‚
â”‚  Status: Linked to original SO-2025-0142                â”‚
â”‚                                                           â”‚
â”‚  NOTIFICATION                                            â”‚
â”‚  [âœ“] Send partial shipment email                        â”‚
â”‚  [âœ“] Notify production of backorder                     â”‚
â”‚                                                           â”‚
â”‚  [Cancel] [Confirm Partial]                             â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Success State - Partial Fulfillment Modal (Mobile: <768px)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† Partial Shipment                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚ SO-2025-0142                                             â”‚
â”‚ Acme Foods | $15,240.00                                 â”‚
â”‚ Promised: 2025-12-20                                     â”‚
â”‚                                                           â”‚
â”‚ LINE 1: Premium Yogurt                                   â”‚
â”‚ Allocated: 950 âœ“                                         â”‚
â”‚                                                           â”‚
â”‚ [Qty Slider]                                             â”‚
â”‚ Ship: 850 | Backorder: 100                               â”‚
â”‚ Status: âš  Partial                                       â”‚
â”‚                                                           â”‚
â”‚ LINE 2: Organic Cheese                                   â”‚
â”‚ Allocated: 300 âœ“                                         â”‚
â”‚                                                           â”‚
â”‚ [Qty Slider]                                             â”‚
â”‚ Ship: 300 | Backorder: 0                                 â”‚
â”‚ Status: âœ“ Full                                           â”‚
â”‚                                                           â”‚
â”‚ LINE 3: Whole Milk                                       â”‚
â”‚ Allocated: 0 âœ—                                           â”‚
â”‚                                                           â”‚
â”‚ [Cannot ship]                                             â”‚
â”‚ Ship: 0 | Backorder: 500                                 â”‚
â”‚ Status: âœ— Backorder Only                                 â”‚
â”‚                                                           â”‚
â”‚ SHIPMENT: 1,150 units                                    â”‚
â”‚ BACKORDER: 600 units                                     â”‚
â”‚ BO-SO-2025-0142-001                                      â”‚
â”‚                                                           â”‚
â”‚ [âœ“] Send notification                                    â”‚
â”‚                                                           â”‚
â”‚ [Cancel] [Confirm]                                       â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Loading State - Partial Fulfillment Modal

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ• Partial Shipment - Sales Order SO-2025-0142                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                                            â”‚
â”‚  ORDER SUMMARY                                                                                           â”‚
â”‚  â”œâ”€ [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘] SO-2025-0142                                                                       â”‚
â”‚  â”œâ”€ [â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] Customer: Acme Foods                                                               â”‚
â”‚  â””â”€ [â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] Amount: $15,240.00                                                                 â”‚
â”‚                                                                                                            â”‚
â”‚  SHIPMENT LINE ITEMS                                                                                     â”‚
â”‚  â”œâ”€ Line 1: [â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] Premium Yogurt                                                             â”‚
â”‚  â”‚  â”œâ”€ Qty Allocated: [â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘]                                                                  â”‚
â”‚  â”‚  â”œâ”€ Available: [â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘]                                                                      â”‚
â”‚  â”‚  â””â”€ [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘] Qty Slider (loading...)                                                        â”‚
â”‚  â”‚                                                                                                        â”‚
â”‚  â”œâ”€ Line 2: [â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] Organic Cheese                                                             â”‚
â”‚  â”‚  â””â”€ [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘] Qty Slider (loading...)                                                        â”‚
â”‚  â”‚                                                                                                        â”‚
â”‚  â””â”€ Line 3: [â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] Whole Milk                                                                 â”‚
â”‚     â””â”€ [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘] Qty Slider (loading...)                                                        â”‚
â”‚                                                                                                            â”‚
â”‚  SHIPMENT TOTALS                                                                                         â”‚
â”‚  â”œâ”€ [â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] Total Ship Qty                                                                     â”‚
â”‚  â”œâ”€ [â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] Total Backorder Qty                                                                â”‚
â”‚  â”œâ”€ [â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] Backorder SO Number                                                                â”‚
â”‚  â””â”€ [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘] Generating backorder details...                                                    â”‚
â”‚                                                                                                            â”‚
â”‚  [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 45% - Loading shipment data                          â”‚
â”‚  Note: Progress percentage shown only if load time exceeds 3 seconds                                    â”‚
â”‚                                                                                                            â”‚
â”‚  [Disabled: Cancel]  [Disabled: Confirm]                                                                 â”‚
â”‚                                                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Empty State - Fully Allocated (No Partial Shipment Needed)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ• Partial Shipment - Sales Order SO-2025-0142                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                                            â”‚
â”‚  ORDER SUMMARY                                                                                           â”‚
â”‚  â”œâ”€ Order #: SO-2025-0142  â”‚ Customer: Acme Foods  â”‚ Status: Confirmed                                  â”‚
â”‚  â”œâ”€ Order Date: 2025-11-15  â”‚ Promised Ship: 2025-12-20  â”‚ Total Amount: $15,240.00                    â”‚
â”‚                                                                                                            â”‚
â”‚  âœ“ ALL LINES FULLY ALLOCATED                                                                            â”‚
â”‚                                                                                                            â”‚
â”‚  â”Œâ”€ [âœ“ Icon] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚                                                                                         â”‚             â”‚
â”‚  â”‚ All Inventory Available                                                                 â”‚             â”‚
â”‚  â”‚                                                                                         â”‚             â”‚
â”‚  â”‚ This sales order has sufficient inventory for a full shipment. No partial fulfillment  â”‚             â”‚
â”‚  â”‚ is needed.                                                                              â”‚             â”‚
â”‚  â”‚                                                                                         â”‚             â”‚
â”‚  â”‚ â€¢ All 3 line items fully allocated                                                     â”‚             â”‚
â”‚  â”‚ â€¢ Total qty to ship: 1,750 units                                                       â”‚             â”‚
â”‚  â”‚ â€¢ No backorder required                                                                â”‚             â”‚
â”‚  â”‚                                                                                         â”‚             â”‚
â”‚  â”‚ Next Step: Proceed to packing or [Create Full Shipment]                               â”‚             â”‚
â”‚  â”‚                                                                                         â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                                                            â”‚
â”‚  [Cancel]  [Create Full Shipment Instead]                                                                â”‚
â”‚                                                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Empty State - Sales Order Cancelled (Cannot Partial Ship)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ• Partial Shipment - Sales Order SO-2025-0142                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                                            â”‚
â”‚  ORDER SUMMARY (Read-Only)                                                                               â”‚
â”‚  â”œâ”€ Order #: SO-2025-0142  â”‚ Customer: Acme Foods  â”‚ Status: CANCELLED                                  â”‚
â”‚  â”œâ”€ Order Date: 2025-11-15  â”‚ Promised Ship: 2025-12-20  â”‚ Total Amount: $15,240.00                    â”‚
â”‚                                                                                                            â”‚
â”‚  â”Œâ”€ [âœ— Icon] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚                                                                                         â”‚             â”‚
â”‚  â”‚ Cannot Fulfill Cancelled Order                                                          â”‚             â”‚
â”‚  â”‚                                                                                         â”‚             â”‚
â”‚  â”‚ This sales order has been cancelled and cannot be partially shipped.                   â”‚             â”‚
â”‚  â”‚                                                                                         â”‚             â”‚
â”‚  â”‚ Cancelled Date: 2025-12-10                                                             â”‚             â”‚
â”‚  â”‚ Cancelled Reason: Customer requested cancellation (per email 2025-12-10)               â”‚             â”‚
â”‚  â”‚ Cancelled By: John Manager (Shipping Manager)                                          â”‚             â”‚
â”‚  â”‚                                                                                         â”‚             â”‚
â”‚  â”‚ Options:                                                                                â”‚             â”‚
â”‚  â”‚ â€¢ Review cancellation reason in SO detail                                              â”‚             â”‚
â”‚  â”‚ â€¢ Contact customer regarding open items                                                â”‚             â”‚
â”‚  â”‚ â€¢ Create new sales order if customer wants to re-order                                 â”‚             â”‚
â”‚  â”‚                                                                                         â”‚             â”‚
â”‚  â”‚ [Close] [View SO Detail] [Contact Customer]                                            â”‚             â”‚
â”‚  â”‚                                                                                         â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                                                            â”‚
â”‚  [Cancel]                                                                                                 â”‚
â”‚                                                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Empty State - Sales Order Already Shipped (Cannot Partial Ship Again)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ• Partial Shipment - Sales Order SO-2025-0142                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                                            â”‚
â”‚  ORDER SUMMARY (Read-Only)                                                                               â”‚
â”‚  â”œâ”€ Order #: SO-2025-0142  â”‚ Customer: Acme Foods  â”‚ Status: SHIPPED                                    â”‚
â”‚  â”œâ”€ Order Date: 2025-11-15  â”‚ Promised Ship: 2025-12-20  â”‚ Total Amount: $15,240.00                    â”‚
â”‚                                                                                                            â”‚
â”‚  â”Œâ”€ [âœ“ Icon] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚                                                                                         â”‚             â”‚
â”‚  â”‚ Order Already Shipped                                                                   â”‚             â”‚
â”‚  â”‚                                                                                         â”‚             â”‚
â”‚  â”‚ This sales order has already been fully shipped and cannot be modified.                â”‚             â”‚
â”‚  â”‚                                                                                         â”‚             â”‚
â”‚  â”‚ Original Shipment: SHP-2025-0035                                                       â”‚             â”‚
â”‚  â”‚ Shipped Date: 2025-12-12                                                               â”‚             â”‚
â”‚  â”‚ Tracking Number: 1Z999AA10123456784 (FedEx)                                           â”‚             â”‚
â”‚  â”‚ Delivered: Yes (2025-12-15)                                                            â”‚             â”‚
â”‚  â”‚                                                                                         â”‚             â”‚
â”‚  â”‚ If additional shipment needed:                                                         â”‚             â”‚
â”‚  â”‚ â€¢ Create a new sales order                                                             â”‚             â”‚
â”‚  â”‚ â€¢ Cannot modify this order                                                             â”‚             â”‚
â”‚  â”‚                                                                                         â”‚             â”‚
â”‚  â”‚ [Close] [View Shipment] [View SO Detail]                                               â”‚             â”‚
â”‚  â”‚                                                                                         â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                                                            â”‚
â”‚  [Cancel]                                                                                                 â”‚
â”‚                                                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Empty State - Sales Order In Draft Status (Cannot Partial Ship)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ• Partial Shipment - Sales Order SO-2025-0142                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                                            â”‚
â”‚  ORDER SUMMARY (Read-Only)                                                                               â”‚
â”‚  â”œâ”€ Order #: SO-2025-0142  â”‚ Customer: Acme Foods  â”‚ Status: DRAFT                                      â”‚
â”‚  â”œâ”€ Order Date: 2025-11-15  â”‚ Promised Ship: TBD  â”‚ Total Amount: $15,240.00                            â”‚
â”‚                                                                                                            â”‚
â”‚  â”Œâ”€ [âš  Icon] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚                                                                                         â”‚             â”‚
â”‚  â”‚ Order Not Confirmed Yet                                                                 â”‚             â”‚
â”‚  â”‚                                                                                         â”‚             â”‚
â”‚  â”‚ This sales order is still in draft status and has not been confirmed. Partial shipment â”‚             â”‚
â”‚  â”‚ is only available for confirmed orders.                                                â”‚             â”‚
â”‚  â”‚                                                                                         â”‚             â”‚
â”‚  â”‚ Current Status: Draft (not yet finalized)                                              â”‚             â”‚
â”‚  â”‚ Required Steps:                                                                        â”‚             â”‚
â”‚  â”‚ 1. Confirm the sales order (set status to "Confirmed")                                â”‚             â”‚
â”‚  â”‚ 2. System will allocate inventory                                                     â”‚             â”‚
â”‚  â”‚ 3. Then you can create a partial shipment                                             â”‚             â”‚
â”‚  â”‚                                                                                         â”‚             â”‚
â”‚  â”‚ [Close] [Edit SO] [Confirm SO]                                                         â”‚             â”‚
â”‚  â”‚                                                                                         â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                                                            â”‚
â”‚  [Cancel]                                                                                                 â”‚
â”‚                                                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Empty State - Sales Order Has 0 Lines (Cannot Partial Ship)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ• Partial Shipment - Sales Order SO-2025-0142                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                                            â”‚
â”‚  ORDER SUMMARY (Read-Only)                                                                               â”‚
â”‚  â”œâ”€ Order #: SO-2025-0142  â”‚ Customer: Acme Foods  â”‚ Status: Confirmed                                  â”‚
â”‚  â”œâ”€ Order Date: 2025-11-15  â”‚ Promised Ship: 2025-12-20  â”‚ Total Amount: $0.00                          â”‚
â”‚                                                                                                            â”‚
â”‚  â”Œâ”€ [âœ— Icon] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚                                                                                         â”‚             â”‚
â”‚  â”‚ No Line Items to Ship                                                                   â”‚             â”‚
â”‚  â”‚                                                                                         â”‚             â”‚
â”‚  â”‚ This sales order has no line items and therefore cannot be partially shipped.         â”‚             â”‚
â”‚  â”‚                                                                                         â”‚             â”‚
â”‚  â”‚ Line Items: 0 (empty order)                                                            â”‚             â”‚
â”‚  â”‚ Total Ordered: 0 units                                                                 â”‚             â”‚
â”‚  â”‚ Total Amount: $0.00                                                                    â”‚             â”‚
â”‚  â”‚                                                                                         â”‚             â”‚
â”‚  â”‚ Options:                                                                                â”‚             â”‚
â”‚  â”‚ â€¢ Add line items to the order                                                          â”‚             â”‚
â”‚  â”‚ â€¢ Or cancel this order                                                                 â”‚             â”‚
â”‚  â”‚                                                                                         â”‚             â”‚
â”‚  â”‚ [Close] [Edit SO] [Cancel SO]                                                          â”‚             â”‚
â”‚  â”‚                                                                                         â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                                                            â”‚
â”‚  [Cancel]                                                                                                 â”‚
â”‚                                                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Success Confirmation Modal

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ“ Partial Shipment Created!                                                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                                            â”‚
â”‚  â”Œâ”€ [âœ“ Large Green Checkmark] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                                                   â”‚   â”‚
â”‚  â”‚ Partial Shipment Successfully Created                                                             â”‚   â”‚
â”‚  â”‚                                                                                                   â”‚   â”‚
â”‚  â”‚ Your partial shipment and backorder have been created and saved.                                 â”‚   â”‚
â”‚  â”‚                                                                                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                                            â”‚
â”‚  SHIPMENT DETAILS                                                                                        â”‚
â”‚  â”œâ”€ Shipment #:     SHP-2025-0042                                                                       â”‚
â”‚  â”œâ”€ Status:         Pending (ready for packing)                                                         â”‚
â”‚  â”œâ”€ Total Qty:      1,150 units                                                                         â”‚
â”‚  â”œâ”€ Value:          $9,455.00                                                                           â”‚
â”‚  â””â”€ Created:        2025-12-15 14:35:00 UTC                                                             â”‚
â”‚                                                                                                            â”‚
â”‚  BACKORDER DETAILS                                                                                       â”‚
â”‚  â”œâ”€ Backorder SO:   BO-SO-2025-0142-001                                                                 â”‚
â”‚  â”œâ”€ Status:         Pending (awaiting allocation/production)                                            â”‚
â”‚  â”œâ”€ Total Qty:      600 units                                                                           â”‚
â”‚  â”œâ”€ Value:          $5,785.00                                                                           â”‚
â”‚  â”œâ”€ ETA:            2025-12-29                                                                          â”‚
â”‚  â””â”€ Linked to:      Original SO-2025-0142                                                               â”‚
â”‚                                                                                                            â”‚
â”‚  NOTIFICATION STATUS                                                                                     â”‚
â”‚  â”œâ”€ Email Sent:     âœ“ john.doe@acmefoods.com (2025-12-15 14:35:05 UTC)                                â”‚
â”‚  â”œâ”€ SMS Sent:       âœ— Not configured                                                                    â”‚
â”‚  â””â”€ Fulfillment Note: âœ“ Created in SO timeline                                                          â”‚
â”‚                                                                                                            â”‚
â”‚  [View Shipment]  [View Backorder]  [Close]                                                             â”‚
â”‚                                                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Error State - Failed to Load Shipment Data

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ• Partial Shipment - Sales Order SO-2025-0142                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                                            â”‚
â”‚  [âš  Error Banner - Red]                                                                                  â”‚
â”‚  Failed to Load Shipment Data                                                                            â”‚
â”‚  Unable to fetch allocation and inventory data for this sales order.                                     â”‚
â”‚  Error Code: SHIPMENT_DATA_LOAD_FAILED | Last Attempt: 2025-12-15 14:35:45 UTC                         â”‚
â”‚  [Retry] [Dismiss]                                                                                       â”‚
â”‚                                                                                                            â”‚
â”‚  ORDER SUMMARY                                                                                           â”‚
â”‚  â”œâ”€ Order #: SO-2025-0142  â”‚ Customer: Acme Foods  â”‚ Status: Confirmed                                  â”‚
â”‚                                                                                                            â”‚
â”‚  SHIPMENT LINE ITEMS                                                                                     â”‚
â”‚  Unable to load line items and allocated quantities.                                                     â”‚
â”‚  [Retry Loading]                                                                                         â”‚
â”‚                                                                                                            â”‚
â”‚  SHIPMENT TOTALS                                                                                         â”‚
â”‚  Unable to calculate shipment totals.                                                                    â”‚
â”‚                                                                                                            â”‚
â”‚  [Cancel]  [Retry]                                                                                       â”‚
â”‚                                                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Error State - Insufficient Permissions

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ• Partial Shipment - Sales Order SO-2025-0142                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                                            â”‚
â”‚  [âš  Warning Banner - Yellow/Orange]                                                                      â”‚
â”‚  Insufficient Permissions                                                                                â”‚
â”‚  You do not have permission to create partial shipments. Only Shipping Managers and Admins can fulfill   â”‚
â”‚  orders partially. Contact your Shipping Manager to complete this action.                                â”‚
â”‚  [Request Permission] [Dismiss]                                                                          â”‚
â”‚                                                                                                            â”‚
â”‚  ORDER SUMMARY (Read-Only)                                                                               â”‚
â”‚  â”œâ”€ Order #: SO-2025-0142  â”‚ Customer: Acme Foods  â”‚ Status: Confirmed                                  â”‚
â”‚  â”œâ”€ Order Date: 2025-11-15  â”‚ Promised Ship: 2025-12-20  â”‚ Total Amount: $15,240.00                    â”‚
â”‚                                                                                                            â”‚
â”‚  SHIPMENT LINE ITEMS (View-Only)                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ Line Product              â”‚Allocatedâ”‚ Availableâ”‚ Suggested Shipâ”‚ Suggested BOâ”‚        â”‚               â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚               â”‚
â”‚  â”‚ 1  Premium Yogurt          â”‚ 950 âœ“   â”‚  950     â”‚       850     â”‚    100     â”‚        â”‚               â”‚
â”‚  â”‚ 2  Organic Cheese          â”‚ 300 âœ“   â”‚  300     â”‚       300     â”‚      0     â”‚        â”‚               â”‚
â”‚  â”‚ 3  Whole Milk              â”‚ 0 âœ—     â”‚    0     â”‚         0     â”‚    500     â”‚        â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                                                            â”‚
â”‚  SUGGESTIONS (Read-Only)                                                                                 â”‚
â”‚  â”œâ”€ Total Qty to Ship: 1,150 units                                                                       â”‚
â”‚  â””â”€ Total Qty Backorder: 600 units                                                                       â”‚
â”‚                                                                                                            â”‚
â”‚  [Cancel]  [Request Approval - Opens Email to Manager]                                                   â”‚
â”‚                                                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Error State - Invalid Partial Shipment

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ• Partial Shipment - Sales Order SO-2025-0142                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                                            â”‚
â”‚  [âœ— Error Banner - Red]                                                                                  â”‚
â”‚  Invalid Partial Shipment Configuration                                                                  â”‚
â”‚  You must ship at least 1 unit for at least 1 line item. Currently configured to ship 0 units.         â”‚
â”‚  [Dismiss]                                                                                                â”‚
â”‚                                                                                                            â”‚
â”‚  ORDER SUMMARY                                                                                           â”‚
â”‚  â”œâ”€ Order #: SO-2025-0142  â”‚ Customer: Acme Foods  â”‚ Status: Confirmed                                  â”‚
â”‚                                                                                                            â”‚
â”‚  SHIPMENT LINE ITEMS                                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ Line Product              â”‚Allocatedâ”‚  Ship Qtyâ”‚ Backorderâ”‚ Status        â”‚           â”‚               â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚               â”‚
â”‚  â”‚ 1  Premium Yogurt          â”‚ 950 âœ“   â”‚    0 âœ—   â”‚    950   â”‚ ERROR: Ship >0â”‚           â”‚               â”‚
â”‚  â”‚ 2  Organic Cheese          â”‚ 300 âœ“   â”‚    0 âœ—   â”‚    300   â”‚ ERROR: Ship >0â”‚           â”‚               â”‚
â”‚  â”‚ 3  Whole Milk              â”‚ 0 âœ—     â”‚    0 âœ—   â”‚    500   â”‚ BLOCKED       â”‚           â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                                                            â”‚
â”‚  SHIPMENT TOTALS                                                                                         â”‚
â”‚  â”œâ”€ Total Ship Qty: 0 units âœ— INVALID                                                                   â”‚
â”‚  â”œâ”€ Total Backorder: 1,750 units                                                                        â”‚
â”‚  â”‚                                                                                                        â”‚
â”‚  â”‚ Recovery Actions:                                                                                    â”‚
â”‚  â”‚ â€¢ Adjust at least 1 line to ship qty > 0                                                             â”‚
â”‚  â”‚ â€¢ Set "Premium Yogurt" to ship at least 1 unit                                                       â”‚
â”‚  â”‚                                                                                                        â”‚
â”‚  [Cancel]  [Adjust Line Items]                                                                          â”‚
â”‚                                                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## State Descriptions

### Loading State
- Skeleton loaders for:
  - Order summary (70% opacity, animated shimmer)
  - Line items table (animated shimmer)
  - Shipment totals (80% opacity, animated shimmer)
- "Loading shipment data..." text with progress bar
- Buttons disabled (grayed out)
- **Progress bar behavior**: Shows percentage only if load time > 3 seconds threshold (e.g., "45% - Loading shipment data")
- **Note**: If load completes before 3 seconds, progress percentage is hidden to avoid flashing UI

### Empty States (5 Scenarios)

**1. Fully Allocated - No Partial Needed:**
- Large icon (âœ“ checkmark or package)
- Headline: "All Lines Fully Allocated"
- Message: "This sales order has sufficient inventory for a full shipment. No partial fulfillment needed."
- Quick summary: "All 3 line items fully allocated | Total: 1,750 units | No backorder required"
- Quick action: [Create Full Shipment Instead]

**2. SO Cancelled - Cannot Ship:**
- Large icon (âœ— red X)
- Headline: "Cannot Fulfill Cancelled Order"
- Message: "This sales order has been cancelled and cannot be partially shipped."
- Details: Cancellation date, reason, cancelled by user
- Actions: [View SO Detail] [Contact Customer]

**3. SO Already Shipped - Cannot Modify:**
- Large icon (âœ“ green checkmark)
- Headline: "Order Already Shipped"
- Message: "This sales order has already been fully shipped and cannot be modified."
- Details: Shipment #, shipped date, tracking number, delivery status
- Actions: [View Shipment] [View SO Detail]

**4. SO In Draft Status - Cannot Ship:**
- Large icon (âš  yellow warning)
- Headline: "Order Not Confirmed Yet"
- Message: "This sales order is still in draft status and has not been confirmed."
- Details: Current status, required steps to confirm
- Actions: [Edit SO] [Confirm SO]

**5. SO Has 0 Lines - Cannot Ship:**
- Large icon (âœ— red X)
- Headline: "No Line Items to Ship"
- Message: "This sales order has no line items and therefore cannot be partially shipped."
- Details: Line count, total qty, total amount
- Actions: [Edit SO] [Cancel SO]

### Success State
- All fields populated with data
- Line items table complete with allocations
- Qty sliders/inputs responsive
- Shipment totals calculated
- Backorder SO number auto-generated
- Notification checkbox visible
- Buttons enabled
- Confirmation panel shows summary

### Success Confirmation Modal
- Large green checkmark icon
- Headline: "Partial Shipment Created!"
- Shipment details: SHP-2025-0042, status, qty, value, created timestamp
- Backorder details: BO-SO-2025-0142-001, status, qty, value, ETA, linked to original
- Notification status: Email sent to customer, fulfillment note created
- Quick action buttons: [View Shipment] [View Backorder] [Close]

### Error State (Failed to Load)
- Red error banner:
  - Headline: "Failed to Load Shipment Data"
  - Message: "Unable to fetch allocation and inventory data..."
  - Error Code: SHIPMENT_DATA_LOAD_FAILED
- All fields disabled
- [Retry] and [Dismiss] buttons in banner
- Footer: Last attempt timestamp
- Modal footer: [Cancel] [Retry]

### Error State (Insufficient Permissions)
- Yellow/orange warning banner:
  - Headline: "Insufficient Permissions"
  - Message: "You do not have permission to create partial shipments..."
- Show suggestion table in **read-only** mode
- [Request Approval] button â†’ Opens email to manager
- Buttons: [Cancel] [Request Approval]

### Error State (Invalid Configuration)
- Red error banner:
  - Headline: "Invalid Partial Shipment Configuration"
  - Message: "You must ship at least 1 unit for at least 1 line item..."
- Highlight problematic fields in red
- Show validation errors inline
- Buttons: [Cancel] [Adjust Line Items]

---

## Data Fields

### Line Item Row Data

| Field | Source | Display | Format |
|-------|--------|---------|--------|
| line_number | sales_order_lines.line_number | 1 | Integer |
| product_id | sales_order_lines.product_id | Hidden (reference) | UUID |
| product_name | products.name | Premium Yogurt | Text |
| product_size | products.package_size | 500mL | Text |
| ordered_qty | sales_order_lines.quantity_ordered | 950 | Decimal |
| allocated_qty | SUM(inventory_allocations.qty) | 950 | Decimal |
| ship_qty (user input) | User slider/input | 850 | Decimal (0 to allocated_qty) |
| backorder_qty (calculated) | allocated_qty - ship_qty | 100 | Decimal (auto) |
| unit_price | sales_order_lines.unit_price | $9.95 | Currency |
| line_total | ordered_qty * unit_price | $9,502.50 | Currency |
| ship_value (calculated) | ship_qty * unit_price | $8,457.50 | Currency |
| backorder_value (calculated) | backorder_qty * unit_price | $995.00 | Currency |

### Shipment Totals Data

| Field | Calculation | Display | Format |
|-------|-------------|---------|--------|
| total_ship_qty | SUM(ship_qty) | 1,150 units | Decimal |
| total_backorder_qty | SUM(backorder_qty) | 600 units | Decimal |
| shipment_value | SUM(ship_value) | $9,455.00 | Currency |
| backorder_value | SUM(backorder_value) | $5,785.00 | Currency |
| backorder_so_number | BO-SO-{so_number}-{seq} | BO-SO-2025-0142-001 | Text (auto-generated) |
| backorder_status | "pending" | Pending | Enum |
| parent_so_id | sales_orders.id | SO-2025-0142 | UUID (link) |
| estimated_ship_date | TODAY + 14 days OR from production forecast | 2025-12-29 | Date |

### Shipment Data (Created on Confirm)

| Field | Value | Notes |
|-------|-------|-------|
| shipment_id | UUID | New shipment for this partial fulfillment |
| sales_order_id | Original SO ID | Link to original order |
| status | "pending" â†’ "packing" | Status after creation |
| shipment_type | "partial" | Mark as partial (vs. full) |
| created_at | NOW | Timestamp |
| created_by | Current user ID | Who created the partial shipment |

### Backorder SO Data (Created on Confirm)

| Field | Value | Notes |
|-------|-------|-------|
| backorder_so_id | UUID | New SO for backorder |
| so_number | BO-SO-2025-0142-001 | Auto-generated |
| customer_id | Original customer | Same customer |
| parent_so_id | Original SO ID | Link back to original |
| status | "pending" | Awaiting allocation/production |
| created_at | NOW | Timestamp |
| created_by | Current user ID | Who created the backorder |
| relationship | "backorder_of_so_2025_0142" | Traceability |

---

## API Endpoints

### Fetch Partial Fulfillment Data (GET)
```
GET /api/shipping/sales-orders/:id/partial-fulfill

Query Parameters:
  - include_notifications: boolean (optional, default: true)
  - include_backorder_estimate: boolean (optional, default: true)

Response:
{
  "sales_order_id": "uuid-so-1",
  "order_number": "SO-2025-0142",
  "customer_id": "uuid-cust-1",
  "customer_name": "Acme Foods",
  "order_date": "2025-11-15",
  "promised_ship_date": "2025-12-20",
  "total_amount": 15240.00,
  "currency": "USD",
  "lines": [
    {
      "line_id": "uuid-line-1",
      "line_number": 1,
      "product_id": "uuid-prod-1",
      "product_name": "Premium Yogurt Vanilla",
      "product_size": "500mL",
      "quantity_ordered": 950,
      "quantity_allocated": 950,
      "quantity_available_to_ship": 950,
      "unit_price": 9.95,
      "line_total": 9502.50,
      "allocation_status": "full",
      "can_partially_ship": true,
      "suggested_ship_qty": 950,
      "suggested_backorder_qty": 0,
      "notes": null
    },
    {
      "line_id": "uuid-line-2",
      "line_number": 2,
      "product_id": "uuid-prod-2",
      "product_name": "Organic Cheese Block",
      "product_size": "1kg",
      "quantity_ordered": 300,
      "quantity_allocated": 300,
      "quantity_available_to_ship": 300,
      "unit_price": 14.99,
      "line_total": 4497.00,
      "allocation_status": "full",
      "can_partially_ship": true,
      "suggested_ship_qty": 300,
      "suggested_backorder_qty": 0,
      "notes": null
    },
    {
      "line_id": "uuid-line-3",
      "line_number": 3,
      "product_id": "uuid-prod-3",
      "product_name": "Whole Milk",
      "product_size": "1L",
      "quantity_ordered": 500,
      "quantity_allocated": 0,
      "quantity_available_to_ship": 0,
      "unit_price": 4.25,
      "line_total": 2125.00,
      "allocation_status": "none",
      "can_partially_ship": false,
      "suggested_ship_qty": 0,
      "suggested_backorder_qty": 500,
      "notes": "No available inventory"
    }
  ],
  "shipment_summary": {
    "total_qty_allocated": 1250,
    "total_qty_ordered": 1750,
    "total_qty_can_ship": 1250,
    "total_order_value": 15240.00,
    "can_create_full_shipment": false,
    "requires_partial_fulfillment": true,
    "requires_backorder": true,
    "total_backorder_qty": 500,
    "backorder_lines_count": 1
  },
  "customer_contact": {
    "contact_id": "uuid-contact-1",
    "name": "John Doe",
    "email": "john.doe@acmefoods.com",
    "phone": "+1-555-0123",
    "is_primary": true
  },
  "notification_settings": {
    "send_email": true,
    "send_sms": false,
    "send_fulfillment_note": true,
    "email_recipient": "john.doe@acmefoods.com"
  },
  "backorder_estimate": {
    "estimated_availability_date": "2025-12-29",
    "estimated_ship_date": "2025-12-29",
    "from_production_forecast": false,
    "from_supplier_lead_time": false,
    "default_estimate": true
  },
  "timestamp": "2025-12-15T14:30:00Z"
}
```

### Confirm Partial Fulfillment (POST)
```
POST /api/shipping/sales-orders/:id/partial-fulfill

Request Body:
{
  "sales_order_id": "uuid-so-1",
  "line_items": [
    {
      "line_id": "uuid-line-1",
      "quantity_to_ship": 850,
      "quantity_to_backorder": 100
    },
    {
      "line_id": "uuid-line-2",
      "quantity_to_ship": 300,
      "quantity_to_backorder": 0
    },
    {
      "line_id": "uuid-line-3",
      "quantity_to_ship": 0,
      "quantity_to_backorder": 500
    }
  ],
  "send_notification": true,
  "notification_contact_id": "uuid-contact-1",
  "notification_email_override": "john.doe@acmefoods.com",
  "backorder_notes": "Allocated based on production schedule",
  "backorder_estimated_ship_date": "2025-12-29"
}

Success Response:
{
  "success": true,
  "shipment_id": "uuid-shipment-1",
  "shipment_number": "SHP-2025-0042",
  "backorder_so_id": "uuid-bo-so-1",
  "backorder_so_number": "BO-SO-2025-0142-001",
  "original_so_id": "uuid-so-1",
  "original_so_number": "SO-2025-0142",
  "shipment_details": {
    "status": "pending",
    "created_at": "2025-12-15T14:35:00Z",
    "created_by": "uuid-user-1",
    "shipment_type": "partial",
    "total_qty_shipped": 1150,
    "shipment_value": 9455.00,
    "shipment_lines": [
      {
        "shipment_line_id": "uuid-ship-line-1",
        "original_line_id": "uuid-line-1",
        "product_id": "uuid-prod-1",
        "quantity_shipped": 850,
        "allocated_to_shipment": 850
      },
      {
        "shipment_line_id": "uuid-ship-line-2",
        "original_line_id": "uuid-line-2",
        "product_id": "uuid-prod-2",
        "quantity_shipped": 300,
        "allocated_to_shipment": 300
      }
    ]
  },
  "backorder_so_details": {
    "status": "pending",
    "created_at": "2025-12-15T14:35:00Z",
    "created_by": "uuid-user-1",
    "total_qty_backordered": 600,
    "backorder_value": 5785.00,
    "estimated_ship_date": "2025-12-29",
    "parent_so_id": "uuid-so-1",
    "parent_so_number": "SO-2025-0142",
    "backorder_lines": [
      {
        "backorder_line_id": "uuid-bo-line-1",
        "original_line_id": "uuid-line-1",
        "product_id": "uuid-prod-1",
        "quantity_backordered": 100
      },
      {
        "backorder_line_id": "uuid-bo-line-3",
        "original_line_id": "uuid-line-3",
        "product_id": "uuid-prod-3",
        "quantity_backordered": 500
      }
    ]
  },
  "notification_sent": {
    "email_sent": true,
    "email_recipient": "john.doe@acmefoods.com",
    "email_template": "partial_shipment_notification",
    "sent_at": "2025-12-15T14:35:05Z"
  },
  "status_updates": {
    "original_so": {
      "old_status": "confirmed",
      "new_status": "partially_shipped",
      "updated_at": "2025-12-15T14:35:00Z"
    },
    "shipment": {
      "status": "pending",
      "next_step": "Proceed to packing"
    },
    "backorder_so": {
      "status": "pending",
      "next_step": "Awaiting re-allocation or production"
    }
  },
  "summary": {
    "total_shipped": 1150,
    "total_backordered": 600,
    "total_order": 1750,
    "partial_fulfillment_pct": 65.7,
    "shipment_value": 9455.00,
    "backorder_value": 5785.00
  }
}
```

### Partial Failure Response Examples (POST)

**Scenario 1: Shipment Created But Backorder Creation Failed**
```json
{
  "success": false,
  "partial_failure": true,
  "error": "Backorder creation failed after successful shipment creation",
  "shipment_id": "uuid-shipment-1",
  "shipment_number": "SHP-2025-0042",
  "shipment_created": true,
  "backorder_created": false,
  "backorder_error": {
    "code": "BACKORDER_SO_CREATION_FAILED",
    "message": "Failed to create backorder SO: Duplicate SO number generated",
    "details": "BO-SO-2025-0142-001 already exists in system",
    "recovery_action": "Manual intervention required - contact support with shipment ID SHP-2025-0042"
  },
  "shipment_details": {
    "status": "pending",
    "created_at": "2025-12-15T14:35:00Z",
    "total_qty_shipped": 1150,
    "shipment_value": 9455.00
  },
  "backorder_so_details": null,
  "notification_sent": {
    "email_sent": false,
    "reason": "Waiting for backorder confirmation before notifying customer"
  },
  "status_updates": {
    "original_so": {
      "old_status": "confirmed",
      "new_status": "partially_shipped",
      "updated_at": "2025-12-15T14:35:00Z"
    },
    "shipment": {
      "status": "pending",
      "next_step": "Ready for packing"
    },
    "backorder_so": {
      "status": null,
      "error": "Failed to create"
    }
  },
  "recommended_actions": [
    "Shipment SHP-2025-0042 has been created successfully",
    "Backorder could not be auto-generated",
    "Option 1: Retry backorder creation",
    "Option 2: Manually create backorder SO and link to SHP-2025-0042",
    "Option 3: Contact support with shipment ID for investigation"
  ]
}
```

**Scenario 2: Shipment and Backorder Created But Notification Failed**
```json
{
  "success": false,
  "partial_failure": true,
  "error": "Notification delivery failed after successful shipment and backorder creation",
  "shipment_id": "uuid-shipment-1",
  "shipment_number": "SHP-2025-0042",
  "shipment_created": true,
  "backorder_created": true,
  "notification_sent": false,
  "notification_error": {
    "code": "EMAIL_SEND_FAILED",
    "message": "Failed to send notification email to customer",
    "email": "john.doe@acmefoods.com",
    "reason": "Email service temporarily unavailable",
    "retry_count": 3,
    "next_retry": "2025-12-15T14:40:00Z"
  },
  "shipment_details": {
    "status": "pending",
    "created_at": "2025-12-15T14:35:00Z",
    "total_qty_shipped": 1150,
    "shipment_value": 9455.00
  },
  "backorder_so_details": {
    "status": "pending",
    "backorder_so_number": "BO-SO-2025-0142-001",
    "total_qty_backordered": 600,
    "backorder_value": 5785.00
  },
  "status_updates": {
    "original_so": {
      "old_status": "confirmed",
      "new_status": "partially_shipped",
      "updated_at": "2025-12-15T14:35:00Z"
    },
    "shipment": {
      "status": "pending",
      "next_step": "Ready for packing"
    },
    "backorder_so": {
      "status": "pending",
      "next_step": "Awaiting allocation"
    }
  },
  "recommended_actions": [
    "Shipment SHP-2025-0042 created successfully",
    "Backorder BO-SO-2025-0142-001 created successfully",
    "Customer notification email failed to send",
    "System will retry automatically every 5 minutes for 30 minutes",
    "Or manually send notification from Shipping module"
  ]
}
```

**Scenario 3: Partially Shipped Items (Some Lines Succeeded, Some Failed)**
```json
{
  "success": false,
  "partial_failure": true,
  "error": "Shipment partially created - some lines failed due to inventory conflict",
  "shipment_id": "uuid-shipment-1",
  "shipment_number": "SHP-2025-0042",
  "shipment_created": true,
  "backorder_created": true,
  "line_items_results": {
    "total_lines": 3,
    "succeeded": 2,
    "failed": 1,
    "details": [
      {
        "line_id": "uuid-line-1",
        "line_number": 1,
        "product_name": "Premium Yogurt",
        "status": "success",
        "quantity_shipped": 850,
        "quantity_backordered": 100,
        "message": "Line successfully included in shipment"
      },
      {
        "line_id": "uuid-line-2",
        "line_number": 2,
        "product_name": "Organic Cheese",
        "status": "failed",
        "requested_qty": 300,
        "actual_qty_shipped": 0,
        "error_code": "ALLOCATION_CHANGED",
        "error_message": "Allocation has changed since modal opened. Another user shipped 300 units.",
        "recommended_action": "Refresh and retry with current allocation (0 units available)"
      },
      {
        "line_id": "uuid-line-3",
        "line_number": 3,
        "product_name": "Whole Milk",
        "status": "success",
        "quantity_shipped": 0,
        "quantity_backordered": 500,
        "message": "Entire line backordered (no inventory available)"
      }
    ]
  },
  "shipment_details": {
    "status": "pending",
    "created_at": "2025-12-15T14:35:00Z",
    "total_qty_shipped": 850,
    "shipment_value": 8457.50,
    "shipment_lines": [
      {
        "shipment_line_id": "uuid-ship-line-1",
        "original_line_id": "uuid-line-1",
        "product_id": "uuid-prod-1",
        "quantity_shipped": 850
      }
    ]
  },
  "backorder_so_details": {
    "status": "pending",
    "backorder_so_number": "BO-SO-2025-0142-001",
    "total_qty_backordered": 600,
    "backorder_value": 5785.00,
    "backorder_lines": [
      {
        "backorder_line_id": "uuid-bo-line-1",
        "product_name": "Premium Yogurt",
        "quantity_backordered": 100
      },
      {
        "backorder_line_id": "uuid-bo-line-3",
        "product_name": "Whole Milk",
        "quantity_backordered": 500
      }
    ]
  },
  "recommended_actions": [
    "Shipment partially created with 850 units of Premium Yogurt only",
    "Backorder created for 600 units (Premium Yogurt 100 + Whole Milk 500)",
    "Line 2 (Organic Cheese) was excluded due to allocation conflict",
    "Refresh data and create another shipment for Organic Cheese if available"
  ]
}
```

### Get Backorder SO Details (GET)
```
GET /api/shipping/sales-orders/:backorderSoId

Response includes:
{
  "sales_order_id": "uuid-bo-so-1",
  "order_number": "BO-SO-2025-0142-001",
  "customer_id": "uuid-cust-1",
  "parent_so_id": "uuid-so-1",
  "parent_so_number": "SO-2025-0142",
  "status": "pending",
  "relationship": "backorder_of_SO_2025_0142",
  "created_from_partial_fulfillment": true,
  ...rest of SO data
}
```

---

## Permissions

| Role | View Partial | Create Partial | Approve Override |
|------|--------------|-----------------|-----------------|
| Admin | Yes | Yes | Yes |
| Shipping Manager | Yes | Yes | Yes |
| Shipping Clerk | Yes | No | No |
| Sales Manager | Yes | No | No |
| Warehouse Manager | Yes | No | No |
| Viewer | Yes | No | No |

**Rules:**
- **View Partial Fulfillment**: Requires `shipping.orders.view` permission
- **Create Partial Shipment**: Requires `shipping.orders.partial_fulfill` permission
- **Create Backorder**: Automatic, included in partial fulfillment permission
- **Approve Backorder Override**: Requires `shipping.orders.approve_backorder` permission

---

## Validation Rules

### Line Item Validation
- **Min Ship Qty**: Can be 0 (skip this line from shipment)
- **Max Ship Qty**: Cannot exceed allocated_qty (validation error)
- **Backorder Qty**: Auto-calculated as (allocated_qty - ship_qty)
- **At least 1 line**: Must ship at least 1 unit across all lines (cannot create empty shipment)

### Partial Fulfillment Validation
- **Shipment must have qty**: SUM(ship_qty) > 0 (cannot create shipment with 0 units)
- **Cannot exceed allocated**: For each line, ship_qty <= allocated_qty
- **Backorder calculation**: backorder_qty = allocated_qty - ship_qty
- **Value calculation**: Proportional split of line_total based on ship_qty / allocated_qty

### Backorder Creation Validation
- **Auto-created**: When any line has backorder_qty > 0
- **Linked to original SO**: parent_so_id = original sales_order_id
- **Copy customer**: Use same customer_id as original SO
- **Auto-number**: BO-SO-{original_so_number}-{sequence}
- **Status**: Always "pending" at creation

### Notification Validation
- **Customer contact required**: Must have valid email or phone
- **Email format**: Validate email address if sending notification
- **SMS format**: Validate phone number if sending SMS

### Permission Checks
- User must have `shipping.orders.partial_fulfill` permission
- User must belong to same org as sales_order.org_id
- If read-only view, disable all input controls

---

## Business Rules

### Partial Fulfillment Creation Logic
1. **Validate SO Status**:
   - Only allow partial fulfillment if SO status = "confirmed" OR "allocated" OR "picking" OR "packing"
   - Do NOT allow if SO status = "shipped", "cancelled", "draft", "on_hold"

2. **For Each Line Item**:
   - Get allocated_qty from inventory_allocations
   - Default ship_qty = allocated_qty (full shipment)
   - User can reduce ship_qty via slider/input
   - Backorder_qty = allocated_qty - ship_qty (auto-calculated)

3. **Shipment Creation**:
   - Create shipment record with status = "pending"
   - Create shipment_lines for lines where ship_qty > 0
   - Update inventory_allocations: qty_shipped_qty += ship_qty
   - Do NOT release allocations yet (keep reserved)

4. **Backorder SO Creation** (if any backorder_qty > 0):
   - Create new sales_order with status = "pending"
   - SO number: BO-SO-{original_so_number}-{sequence}
   - Copy customer_id, shipping_address_id, order_date from original
   - Create sales_order_lines for lines where backorder_qty > 0
   - Link parent_so_id to original SO
   - Set relationship field: "backorder_of_{original_so_number}"

5. **Status Transitions**:
   - Original SO: confirmed â†’ partially_shipped (if partial) OR shipped (if full)
   - Shipment: pending â†’ ready for packing
   - Backorder SO: pending â†’ awaiting allocation/production

6. **Inventory Management**:
   - Keep allocations intact (don't release)
   - Shipped qty counts against allocated qty
   - Backorder qty stays allocated to new backorder SO
   - Update license_plates.quantity_shipped += shipped_qty

7. **Customer Notification**:
   - If send_notification = true:
   - Send email to customer with partial shipment details
   - Include tracking info (once carrier assigned)
   - Include backorder ETA (estimated_ship_date)

### Split Calculation Example
```
Original SO Line 1: Premium Yogurt
  - Ordered: 950 units @ $9.95 = $9,502.50
  - Allocated: 950 units
  - User sets Ship Qty: 850 units
  - Backorder Qty: 950 - 850 = 100 units
  - Ship Value: 850 * 9.95 = $8,457.50
  - Backorder Value: 100 * 9.95 = $995.00

Shipment contains: SO-Line-1: 850 units
Backorder SO contains: BO-Line-1: 100 units
```

### Backorder Link Relationship
```
Original SO-2025-0142
â”œâ”€ status: partially_shipped
â”œâ”€ shipment_id: uuid-shipment-1 (partial shipment)
â””â”€ backorder_so_id: uuid-bo-so-1 (new backorder SO)

Backorder SO BO-SO-2025-0142-001
â”œâ”€ parent_so_id: uuid-so-1 (link back to original)
â”œâ”€ relationship: backorder_of_SO-2025-0142
â””â”€ status: pending
```

### Notification Workflow
```
1. User confirms partial fulfillment
2. System creates shipment + backorder SO
3. If send_notification = true:
   - Query customer contact (email/phone)
   - Render email template with:
     * Shipment details (qty, tracking, ETA)
     * Backorder details (qty, items, ETA)
     * Link to SO detail page
   - Send email via email service
   - Send SMS if enabled (opt-in)
4. Create fulfillment note in SO timeline:
   - "Partial shipment created: 1,150 units"
   - "Backorder created: BO-SO-2025-0142-001 (600 units)"
   - Link to both shipment and backorder
```

---

## Accessibility

### Touch Targets
- Qty slider: >= 48x48dp
- Qty input spinner (+/- buttons): >= 48x48dp
- [Confirm] button: >= 48x48dp
- Checkbox (send notification): >= 48x48dp
- [Cancel], [Review] buttons: >= 48x48dp

### Contrast
- Modal title (dark gray on white): 8:1
- Body text: 4.5:1
- Status badges:
  - âœ“ FULLY ALLOCATED (green): 4.5:1
  - âš  PARTIALLY ALLOCATED (yellow): 4.5:1
  - âœ— NOT ALLOCATED (red): 4.5:1
- Input fields (border): 3:1 minimum
- Focus states: 3:1 minimum

### Screen Reader
- **Modal**: role="dialog" aria-labelledby="partial-ship-title" aria-modal="true"
- **SO Summary**: aria-label="Sales Order SO-2025-0142, total $15,240"
- **Line Item Row**: aria-label="Line 1, Premium Yogurt, allocated 950 units, ship 850, backorder 100"
- **Qty Slider**: aria-label="Quantity to ship (0 to 950 units)" aria-valuenow="850" aria-valuemin="0" aria-valuemax="950"
- **Status Badge**: aria-label="Status: Partially Allocated, 100 units short"
- **Shipment Totals**: aria-label="Total to ship 1,150 units, total backorder 600 units"
- **Notification Checkbox**: aria-label="Send partial shipment notification to customer"
- **Confirmation Panel**: role="alert" aria-label="Warning: This will create partial shipment and backorder"

### Keyboard Navigation
- **Tab**: Cycle through qty sliders, checkboxes, buttons
- **Enter**: Activate button (Confirm, Cancel)
- **Shift+Tab**: Reverse cycle
- **Arrow Keys**: Adjust slider value (Left/Right), increase/decrease qty (Up/Down on spinner)
- **Space**: Toggle checkbox (send notification)
- **Escape**: Close modal (with confirmation if changes made)
- **Alt+C**: Confirm partial shipment
- **Alt+X**: Cancel

### ARIA Labels
- **Modal Title**: aria-labelledby="partial-ship-title"
- **Order Summary**: aria-label="Sales Order SO-2025-0142 from Acme Foods, total amount $15,240"
- **Line Items**: aria-label="Line {number}, {product_name}, allocated {qty}, can ship {qty}"
- **Qty Slider**: aria-label="Adjust quantity to ship for {product_name} (0 to {allocated_qty} units)"
- **Status Badge**: aria-label="Allocation Status: {status} ({percentage})"
- **Shipment Total**: aria-label="Total quantity to ship {total_qty} units, value {total_value}"
- **Backorder Total**: aria-label="Total quantity to backorder {total_qty} units, value {total_value}"
- **Backorder SO**: aria-label="Backorder SO {bo_number}, status pending, linked to original {original_so_number}"
- **Notification**: aria-label="Send partial shipment notification to customer {email}"
- **Confirmation**: role="alert" aria-live="assertive" aria-label="Warning: This action will create partial shipment and backorder"

---

## Responsive Breakpoints

| Breakpoint | Layout | Adjustments |
|------------|--------|-------------|
| **Desktop (>1024px)** | Full modal (90vw, max 1200px) | All columns visible, full line table, sliders with labels |
| **Tablet (768-1024px)** | Modal 95vw, max 900px | Hide "unit_price" column, compact line table |
| **Mobile (<768px)** | Full-screen modal (100vw) | Stack line items as cards, use spinners instead of sliders |

### Mobile Responsive Adjustments
- **Modal**: Full-screen with top close button (âœ•)
- **Order Summary**: Stack fields vertically (1 per row)
- **Line Items**: Convert to stacked cards
  ```
  â”Œâ”€ Premium Yogurt (500mL)
  â”‚  Allocated: 950 units
  â”‚  Ship: [â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€]
  â”‚  Backorder: 100 units
  â”‚  Status: âš  Partial
  â””
  ```
- **Qty Control**: Use spinner (+/- buttons) instead of slider
- **Shipment Totals**: Stack sections vertically
- **Notification**: Full-width checkbox
- **Buttons**: Full-width stack at bottom
- **Font Size**: 12px body, 14px headings, 10px secondary

---

## Performance Notes

### Query Optimization
- **Index**: (org_id, sales_order_id) for SO lines lookup
- **Index**: (org_id, sales_order_id, status) for allocation lookup
- **Index**: (org_id, parent_so_id) for backorder SO lookup
- **Batch Query**: Fetch all lines + allocations in single query (not per-line)
- **Cache Strategy**: Cache SO detail + allocations for 1 minute

### Caching
```typescript
// Redis keys
'org:{orgId}:shipping:so:{soId}:detail'                  // 1 min TTL (SO detail)
'org:{orgId}:shipping:so:{soId}:allocations'             // 1 min TTL (allocation data)
'org:{orgId}:shipping:so:{soId}:partial-fulfill:data'    // 2 min TTL (partial fulfillment data)

// Invalidation triggers:
// - Partial fulfillment created â†’ invalidate SO cache
// - Backorder SO created â†’ invalidate SO cache
// - Inventory move â†’ invalidate allocation cache
```

### Load Time Targets
- **Fetch Partial Fulfillment Data**: <500ms (for SOs with <50 lines)
- **Calculate Shipment Split**: <200ms (in-memory calculation)
- **Create Shipment + Backorder**: <1000ms (DB writes)
- **Modal Render**: <200ms (with skeleton loaders)
- **Send Notification**: <2000ms (async, don't block UI)

### Lazy Loading
1. Load SO detail + order summary (200ms)
2. Load line items + allocations in background (async)
3. Load customer contact info (async)
4. Calculate shipment split (progressive)

---

## Error Handling

### API Errors
- **Network Error**: Error banner + [Retry] button
- **Timeout (>5s)**: "Request timed out. Checking your connection..."
- **400 Bad Request**: "Invalid shipment configuration. Please refresh and try again."
- **401 Unauthorized**: Redirect to login
- **403 Forbidden**: "You do not have permission to create partial shipments."
- **404 Not Found**: "Sales order not found. It may have been cancelled."
- **409 Conflict**: "Shipment already exists. Cannot create another shipment."
- **500 Server Error**: "Server error. Please contact support."

### Validation Errors (Client-side)
- **Ship Qty > Allocated**: "Cannot ship more than allocated ({allocated_qty} units)"
- **All Lines Have Qty 0**: "Must ship at least 1 unit for at least 1 line"
- **Qty Exceeds Bounds**: "Quantity must be between 0 and {allocated_qty}"
- **No Backorder Lines**: "At least 1 line must have qty to backorder"
- **Negative Qty**: "Quantity cannot be negative"

### Backorder Errors
- **Cannot Create Backorder**: "Failed to create backorder SO. Please contact support."
- **SO Number Generation Failed**: "Could not generate backorder SO number. Try again."
- **Parent Link Failed**: "Could not link backorder to original SO. Manual intervention required."

### Notification Errors
- **No Valid Email**: "Customer has no email on file. Cannot send notification."
- **Send Email Failed**: "Failed to send notification email. You can send manually."
- **SMS Not Configured**: "SMS is not configured. Email will be sent instead."

### Partial Failures
- **Shipment Created, Backorder Failed**: Show success for shipment, error for backorder, prompt retry
- **Notification Failed After Shipment**: Show warning "Shipment created but notification not sent. Send manually?"
- **Some Lines Failed**: Show which lines succeeded/failed, allow retry for failed lines

---

## Testing Requirements

### Unit Tests
- **Split Calculation**: Correct backorder_qty = allocated_qty - ship_qty
- **Shipment Value**: Proportional calculation of line_total based on ship_qty
- **Backorder Value**: Proportional calculation based on backorder_qty
- **Status Transitions**: draft â†’ partially_shipped, new backorder SO status = pending
- **SO Number Generation**: BO-SO-{original_so_number}-{seq} format correct
- **Validation**: Cannot ship > allocated, must ship at least 1 unit
- **Permission Check**: Only Shipping Manager/Admin can create partial shipments

### Integration Tests
- **Fetch Partial Fulfillment Data**: GET /api/shipping/sales-orders/:id/partial-fulfill
  - Returns correct allocated/ship quantities
  - Returns correct line items with status
  - Returns customer contact info
  - Handles products with partial/zero allocation
- **Confirm Partial Fulfillment**: POST /api/shipping/sales-orders/:id/partial-fulfill
  - Creates shipment with correct shipped lines
  - Creates backorder SO with correct backorder lines
  - Updates SO status to "partially_shipped"
  - Creates inventory allocations for shipped qty
  - Sends notification email to customer
  - Links backorder to original SO
- **Backorder SO Created**: Verify new SO has:
  - Correct parent_so_id link
  - Correct relationship field
  - Correct line items with backorder quantities
  - Correct customer, shipping address
  - Status = "pending"

### E2E Tests
- **Happy Path: Partial Fulfillment**:
  - Open SO detail with partial allocation (950 of 1,200 allocated)
  - Click [Partial Shipment]
  - Modal opens with 850 units suggested to ship
  - Adjust qty if needed
  - Check [Send Notification]
  - Click [Confirm Partial Shipment]
  - Verify shipment created (SHP-2025-0042)
  - Verify backorder SO created (BO-SO-2025-0142-001)
  - Verify customer notified
  - Verify SO status = "partially_shipped"
- **Happy Path: Full Allocation**:
  - Open SO detail with full allocation (1,750 of 1,750 allocated)
  - Click [Partial Shipment]
  - Modal shows "All lines fully allocated"
  - Option to [Create Full Shipment Instead]
- **Error: Zero Allocation Line**:
  - Open SO with some lines not allocated
  - Modal shows âœ— NOT ALLOCATED status
  - Cannot ship these lines
  - Must backorder full qty
  - Backorder SO created for unallocated qty
- **Error: Insufficient Permission**:
  - Shipping Clerk clicks [Partial Shipment]
  - Permission denied banner shown
  - [Request Approval] email sent to manager
- **Error: Invalid Configuration**:
  - User sets all line items ship qty to 0
  - Validation error: "Must ship at least 1 unit"
  - Cannot confirm
- **Responsive: Mobile Partial Fulfillment**:
  - Open SO on mobile
  - Modal full-screen
  - Adjust qty using spinners (+/- buttons)
  - Toggle notification checkbox
  - Click [Confirm]
  - Verify backorder created on mobile

### Performance Tests
- **Load Partial Fulfillment Data**: <500ms for SO with 10 lines
- **Calculate Shipment Split**: <200ms (1,000 lines)
- **Create Shipment + Backorder**: <1000ms
- **Send Notification**: <2000ms (async)

---

## Quality Gates

Before handoff to FRONTEND-DEV:
- [x] All 4+ states defined (Loading, Empty x5, Error x3, Success, Success Modal)
- [x] Responsive breakpoints documented (Desktop/Tablet/Mobile)
- [x] All API endpoints specified with request/response schemas (3 endpoints)
- [x] Accessibility checklist passed (touch targets, contrast, screen reader, keyboard, ARIA)
- [x] Line item quantity adjustment logic documented (slider/spinner controls)
- [x] Real-time validation UI patterns documented (inline errors, red borders, recovery actions)
- [x] Cancel confirmation dialog documented (unsaved changes warning)
- [x] Shipment split calculation documented (ship_qty vs. backorder_qty)
- [x] Backorder SO creation logic documented (auto-generation, linking, status)
- [x] Customer notification documented (email template, SMS option, fulfillment note)
- [x] Status transitions documented (SO: partially_shipped, Backorder: pending)
- [x] Inventory allocation management documented (keep allocated, don't release)
- [x] Proportional value calculation documented (shipment_value, backorder_value)
- [x] Validation rules defined (ship_qty <= allocated, at least 1 line, no negative)
- [x] Permission matrix documented (6 roles)
- [x] Security & input validation documented (max qty limits, negative prevention, race condition handling)
- [x] Error handling strategy defined (API errors, validation, notification failures)
- [x] Performance targets defined (load times, caching strategy)
- [x] Business rules documented (split logic, backorder creation, notification workflow)
- [x] Testing requirements defined (unit, integration, E2E, performance)
- [x] Qty adjustment controls specified (slider/spinner with constraints)
- [x] Shipment totals calculation specified (auto-calculation, real-time updates)
- [x] Backorder SO linking specified (parent_so_id, relationship field)
- [x] Notification templates specified (email content, SMS option)
- [x] Success confirmation modal specified (shipment + backorder details)
- [x] Empty state scenarios expanded (5 scenarios: full allocation, cancelled, shipped, draft, zero lines)
- [x] Undo/rollback future enhancement documented
- [x] Print preview future enhancement documented
- [x] Slider real-time validation future enhancement documented
- [x] Loading state progress indicator clarified (3s threshold, Phase 2 slider validation)
- [x] Partial failure JSON response examples added (3 scenarios)

---

## Handoff to FRONTEND-DEV

```yaml
feature: Partial Fulfillment & Backorder Creation
story: SHIP-010
prd_coverage: "FR-7.15 (Partial Fulfillment), FR-7.16 (Backorder Management)"
approval_status:
  mode: "review_each"
  user_approved: false
  screens_approved: []
  iterations_used: 0
deliverables:
  wireframe: docs/3-ARCHITECTURE/ux/wireframes/SHIP-010-partial-fulfillment.md
  api_endpoints:
    - GET /api/shipping/sales-orders/:id/partial-fulfill (fetch partial fulfillment data)
    - POST /api/shipping/sales-orders/:id/partial-fulfill (confirm partial shipment + create backorder)
    - GET /api/shipping/sales-orders/:backorderSoId (get backorder SO details)
states_per_screen: [loading, empty x5, error x3, success, success_modal]
breakpoints:
  mobile: "<768px (full-screen modal, stacked line cards, spinners)"
  tablet: "768-1024px (95vw modal, compact line table)"
  desktop: ">1024px (90vw modal, max 1200px, full line table, sliders)"
accessibility:
  touch_targets: "48x48dp minimum"
  contrast: "4.5:1 minimum (text, badges)"
  aria_roles: "dialog, alert, live regions"
  keyboard_nav: "Tab, Enter, Space, Arrow keys (slider/spinner), Escape"
modal_components:
  order_summary: "Order #, Customer, Status, Total Amount, Promised Ship Date"
  line_items_table: "Product, Allocated Qty, Ship Qty (slider), Backorder Qty (auto), Status"
  shipment_totals: "Total Ship Qty, Total Backorder Qty, Shipment Value, Backorder Value"
  backorder_so_details: "Backorder SO #, Status, Linked to Original SO, Estimated Ship Date"
  customer_notification: "Email checkbox, SMS option, fulfillment note"
  confirmation_panel: "Warning banner, action summary, Confirm button"
  success_modal: "Shipment details, Backorder details, Notification status, Quick actions"
qty_adjustment:
  slider: "Desktop/Tablet: Range [0 â”€ allocated_qty]"
  spinner: "Mobile: +/- buttons with numeric input"
  constraints: "Min: 0, Max: allocated_qty, No negative"
  real_time: "Auto-calculate backorder_qty = allocated_qty - ship_qty"
  validation: "Inline error messages, red border if invalid, recovery actions"
calculations:
  backorder_qty: "allocated_qty - ship_qty (auto-calculated)"
  shipment_value: "SUM(ship_qty * unit_price)"
  backorder_value: "SUM(backorder_qty * unit_price)"
  so_number_format: "BO-SO-{original_so_number}-{sequence}"
backorder_creation:
  auto_generated: "When any line has backorder_qty > 0"
  parent_link: "parent_so_id = original sales_order_id"
  relationship: "backorder_of_{original_so_number}"
  status: "pending (awaiting allocation/production)"
  customer: "Same customer_id as original SO"
notification:
  email_required: "If send_notification = true, customer must have valid email"
  template: "Partial shipment details + backorder ETA"
  recipient: "Customer contact (configurable)"
  sms_optional: "If enabled and phone on file"
  fulfillment_note: "Create note in SO timeline"
permissions: 6 roles
  - admin (partial_fulfill, approve, backorder)
  - shipping_manager (partial_fulfill, approve, backorder)
  - shipping_clerk (view only)
  - sales_manager (view only)
  - warehouse_manager (view only)
  - viewer (view only)
validation_rules:
  - ship_qty: ">= 0 and <= allocated_qty"
  - at_least_one: "SUM(ship_qty) > 0 (cannot ship 0 units total)"
  - backorder_calc: "backorder_qty = allocated_qty - ship_qty"
  - value_calc: "proportional split by qty ratio"
  - no_negative: "Client + Server validation, cannot be negative"
  - max_qty_limits: "9,999,999 per line, 99,999,999 total"
status_transitions:
  original_so: "confirmed/allocated â†’ partially_shipped"
  shipment: "pending â†’ packing (after confirmation)"
  backorder_so: "pending â†’ awaiting allocation/production"
real_time_validation:
  - inline_errors: "Cannot ship more than allocated (max: {qty})"
  - red_border: "On input field when qty invalid"
  - recovery_actions: "[Clear Error] [Adjust to Max] buttons"
  - success_feedback: "Green border + checkmark when valid"
cancel_confirmation:
  - trigger: "When user clicks Cancel with unsaved changes"
  - dialog: "Discard unsaved changes? [Stay] [Discard Changes]"
  - list_changes: "Show all qty modifications made"
  - recovery: "Stay in modal to continue editing"
security:
  - input_validation: "Client + Server validation, Zod schemas"
  - negative_prevention: "Type=number, min=0 constraint"
  - max_qty_limits: "Enforce 9,999,999 per line, reject if exceeded"
  - race_condition: "Optimistic locking with allocation_version"
  - sql_injection: "Parameterized queries, no string concatenation"
future_enhancements:
  - undo_rollback: "Phase 2: Undo partial shipment within 30 min, admin rollback"
  - print_preview: "Phase 2: Packing label (PDF), pick list, backorder report"
  - slider_validation: "Phase 2: Real-time API validation with debounce, spinner overlay on slider"
performance_targets:
  fetch_partial_data: "<500ms"
  calculate_split: "<200ms"
  create_shipment_backorder: "<1000ms"
  send_notification: "<2000ms (async)"
cache_ttl:
  partial_fulfill_data: "2min"
  so_detail: "1min"
  allocations: "1min"
error_scenarios:
  - all_lines_full: "Show empty state, [Create Full Shipment Instead]"
  - so_cancelled: "Show empty state, Cannot Fulfill Cancelled Order"
  - so_already_shipped: "Show empty state, Order Already Shipped"
  - so_draft: "Show empty state, Order Not Confirmed Yet"
  - so_zero_lines: "Show empty state, No Line Items to Ship"
  - insufficient_permissions: "Show read-only view, [Request Approval]"
  - zero_ship_qty: "Validation error, cannot confirm"
  - backorder_creation_failed: "Show error, prompt retry"
  - notification_failed: "Show warning, option to send manually"
backorder_so_linking:
  parent_so_id: "Link to original SO (bidirectional)"
  relationship_field: "backorder_of_{original_so_number}"
  in_so_detail: "Show backorder SOs in original SO detail page"
  in_backorder_list: "Show link to parent SO"
quality_score: "96.75% (3 Minor Issues Fixed)"
issues_fixed:
  - "1. Loading state inconsistency â†’ Added note that percentage shows only if load > 3s"
  - "2. Slider loading note unclear â†’ Clarified Phase 2 enhancement with current client-side validation"
  - "3. Missing JSON partial failures â†’ Added 3 detailed response examples (shipment success+backorder fail, notification fail, partial lines)"
```

---

## Session Summary

**Completed in This Session:**
- Fixed Issue 1: Loading state now clearly shows "Progress percentage shown only if load time exceeds 3 seconds" in wireframe
- Fixed Issue 2: Updated slider loading note from vague "Phase 2 enhancement" to "Real-time validation: Phase 2 (current: client-side only)"
- Fixed Issue 3: Added 3 comprehensive JSON error response examples for partial failure scenarios:
  - Shipment created but backorder failed
  - Shipment and backorder created but notification failed
  - Partially shipped items (some lines succeeded, some failed due to conflicts)

**File Updates:**
- `/workspaces/MonoPilot/docs/3-ARCHITECTURE/ux/wireframes/SHIP-010-partial-fulfillment.md`

**Quality Improvements:**
- Loading state progress behavior now explicitly documented in both wireframe and summary
- Slider validation phase clearly distinguished (Phase 2 future vs. Phase 1 current)
- Partial failure handling now has concrete JSON examples developers can implement
- Quality score improved from 95.2% to 96.75%

**Consistency Checks:**
- All 3 fixes maintain 96% quality standard
- No breaking changes to existing sections
- All wireframes, states, and API specs unchanged
- Only clarifications and JSON examples added

**Status**: Ready for User Approval (review_each mode)

---

**END OF WIREFRAME**
