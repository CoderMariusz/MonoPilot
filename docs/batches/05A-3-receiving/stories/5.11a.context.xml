<?xml version="1.0" encoding="UTF-8"?>
<story>
  <id>5.11a</id>
  <name>GRN & LP Creation (Basic)</name>
  <batch>5A-3 (Receiving) - SPLIT from 5.11</batch>
  <part>1 of 3</part>
  <updated>2025-11-28</updated>
  <status>Todo</status>

  <context>
    <description>
      Part 1 of GRN implementation. Creates Goods Receipt Note records,
      auto-generates GRN and LP numbers, and creates license plate records
      for received inventory (happy path only).
    </description>

    <scope>
      - GRN creation modal
      - Auto-generate GRN number (GRN-YYYYMMDD-NNNN)
      - Auto-generate LP numbers for each item
      - Link LPs to GRN items
      - Basic validation (qty > 0, product exists)
      - GRN list and detail pages
    </scope>

    <what-is-not-included>
      - ASN/PO status updates (see 5.11b)
      - Transaction atomicity (see 5.11c)
      - Over-receipt validation (see 5.11c)
      - Error handling beyond validation (see 5.11c)
    </what-is-not-included>

    <critical-requirements>
      GRN number format: GRN-YYYYMMDD-NNNN (same pattern as LP)
      LP number format: LP-YYYYMMDD-NNNN
      Both use receiving date for sequence.
      GRN status remains 'created' until integrated (5.11b updates to 'received').
      Each grn_item must have corresponding license_plates record.
    </critical-requirements>

    <related-stories>
      <requires>5.1 (LP Creation), 5.4 (LP Number Generation), 5.3 (Batch/Expiry)</requires>
      <followed-by>5.11b (GRN Integration), 5.11c (Transaction Atomicity)</followed-by>
    </related-stories>

    <effort-estimate>
      <hours>4-5</hours>
      <points>3</points>
    </effort-estimate>

    <implementation-notes>
      - Create grn_number_sequence table (similar to lp_number_sequence)
      - GRN form: source selector (ASN/PO/Ad-hoc), items table, notes
      - Validation: product exists, qty > 0, location exists
      - GRN list: shows all GRNs, filters by date/source
      - GRN detail: shows items with LP numbers, links to detail
      - LP numbers created in same transaction (no atomicity yet - added in 5.11c)
      - Status messages: show GRN number and LP list on success
    </implementation-notes>
  </context>
</story>
