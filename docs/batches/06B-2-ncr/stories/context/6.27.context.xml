<?xml version="1.0" encoding="UTF-8"?>
<story>
  <metadata>
    <id>6.27</id>
    <title>NCR Workflow</title>
    <batch>06B-2</batch>
    <status>drafted</status>
  </metadata>

  <description>Provide streamlined UX for NCR management (CAPA process)</description>

  <dependencies>
    <requires>
      <story id="6.15">NCR Creation</story>
    </requires>
  </dependencies>

  <technical_context>
    <frontend_routes>
      <route path="/quality/ncrs">NCR list page</route>
      <route path="/quality/ncrs/:id">NCR detail page</route>
    </frontend_routes>

    <api_endpoints>
      <endpoint method="GET" path="/api/quality/ncrs">List NCRs with filters</endpoint>
      <endpoint method="GET" path="/api/quality/ncrs/:id">Get NCR details</endpoint>
      <endpoint method="PUT" path="/api/quality/ncrs/:id">Update NCR</endpoint>
      <endpoint method="POST" path="/api/quality/ncrs/:id/notes">Add note</endpoint>
    </api_endpoints>

    <components_to_create>
      <component>NCRListPage - table with filters</component>
      <component>NCRDetailPage - tabs: Details, Root Cause, Actions, Timeline, Links</component>
    </components_to_create>
  </technical_context>

  <acceptance_criteria>
    <ac id="1">/quality/ncrs shows list: NCR#, Type, Severity, Status, Assigned, Target date</ac>
    <ac id="2">Filters: status, severity, type, user</ac>
    <ac id="3">Detail tabs: Details, Root Cause, Actions, Timeline, Links</ac>
  </acceptance_criteria>
</story>
