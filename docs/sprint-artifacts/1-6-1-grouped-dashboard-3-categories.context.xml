<story-context id=".bmad/bmm/workflows/4-implementation/story-context/template" v="1.0">
  <metadata>
    <epicId>1.6</epicId>
    <storyId>1</storyId>
    <title>Grouped Dashboard 3 Categories</title>
    <status>drafted</status>
    <generatedAt>2025-11-16</generatedAt>
    <generator>BMAD Story Context Workflow</generator>
    <sourceStoryPath>docs/sprint-artifacts/1-6-1-grouped-dashboard-3-categories.md</sourceStoryPath>
  </metadata>

  <story>
    <asA>Technical Manager</asA>
    <iWant>Replace 5 tabs with 3 groups (Raw Materials, Finished Products, Settings)</iWant>
    <soThat>navigation is 50% faster and information architecture is clearer</soThat>
    <tasks>6 tasks: Group UI redesign (3 groups), smart tables per group, column visibility toggle, card view mode, search/filter, E2E tests, documentation. Total: 20h (~2-3 days)</tasks>
  </story>

  <acceptanceCriteria>7 ACs covering: (1) 3 groups (Raw Materials: RM-Meat/RM-Dry, Finished Products: FG/PR, Settings: Allergens/Tax Codes/Suppliers), (2) Smart tables (auto-columns per group), (3) Column visibility toggle, (4) Card view mode (alternative to table), (5) Search/filter per group, (6) Persistent preferences, (7) Documentation</acceptanceCriteria>

  <artifacts>
    <docs>
      <doc path="docs/ux-design-technical-module.md" title="Technical Module UX" section="Grouped Dashboard">
        Replace 5 tabs with 3 logical groups. Features: Smart tables, column visibility, card view. Time savings: 50% faster navigation. ROI: Clearer information architecture.
      </doc>
    </docs>
    <code>
      <artifact path="apps/frontend/lib/api/products.ts" kind="API Class">
        Filter products by type (RM-Meat, RM-Dry, FG, PR) for group display
      </artifact>
    </code>
    <dependencies>
      <framework>React Table or TanStack Table for smart tables</framework>
    </dependencies>
  </artifacts>

  <constraints>
    <constraint type="grouping">Raw Materials: product_type IN ('RM-Meat', 'RM-Dry'). Finished Products: product_type IN ('FG', 'PR'). Settings: allergens, tax_codes, suppliers</constraint>
    <constraint type="preferences">Store column visibility + view mode in user_preferences table</constraint>
  </constraints>

  <interfaces>
    <interface name="GroupedDashboard component" kind="React Component">
      <signature>&lt;GroupedDashboard activeGroup="raw-materials" | "finished-products" | "settings" /&gt;</signature>
    </interface>
  </interfaces>

  <tests>
    <standards>E2E required for: Group switching, column visibility toggle, view mode switching, search/filter</standards>
    <locations>
      <e2e>apps/frontend/e2e/grouped-dashboard.spec.ts</e2e>
    </locations>
    <ideas>
      <test ac="AC-1" risk="MEDIUM">E2E: Switch from Raw Materials group → Finished Products → correct products shown</test>
      <test ac="AC-3" risk="LOW">E2E: Toggle column visibility → columns hidden/shown</test>
    </ideas>
  </tests>
</story-context>
