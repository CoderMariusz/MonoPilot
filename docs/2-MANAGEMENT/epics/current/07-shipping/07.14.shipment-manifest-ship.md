# 07.14 - Shipment Manifest + Ship + Tracking

**Priority**: P0 (MVP Core)
**Complexity**: M (3-4 days)
**Type:** backend + frontend
**Phase:** 1C (After Story 07.13 - SSCC Generation)

**State:** ready
**Primary PRD:** `docs/1-BASELINE/product/modules/shipping.md` (FR-7.15 Partial Fulfillment section)
**Architecture:** `docs/1-BASELINE/architecture/modules/shipping.md` (lines 178-202, 448-454, 757-788)

---

## MVP Scope

This story implements the final shipment workflow steps: manifest generation, ship confirmation, delivery marking, and tracking display. Handles status transitions from packed through shipped to delivered, with LP consumption and sales order cascade updates.

**What's IN scope:**
- POST /api/shipping/shipments/:id/manifest (validate SSCC, update status to 'manifested')
- POST /api/shipping/shipments/:id/ship (validate manifest, consume LPs, update SO)
- POST /api/shipping/shipments/:id/mark-delivered (Manager+ only)
- GET /api/shipping/shipments/:id/tracking (return tracking info)
- Shipment detail page actions: Manifest, Ship, Mark Delivered, View Tracking buttons
- Status workflow enforcement: packed → manifested → shipped → delivered
- LP consumption: license_plates.status → 'shipped' on ship confirmation
- SO cascade updates: sales_orders.status → 'shipped', shipped_at, quantity_shipped
- Tracking display component (timeline with status, dates, carrier info)
- Permission requirements: Ship (Warehouse+), Mark Delivered (Manager+)
- Confirmation dialog for ship action (irreversible)
- Validation: all boxes must have SSCC before manifest

**What's OUT of scope (deferred to other stories):**
- Carrier API integration (Phase 2 - Story 07.25)
- Automatic tracking number retrieval (Phase 2)
- Tracking webhook integration (Phase 2 - Story 07.27)
- Dock door assignment (Phase 2 - Story 07.18)
- Load scheduling (Phase 2 - Story 07.19)
- Proof of Delivery (POD) upload (Phase 2 - Story 07.24)
- Rate shopping (Phase 2 - Story 07.31)

---

## Dependencies

### Epic Dependencies
- **Epic 01.1** - Organizations, RLS, users, roles (HARD)
- **Epic 01.8** - Warehouses (HARD)
- **Epic 02.1** - Products (HARD)
- **Epic 05.1** - License Plates (HARD)

### Story Dependencies (within Epic 07)
- **07.1** - Customers CRUD (provides customers table)
- **07.2** - Customer Contacts + Addresses (provides customer_addresses table)
- **07.3** - Sales Orders CRUD (provides sales_orders table)
- **07.4** - SO Lines Management (provides sales_order_lines table)
- **07.7** - Inventory Allocation (provides allocations)
- **07.8** - Pick List Generation (provides pick lists)
- **07.9** - Pick Confirmation Desktop (provides completed picks)
- **07.11** - Packing Station + Shipment Creation (provides shipments, boxes) **[BLOCKER]**
- **07.13** - SSCC + Labels + BOL (provides SSCC generation, boxes.sscc populated) **[BLOCKER]**

### Provides To
- **07.15** - Shipping Dashboard (consumes shipped/delivered status)
- **07.16** - Orders by Status Report (consumes shipped metrics)
- **Epic 09** - Finance Module (provides shipped SO for invoicing)

---

## Goal

Enable warehouse managers to manifest shipments (validate SSCC completeness), confirm ship actions (irreversible LP consumption and SO updates), mark deliveries, and view tracking status, ensuring proper status workflow enforcement and cascade updates to all dependent records.

## User Story

As a **warehouse manager**, I want to **manifest shipments, confirm ship actions, and track delivery status** so that **inventory is properly consumed, sales orders are updated to shipped status, and we maintain accurate shipment tracking**.

## Scope

**In scope (this story)**
- Manifest endpoint: Validate SSCC presence, update shipment.status → 'manifested'
- Ship endpoint: Validate manifest, consume LPs, update SO and lines
- Mark Delivered endpoint: Manager+ only, update shipment.status → 'delivered'
- Tracking endpoint: Return tracking info (carrier, tracking_number, status timeline)
- Shipment detail page UI: Action buttons (Manifest, Ship, Mark Delivered, Tracking)
- Status workflow state machine enforcement
- LP status update: license_plates.status → 'shipped'
- SO cascade: sales_orders.status → 'shipped', shipped_at = now()
- SO lines cascade: sales_order_lines.quantity_shipped = quantity_packed
- Confirmation dialogs (ship action requires confirmation)
- Permission checks (Ship: Warehouse+, Delivered: Manager+)
- Tracking timeline component (status badges, dates, carrier info)
- RLS policies for multi-tenant isolation
- Audit trail (status changes logged)

**Out of scope (this story)**
- Carrier API integration (Phase 2)
- Automatic tracking number retrieval (Phase 2)
- Webhook tracking updates (Phase 2)
- Dock management (Phase 2)
- POD upload (Phase 2)

---

## Acceptance Criteria (Given/When/Then)

### AC-1: Manifest Shipment (Validate SSCC)

**Given** a shipment with status='packed' and all boxes have SSCC assigned
**When** user clicks "Manifest Shipment" button
**Then**:
- System validates all shipment_boxes have non-null sscc
- If validation passes: shipment.status → 'manifested'
- If validation fails: Display error "All boxes must have SSCC before manifesting"
- Success toast: "Shipment SH-2025-00123 manifested successfully"
- Manifest button becomes disabled, Ship button becomes enabled

### AC-2: Manifest Validation (Missing SSCC)

**Given** a shipment with status='packed' but 1+ boxes have null sscc
**When** user clicks "Manifest Shipment" button
**Then**:
- System returns 400 error: "Cannot manifest: X boxes missing SSCC"
- Error toast displayed
- Shipment status remains 'packed'
- User is prompted to complete SSCC generation (Story 07.13)

### AC-3: Ship Confirmation (Happy Path)

**Given** a shipment with status='manifested'
**When** user clicks "Ship" button → confirms dialog
**Then**:
- Confirmation dialog displays: "Ship SH-2025-00123? This action is irreversible. All inventory will be consumed."
- On confirm:
  - shipment.status → 'shipped'
  - shipment.shipped_at → now()
  - All license_plates in shipment_box_contents: status → 'shipped'
  - sales_orders.status → 'shipped'
  - sales_orders.shipped_at → now()
  - sales_order_lines.quantity_shipped = quantity_packed (for all lines)
- Success toast: "Shipment SH-2025-00123 shipped successfully"
- Ship button becomes disabled, Mark Delivered button becomes enabled

### AC-4: Ship Validation (Status Enforcement)

**Given** a shipment with status='packed' (not manifested)
**When** user clicks "Ship" button
**Then**:
- System returns 400 error: "Shipment must be manifested before shipping"
- Error toast displayed
- Shipment status remains 'packed'
- User is prompted to manifest first

### AC-5: LP Consumption on Ship

**Given** a shipment being shipped with 3 license plates in box contents
**When** ship confirmation is executed
**Then**:
- All 3 license_plates.status updated to 'shipped'
- LP update query: `UPDATE license_plates SET status = 'shipped' WHERE id IN (SELECT license_plate_id FROM shipment_box_contents WHERE shipment_box_id IN (SELECT id FROM shipment_boxes WHERE shipment_id = :shipment_id))`
- Inventory moves logged (future: integrate with inventory_moves table)

### AC-6: SO Cascade Updates on Ship

**Given** a sales order SO-2025-00456 with 3 lines being shipped
**When** shipment is confirmed as shipped
**Then**:
- sales_orders.status → 'shipped'
- sales_orders.shipped_at → now()
- For each sales_order_line:
  - quantity_shipped = quantity_packed
  - Example: Line 1 (10 ordered, 8 packed) → quantity_shipped = 8
- All pick_lists for this SO: status remains 'completed' (no change)

### AC-7: Mark Delivered (Manager Only)

**Given** a shipment with status='shipped' and user role='Manager'
**When** user clicks "Mark Delivered" button
**Then**:
- shipment.status → 'delivered'
- shipment.delivered_at → now()
- sales_orders.status → 'delivered'
- Success toast: "Shipment SH-2025-00123 marked as delivered"
- Mark Delivered button becomes disabled

### AC-8: Mark Delivered (Permission Denied)

**Given** a shipment with status='shipped' and user role='Picker'
**When** user attempts to mark as delivered
**Then**:
- 403 error: "Insufficient permissions. Manager role required."
- Error toast displayed
- Shipment status remains 'shipped'
- Mark Delivered button is hidden/disabled in UI for non-managers

### AC-9: View Tracking Info

**Given** a shipment with status='shipped', carrier='DHL', tracking_number='1234567890'
**When** user clicks "View Tracking" button
**Then**:
- Tracking dialog displays:
  - Carrier: DHL
  - Tracking Number: 1234567890 (clickable link to carrier site)
  - Status Timeline:
    - ✓ Packed: 2025-12-16 10:30 (by John Doe)
    - ✓ Manifested: 2025-12-16 11:00
    - ✓ Shipped: 2025-12-16 14:00
    - ⏳ In Transit: --
    - ☐ Delivered: --
  - External tracking link: "Track on DHL website" (opens carrier tracking page)

### AC-10: Status Workflow Enforcement

**Given** various shipment states
**When** user attempts invalid status transitions
**Then**:
- packed → shipped (skip manifest): 400 error "Must manifest first"
- pending → shipped: 400 error "Cannot ship unpacked shipment"
- shipped → packed: 400 error "Cannot revert shipped status"
- delivered → shipped: 400 error "Cannot revert delivered status"
- Status state machine enforced in backend validation

### AC-11: Confirmation Dialog Required

**Given** a shipment ready to ship
**When** user clicks "Ship" button
**Then**:
- Confirmation dialog displays with:
  - Title: "Confirm Shipment"
  - Message: "Ship SH-2025-00123 to Customer ABC? This action is irreversible. All inventory will be consumed and the sales order will be marked as shipped."
  - Buttons: "Cancel" (default focus), "Ship" (danger variant)
- On cancel: Dialog closes, no action taken
- On confirm: Ship action executes

### AC-12: Partial Shipment Handling (Future)

**Given** a sales order with partial fulfillment (quantity_packed < quantity_ordered)
**When** shipment is confirmed
**Then**:
- quantity_shipped = quantity_packed (not quantity_ordered)
- Example: 10 ordered, 8 picked/packed → quantity_shipped = 8
- Backorder handling (if implemented): Create backorder record for remaining 2 units
- Note: Full backorder logic is Phase 2 (Story 07.29)

---

## Implementation Notes

### API Endpoints

```typescript
// Manifest shipment (validate SSCC)
POST /api/shipping/shipments/:id/manifest
Auth: Required (Warehouse, Manager, Admin)
Input: None
Output: { success: boolean, shipment: Shipment }
Validation:
  - Shipment status must be 'packed'
  - All shipment_boxes must have non-null sscc
  - Update shipment.status → 'manifested'

// Ship confirmation (irreversible)
POST /api/shipping/shipments/:id/ship
Auth: Required (Warehouse, Manager, Admin)
Input: { confirm: boolean }
Output: { success: boolean, shipment: Shipment }
Validation:
  - Shipment status must be 'manifested' or 'packed' (allow skip for MVP)
  - Update shipment.status → 'shipped', shipped_at → now()
  - Update license_plates.status → 'shipped' (all LPs in box contents)
  - Update sales_orders.status → 'shipped', shipped_at → now()
  - Update sales_order_lines.quantity_shipped = quantity_packed
Business Logic:
  - Transaction: All updates must succeed or rollback
  - LP consumption: Filter LPs via shipment_box_contents join
  - SO lines update: Join through sales_order_lines

// Mark as delivered (Manager+ only)
POST /api/shipping/shipments/:id/mark-delivered
Auth: Required (Manager, Admin)
Input: None
Output: { success: boolean, shipment: Shipment }
Validation:
  - Shipment status must be 'shipped'
  - User role must be Manager or Admin
  - Update shipment.status → 'delivered', delivered_at → now()
  - Update sales_orders.status → 'delivered'

// Get tracking info
GET /api/shipping/shipments/:id/tracking
Auth: Required (Any authenticated)
Input: None
Output: {
  carrier: string,
  tracking_number: string,
  status: string,
  timeline: {
    packed_at: timestamp,
    packed_by: string,
    manifested_at: timestamp,
    shipped_at: timestamp,
    delivered_at: timestamp
  },
  external_url: string
}
Business Logic:
  - Fetch shipment with user details (packed_by, shipped_by)
  - Construct status timeline from timestamps
  - Generate carrier tracking URL (DHL, UPS, DPD templates)
```

### Database

Schema already exists from Story 07.11. Updates needed:

```sql
-- No new tables required

-- Status workflow constraint (optional, can be enforced in code)
ALTER TABLE shipments ADD CONSTRAINT shipments_status_workflow
  CHECK (status IN ('pending', 'packing', 'packed', 'manifested', 'shipped', 'delivered', 'exception'));

-- Index for shipped shipments (performance)
CREATE INDEX idx_shipments_shipped_at ON shipments(shipped_at) WHERE shipped_at IS NOT NULL;

-- Index for delivered shipments (reporting)
CREATE INDEX idx_shipments_delivered_at ON shipments(delivered_at) WHERE delivered_at IS NOT NULL;
```

### Frontend Components

```
apps/frontend/app/(authenticated)/shipping/shipments/[id]/
  page.tsx                               # Shipment detail page (updated)
  components/
    ShipmentActions.tsx                  # NEW: Action buttons (Manifest, Ship, etc.)
    ShipConfirmDialog.tsx                # NEW: Confirmation dialog for ship action
    TrackingDialog.tsx                   # NEW: Tracking timeline display
    TrackingTimeline.tsx                 # NEW: Status timeline with badges/dates
```

### Services

```typescript
// lib/services/shipment-service.ts (extend existing)

export class ShipmentService {
  // ... existing methods from Story 07.11

  static async manifestShipment(shipmentId: string): Promise<Shipment> {
    // Validate all boxes have SSCC
    const boxes = await supabase
      .from('shipment_boxes')
      .select('id, sscc')
      .eq('shipment_id', shipmentId);

    const missingSSCC = boxes.data?.filter(box => !box.sscc);
    if (missingSSCC && missingSSCC.length > 0) {
      throw new Error(`Cannot manifest: ${missingSSCC.length} boxes missing SSCC`);
    }

    // Update shipment status
    const { data, error } = await supabase
      .from('shipments')
      .update({ status: 'manifested' })
      .eq('id', shipmentId)
      .eq('status', 'packed') // Ensure status is packed
      .select()
      .single();

    if (error) throw error;
    return data;
  }

  static async shipShipment(shipmentId: string): Promise<Shipment> {
    const { data: shipment } = await supabase
      .from('shipments')
      .select('*, sales_order_id')
      .eq('id', shipmentId)
      .single();

    if (!shipment) throw new Error('Shipment not found');
    if (shipment.status !== 'manifested' && shipment.status !== 'packed') {
      throw new Error('Shipment must be manifested before shipping');
    }

    // Transaction: Update shipment, LPs, SO, SO lines
    const { data, error } = await supabase.rpc('ship_shipment', {
      p_shipment_id: shipmentId,
      p_shipped_at: new Date().toISOString()
    });

    if (error) throw error;
    return data;
  }

  static async markDelivered(shipmentId: string): Promise<Shipment> {
    const { data, error } = await supabase
      .from('shipments')
      .update({
        status: 'delivered',
        delivered_at: new Date().toISOString()
      })
      .eq('id', shipmentId)
      .eq('status', 'shipped')
      .select()
      .single();

    if (error) throw error;

    // Update SO status to delivered
    await supabase
      .from('sales_orders')
      .update({ status: 'delivered' })
      .eq('id', data.sales_order_id);

    return data;
  }

  static async getTrackingInfo(shipmentId: string): Promise<TrackingInfo> {
    const { data: shipment } = await supabase
      .from('shipments')
      .select(`
        *,
        packed_by_user:users!packed_by(name),
        sales_order:sales_orders(order_number)
      `)
      .eq('id', shipmentId)
      .single();

    if (!shipment) throw new Error('Shipment not found');

    return {
      carrier: shipment.carrier,
      tracking_number: shipment.tracking_number,
      status: shipment.status,
      timeline: {
        packed_at: shipment.packed_at,
        packed_by: shipment.packed_by_user?.name,
        manifested_at: shipment.status === 'manifested' || shipment.status === 'shipped' || shipment.status === 'delivered'
          ? shipment.packed_at // Approximate (no dedicated field)
          : null,
        shipped_at: shipment.shipped_at,
        delivered_at: shipment.delivered_at
      },
      external_url: this.getCarrierTrackingUrl(shipment.carrier, shipment.tracking_number)
    };
  }

  private static getCarrierTrackingUrl(carrier: string | null, trackingNumber: string | null): string | null {
    if (!carrier || !trackingNumber) return null;

    const urls: Record<string, string> = {
      dhl: `https://www.dhl.com/en/express/tracking.html?AWB=${trackingNumber}`,
      ups: `https://www.ups.com/track?tracknum=${trackingNumber}`,
      dpd: `https://tracking.dpd.de/status/en_US/parcel/${trackingNumber}`,
      fedex: `https://www.fedex.com/fedextrack/?tracknumbers=${trackingNumber}`
    };

    return urls[carrier.toLowerCase()] || null;
  }
}
```

### Database Function (RPC for Ship Transaction)

```sql
-- supabase/migrations/YYYYMMDDHHMMSS_ship_shipment_rpc.sql

CREATE OR REPLACE FUNCTION ship_shipment(
  p_shipment_id UUID,
  p_shipped_at TIMESTAMPTZ
) RETURNS shipments AS $$
DECLARE
  v_shipment shipments;
  v_sales_order_id UUID;
BEGIN
  -- Get shipment and SO ID
  SELECT * INTO v_shipment FROM shipments WHERE id = p_shipment_id FOR UPDATE;
  IF NOT FOUND THEN
    RAISE EXCEPTION 'Shipment not found';
  END IF;

  IF v_shipment.status NOT IN ('manifested', 'packed') THEN
    RAISE EXCEPTION 'Shipment must be manifested or packed before shipping';
  END IF;

  v_sales_order_id := v_shipment.sales_order_id;

  -- Update shipment status
  UPDATE shipments
  SET status = 'shipped',
      shipped_at = p_shipped_at
  WHERE id = p_shipment_id;

  -- Consume LPs (update status to 'shipped')
  UPDATE license_plates
  SET status = 'shipped'
  WHERE id IN (
    SELECT DISTINCT license_plate_id
    FROM shipment_box_contents sbc
    INNER JOIN shipment_boxes sb ON sbc.shipment_box_id = sb.id
    WHERE sb.shipment_id = p_shipment_id
  );

  -- Update sales order
  UPDATE sales_orders
  SET status = 'shipped',
      shipped_at = p_shipped_at
  WHERE id = v_sales_order_id;

  -- Update sales order lines (quantity_shipped = quantity_packed)
  UPDATE sales_order_lines
  SET quantity_shipped = quantity_packed
  WHERE sales_order_id = v_sales_order_id;

  -- Return updated shipment
  SELECT * INTO v_shipment FROM shipments WHERE id = p_shipment_id;
  RETURN v_shipment;
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;
```

### Validation (Zod)

```typescript
// lib/validation/shipment-schema.ts (extend existing)

export const manifestShipmentSchema = z.object({
  shipmentId: z.string().uuid()
});

export const shipShipmentSchema = z.object({
  shipmentId: z.string().uuid(),
  confirm: z.boolean().refine(val => val === true, {
    message: 'Confirmation required to ship'
  })
});

export const markDeliveredSchema = z.object({
  shipmentId: z.string().uuid()
});

export const trackingInfoSchema = z.object({
  carrier: z.string().nullable(),
  tracking_number: z.string().nullable(),
  status: z.enum(['pending', 'packing', 'packed', 'manifested', 'shipped', 'delivered', 'exception']),
  timeline: z.object({
    packed_at: z.string().nullable(),
    packed_by: z.string().nullable(),
    manifested_at: z.string().nullable(),
    shipped_at: z.string().nullable(),
    delivered_at: z.string().nullable()
  }),
  external_url: z.string().url().nullable()
});
```

### Key Business Rules

1. **Status Workflow State Machine**:
   - pending → packing → packed → manifested → shipped → delivered
   - Cannot skip states (except manifest is optional for MVP)
   - Cannot revert states (shipped cannot go back to packed)

2. **SSCC Validation (Manifest)**:
   - All shipment_boxes must have non-null sscc before manifesting
   - If any box missing SSCC, manifest fails with error

3. **Ship Action (Irreversible)**:
   - Confirmation required (dialog with explicit warning)
   - Transaction: All updates must succeed or rollback
   - LP consumption: All LPs in shipment_box_contents → status='shipped'
   - SO cascade: status='shipped', shipped_at=now(), quantity_shipped updated

4. **Permission Requirements**:
   - Manifest/Ship: Warehouse, Manager, Admin
   - Mark Delivered: Manager, Admin only
   - View Tracking: Any authenticated user

5. **LP Status Update**:
   - Query: `UPDATE license_plates SET status='shipped' WHERE id IN (SELECT license_plate_id FROM shipment_box_contents WHERE shipment_box_id IN (SELECT id FROM shipment_boxes WHERE shipment_id=:id))`
   - Updates all LPs in all boxes for the shipment

6. **SO Lines Update**:
   - quantity_shipped = quantity_packed (for all lines in the SO)
   - Supports partial shipments (if quantity_packed < quantity_ordered)

7. **Tracking URL Generation**:
   - DHL: `https://www.dhl.com/en/express/tracking.html?AWB={tracking}`
   - UPS: `https://www.ups.com/track?tracknum={tracking}`
   - DPD: `https://tracking.dpd.de/status/en_US/parcel/{tracking}`
   - FedEx: `https://www.fedex.com/fedextrack/?tracknumbers={tracking}`

8. **Carrier API Placeholder**:
   - In manifest endpoint: Comment placeholder for future carrier API call
   - Example: `// TODO (Phase 2): Call carrier.bookShipment() to get tracking number`
   - Manual tracking number entry supported in Story 07.11/07.13

---

## Deliverables

- API routes:
  - POST /api/shipping/shipments/:id/manifest
  - POST /api/shipping/shipments/:id/ship
  - POST /api/shipping/shipments/:id/mark-delivered
  - GET /api/shipping/shipments/:id/tracking

- Services:
  - ShipmentService.manifestShipment()
  - ShipmentService.shipShipment()
  - ShipmentService.markDelivered()
  - ShipmentService.getTrackingInfo()

- Components:
  - ShipmentActions.tsx (action buttons)
  - ShipConfirmDialog.tsx (confirmation dialog)
  - TrackingDialog.tsx (tracking info modal)
  - TrackingTimeline.tsx (status timeline)

- Database:
  - ship_shipment() RPC function
  - Indexes for shipped_at, delivered_at

- Tests:
  - Unit tests for ShipmentService (>80% coverage)
  - E2E test: Pack → Manifest → Ship → Deliver workflow
  - Permission tests (Manager-only mark delivered)
  - Status workflow validation tests

---

## Definition of Done

- [ ] Manifest endpoint validates SSCC presence
- [ ] Manifest endpoint updates status to 'manifested'
- [ ] Ship endpoint requires manifested or packed status
- [ ] Ship endpoint consumes all LPs (status → 'shipped')
- [ ] Ship endpoint updates SO (status, shipped_at, quantity_shipped)
- [ ] Ship endpoint wrapped in transaction (rollback on error)
- [ ] Ship confirmation dialog displayed with warning
- [ ] Mark delivered endpoint restricted to Manager+
- [ ] Mark delivered updates shipment and SO status
- [ ] Tracking endpoint returns timeline and external URL
- [ ] Tracking timeline component displays status badges
- [ ] Action buttons respect status workflow (disabled when invalid)
- [ ] Permission checks enforced (Ship: Warehouse+, Delivered: Manager+)
- [ ] RLS policies verified (org isolation)
- [ ] Unit tests pass (>80% coverage)
- [ ] E2E test: Full ship workflow (pack → manifest → ship → deliver)
- [ ] Permission test: Non-manager cannot mark delivered
- [ ] Status workflow validation tests pass
- [ ] Tracking URL generation tested (DHL, UPS, DPD, FedEx)

---

## Future Phases (Not in This Story)

### Phase 2 (Carrier Integration)
- Carrier API integration (Story 07.25):
  - Call carrier.bookShipment() on manifest
  - Retrieve tracking number automatically
  - Submit BOL to carrier
- Tracking webhooks (Story 07.27):
  - Receive delivery confirmation from carrier
  - Auto-update shipment.status to 'delivered'
  - Handle exceptions (delivery failed, address issue)
- Rate shopping (Story 07.31):
  - Compare carrier rates before manifesting
  - Select best carrier automatically

### Phase 2 (Dock Management)
- Dock door assignment (Story 07.18)
- Load scheduling (Story 07.19)
- Staging location management

### Phase 2 (Advanced Tracking)
- POD upload (Story 07.24)
- Signature capture
- Photo upload for delivered shipments
- GPS tracking integration

### Phase 3 (Optimization)
- Predictive delivery dates (ML)
- Route optimization for multi-stop deliveries
- Real-time shipment visibility dashboard

---

## Version History

| Version | Date | Changes | Author |
|---------|------|---------|--------|
| 1.0 | 2025-12-16 | Initial story | PM-AGENT |
