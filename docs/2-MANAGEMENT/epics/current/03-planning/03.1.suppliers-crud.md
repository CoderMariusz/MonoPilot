# 03.1 - Suppliers CRUD + Master Data

**Priority**: P0 (MVP)
**Story Points**: M (3-4 days)
**Type:** backend + frontend

**State:** ready
**Primary PRD:** `docs/1-BASELINE/product/modules/planning.md` (FR-PLAN-001 to FR-PLAN-004)
**Architecture:** `docs/1-BASELINE/architecture/modules/planning.md`
**UX Wireframes:** PLAN-001 (List), PLAN-002 (Create/Edit), PLAN-003 (Detail)

---

## MVP Scope

This story implements complete supplier master data management (CRUD operations), including:
- Supplier list page with filtering, search, and bulk actions
- Create/edit supplier modal with full validation
- Deactivate/activate suppliers with business rule validation
- Delete suppliers (with constraints)
- RLS for multi-tenancy
- API layer, service layer, and validation schemas

**Out of MVP:** Supplier-product assignments (Story 03.2), supplier quality management (Phase 3), EDI integration (Phase 3).

---

## Goal

Enable procurement teams to manage supplier master data, ensuring all purchase orders can reference valid, active suppliers with correct tax and payment terms.

## User Story

As a **Purchaser**, I want **to create and manage supplier records** so that **I can track vendor information, default payment terms, and ensure accurate purchase order creation**.

## Scope

**In scope (this story)**
- Supplier CRUD operations (create, read, update, delete)
- Supplier list page with KPI cards, filters, search, and pagination
- Create/edit supplier modal with full field validation
- Bulk activate/deactivate suppliers
- Export suppliers to Excel
- RLS policies for multi-tenancy
- Supplier code auto-generation (SUP-001, SUP-002, etc.)
- Active/inactive status management
- Tax code and currency defaults
- Business rules: block deactivation if open POs, block deletion if any POs or products assigned

**Out of scope (this story)**
- Supplier-product assignments with pricing/lead time overrides (Story 03.2)
- Supplier quality ratings and audits (Phase 3)
- Supplier performance analytics (Phase 3)
- EDI integration for supplier data (Phase 3)
- Vendor Managed Inventory (VMI) portal (Phase 3)

## Dependencies

- **01.1** - Organization context + RLS (required for org_id filtering)
- **01.X** - Tax Codes CRUD (required for tax_code_id FK)
- **02.1** - Products (optional - needed for supplier-product validation in Story 03.2)

## Acceptance Criteria (Given/When/Then)

### AC-1: Supplier List Page with KPIs

**Given** I am a logged-in user with Purchaser role
**When** I navigate to `/planning/suppliers`
**Then** I should see:
- 4 KPI cards: Total Suppliers, Active Suppliers, Inactive, This Month Added
- Active rate percentage calculated correctly: (active_count / total_count) * 100
- Supplier table with columns: Code, Name, Contact Name, Email, Phone, Status, Products Count
- Filters: Status (All/Active/Inactive), Currency, Payment Terms, Search
- Pagination controls (desktop/tablet) or "Load More" button (mobile)
- "Create Supplier" and "Import" action buttons

### AC-2: Supplier Code Auto-Generation

**Given** I am creating a new supplier
**When** I open the Create Supplier modal
**Then** I should see:
- Supplier Code field pre-filled with next available code (e.g., SUP-001)
- Checkbox "Enter manually" (unchecked by default)
- When I check "Enter manually", I can override the auto-generated code
- Code must be unique per organization (validated on blur, debounced 500ms)
- Code format: 2-20 alphanumeric characters (A-Z, 0-9, hyphen allowed)

### AC-3: Create Supplier with Required Fields

**Given** I am on the Create Supplier modal
**When** I fill in required fields:
- Supplier Code: SUP-001 (auto or manual)
- Supplier Name: "ACME Foods Ltd"
- Currency: PLN
- Tax Code: VAT23 (23% VAT)
- Payment Terms: "Net 30"
**And** I click "Create Supplier"
**Then** the supplier should be created with:
- Unique UUID `id`
- Current user's `org_id`
- `is_active = true` (default)
- `created_at` and `created_by` auto-populated
- Success toast: "Supplier SUP-001 created successfully"
- Modal closes after 2 seconds
- Supplier list refreshes showing new supplier

### AC-4: Supplier Field Validation

**Given** I am creating or editing a supplier
**When** I enter invalid data:
- Supplier Code: already exists (e.g., duplicate SUP-001)
- Email: invalid format (e.g., "john@acme")
- Payment Terms: empty (required field)
**Then** I should see:
- Red alert banner at top: "Please fix the following errors:"
- Inline field-level errors with ‚ùå icon
- Field borders turn red for invalid inputs
- Specific error messages:
  - "Code already exists in system"
  - "Invalid email format"
  - "Payment terms are required"
- Submit button remains enabled (to allow re-validation on click)

### AC-5: Edit Supplier with Code Locking

**Given** a supplier exists with code SUP-001 and has 3 purchase orders
**When** I click "Edit" on the supplier row
**Then** I should see:
- Pre-filled form with existing supplier data
- Supplier Code field locked (read-only) with üîí icon
- Tooltip: "Cannot change code - supplier has purchase orders"
- All other fields editable (name, email, currency, etc.)
- "Save Changes" button (not "Create Supplier")

**When** I update the name from "ACME Foods Ltd" to "ACME Foods International"
**And** I click "Save Changes"
**Then** the supplier should be updated with:
- Same code (SUP-001)
- New name: "ACME Foods International"
- `updated_at` and `updated_by` auto-populated
- Success toast: "Supplier SUP-001 updated"

### AC-6: Filter Suppliers by Status

**Given** I have 42 suppliers (38 active, 4 inactive)
**When** I select "Active" from the Status filter dropdown
**Then** I should see:
- Only suppliers with `is_active = true`
- KPI cards unchanged (still show totals)
- URL updated: `/planning/suppliers?status=active`
- Filter persists on page refresh

**When** I select "Inactive" from the Status filter
**Then** I should see:
- Only suppliers with `is_active = false`
- "Activate Selected" bulk action enabled (not "Deactivate Selected")

### AC-7: Search Suppliers

**Given** I am on the supplier list page
**When** I type "Mill" in the search box
**Then** I should see:
- Debounced search (300ms delay)
- Suppliers matching "Mill" in `code`, `name`, `contact_name`, `email`, or `phone`
- e.g., "Mill Co." (name match) or "SUP-001" (if code contains "Mill")
- URL updated: `/planning/suppliers?search=Mill`

**When** I clear the search box
**Then** I should see all suppliers again

### AC-8: Deactivate Supplier (Success)

**Given** I have a supplier SUP-005 with no open purchase orders
**When** I select the supplier checkbox
**And** I click "Deactivate Selected"
**Then** I should see:
- Confirmation modal: "Are you sure? This will prevent new POs from being created for this supplier."
- "Cancel" and "Deactivate" buttons

**When** I click "Deactivate"
**Then** the supplier should be updated:
- `is_active = false`
- Supplier hidden from PO supplier dropdowns
- Success toast: "Supplier SUP-005 deactivated successfully"
- Supplier list refreshes, status badge shows "Inactive"

### AC-9: Block Deactivation if Open POs

**Given** I have a supplier SUP-001 with 3 open purchase orders
**When** I select the supplier checkbox
**And** I click "Deactivate Selected"
**Then** I should see:
- Error modal: "Cannot deactivate supplier with 3 open purchase orders. Close or cancel POs first."
- No changes made to supplier
- Supplier remains active

### AC-10: Activate Inactive Supplier

**Given** I have an inactive supplier SUP-006
**When** I filter by "Inactive" status
**And** I select the supplier checkbox
**And** I click "Activate Selected"
**Then** the supplier should be updated:
- `is_active = true`
- Supplier appears in PO supplier dropdowns
- Success toast: "Supplier SUP-006 activated successfully"

### AC-11: Delete Supplier (Success)

**Given** I have a supplier SUP-999 with:
- 0 purchase orders
- 0 products assigned
**When** I click the row actions menu [...]
**And** I click "Delete"
**Then** I should see:
- Confirmation modal: "Are you sure? This action cannot be undone."
- Warning: "This will permanently delete the supplier."

**When** I confirm deletion
**Then** the supplier should be:
- Permanently deleted from database
- Removed from supplier list
- Success toast: "Supplier SUP-999 deleted successfully"

### AC-12: Block Deletion if POs Exist

**Given** I have a supplier SUP-001 with 5 purchase orders (3 open, 2 closed)
**When** I attempt to delete the supplier
**Then** I should see:
- Error message: "Cannot delete supplier with existing purchase orders"
- Details: "This supplier has 5 purchase orders (3 open, 2 closed)"
- Suggestion: "Deactivate the supplier instead"
- No deletion occurs

### AC-13: Block Deletion if Products Assigned

**Given** I have a supplier SUP-002 with:
- 0 purchase orders
- 8 products assigned (via supplier_products table)
**When** I attempt to delete the supplier
**Then** I should see:
- Error message: "Cannot delete supplier with assigned products"
- Details: "This supplier has 8 products assigned"
- Suggestion: "Remove product assignments first"
- No deletion occurs

### AC-14: Bulk Deactivate Mixed Results

**Given** I have selected 3 suppliers:
- SUP-001: Has 2 open POs (should fail)
- SUP-002: No open POs (should succeed)
- SUP-003: No open POs (should succeed)
**When** I click "Deactivate Selected"
**And** I confirm the bulk action
**Then** I should see:
- Success toast: "2 suppliers deactivated, 1 failed"
- Detailed results modal:
  - SUP-002: ‚úì Deactivated
  - SUP-003: ‚úì Deactivated
  - SUP-001: ‚ùå Failed - "Cannot deactivate supplier with 2 open purchase orders"
- Supplier list refreshes with updated statuses

### AC-15: Export Suppliers to Excel

**Given** I have selected 2 suppliers (SUP-001, SUP-002)
**When** I click "Export to Excel"
**Then** I should:
- Receive an Excel file download (`.xlsx` format)
- File name: `suppliers_export_2025-12-16.xlsx`
- Sheet 1: Supplier master data (all fields)
- Sheet 2: Assigned products count per supplier
- Sheet 3: Summary statistics (total, active, inactive)
- Export completes in <2 seconds for 100 suppliers

### AC-16: RLS Policy Enforcement

**Given** I am logged in as Org A user
**When** I view the supplier list
**Then** I should only see suppliers where `org_id = Org A`

**Given** another user is logged in as Org B user
**When** they view the supplier list
**Then** they should only see suppliers where `org_id = Org B`

**And** they should NOT see Org A's suppliers
**And** they cannot create/update/delete Org A's suppliers via API

### AC-17: Supplier Detail Page Navigation

**Given** I am on the supplier list page
**When** I click "View Details" on a supplier row
**Then** I should navigate to `/planning/suppliers/[id]`
**And** I should see:
- Supplier master data (read-only view)
- Assigned products table (Story 03.2)
- Purchase order history (if any)
- Edit and Deactivate buttons

### AC-18: Responsive Design

**Given** I am viewing the supplier list on mobile (<768px)
**Then** I should see:
- Card layout (not table)
- Each supplier displayed as a vertical card
- KPI cards stacked vertically
- Filters in bottom sheet modal
- "Load More" button (not numbered pagination)
- Swipe left on card to reveal quick actions

**Given** I am viewing on desktop (>1024px)
**Then** I should see:
- Full table with all columns
- 4 KPI cards in horizontal row
- Filters bar above table
- Numbered pagination (1, 2, 3, Next)
- Hover states on rows

### AC-X: Future Features (Phase 1+)

Features deferred to Phase 1+:
- **Supplier-Product Assignments** (Story 03.2) - Link products to suppliers with pricing, lead time, MOQ overrides
- **Supplier Templates** (Phase 2) - Save supplier templates for quick creation
- **Supplier Quality Ratings** (Phase 3) - 1-5 star ratings, audit dates, approved supplier list (ASL)
- **Supplier Performance Analytics** (Phase 3) - On-time delivery %, quality score, cost trends
- **EDI Integration** (Phase 3) - Automatic supplier data sync via EDIFACT

**Implementation**: Per Epic 03.0 guidance, hide or show as "Coming Soon" in UI.

---

## Implementation Notes

### API Endpoints

```typescript
// List suppliers with filters and pagination
GET /api/planning/suppliers
Query Params:
  - status?: 'all' | 'active' | 'inactive'
  - currency[]?: string[]  // ['PLN', 'EUR']
  - payment_terms?: string
  - search?: string  // searches code, name, contact_name, email, phone
  - page?: number (default 1)
  - limit?: number (default 20)
  - sort?: string (default 'code')
  - order?: 'asc' | 'desc' (default 'asc')

Response: {
  success: true,
  data: Supplier[],
  meta: {
    total: number,
    page: number,
    limit: number,
    pages: number
  }
}

// Get supplier summary KPIs
GET /api/planning/suppliers/summary

Response: {
  success: true,
  data: {
    total_count: number,
    active_count: number,
    inactive_count: number,
    active_rate: number,  // percentage
    this_month_count: number
  }
}

// Create supplier
POST /api/planning/suppliers
Body: {
  code: string,  // SUP-001 or manual
  name: string,
  contact_name?: string,
  contact_email?: string,
  contact_phone?: string,
  address?: string,
  city?: string,
  postal_code?: string,
  country?: string,  // ISO 3166-1 alpha-2
  currency: 'PLN' | 'EUR' | 'USD' | 'GBP',
  tax_code_id: string,  // UUID
  payment_terms: string,  // REQUIRED
  notes?: string,
  is_active: boolean
}

Response: {
  success: true,
  data: Supplier
}

// Update supplier
PUT /api/planning/suppliers/:id
Body: Same as POST (code immutable if has POs)

Response: {
  success: true,
  data: Supplier
}

// Delete supplier
DELETE /api/planning/suppliers/:id

Response: {
  success: true,
  data: { id: string, message: string }
}

Errors:
- 400 SUPPLIER_HAS_PURCHASE_ORDERS if po_count > 0
- 400 SUPPLIER_HAS_PRODUCTS if products_count > 0

// Bulk deactivate
POST /api/planning/suppliers/bulk-deactivate
Body: {
  supplier_ids: string[],
  reason?: string
}

Response: {
  success: true,
  data: {
    deactivated_count: number,
    failed_count: number,
    results: Array<{
      id: string,
      status: 'deactivated' | 'failed',
      error?: string
    }>
  }
}

// Bulk activate
POST /api/planning/suppliers/bulk-activate
Body: {
  supplier_ids: string[]
}

Response: {
  success: true,
  data: {
    activated_count: number,
    failed_count: number,
    results: Array<{
      id: string,
      status: 'activated' | 'failed',
      error?: string
    }>
  }
}

// Export to Excel
POST /api/planning/suppliers/export
Body: {
  supplier_ids?: string[],  // if empty, export all
  format: 'xlsx',
  include_products: boolean,
  include_purchase_history: boolean
}

Response: Binary file download (application/vnd.openxmlformats-officedocument.spreadsheetml.sheet)

// Get next available supplier code
GET /api/planning/suppliers/next-code

Response: {
  success: true,
  data: { code: 'SUP-001' }
}

// Validate supplier code uniqueness
GET /api/planning/suppliers/validate-code?code=SUP-001

Response: {
  success: true,
  data: { available: boolean }
}
```

### Database

**Table: suppliers**

```sql
-- Reference: apps/frontend/lib/supabase/migrations/025_create_suppliers_table.sql

CREATE TABLE suppliers (
  id                  UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  org_id              UUID NOT NULL REFERENCES organizations(id),
  code                TEXT NOT NULL,
  name                TEXT NOT NULL,
  address             TEXT,
  city                TEXT,
  postal_code         TEXT,
  country             TEXT,  -- ISO 3166-1 alpha-2
  contact_name        TEXT,
  contact_email       TEXT,
  contact_phone       TEXT,
  currency            TEXT DEFAULT 'PLN',  -- PLN, EUR, USD, GBP
  tax_code_id         UUID REFERENCES tax_codes(id),
  payment_terms       TEXT NOT NULL,  -- REQUIRED
  notes               TEXT,
  is_active           BOOLEAN DEFAULT true,

  -- Phase 3 fields (nullable for now)
  approved_supplier   BOOLEAN DEFAULT false,
  supplier_rating     DECIMAL(3,2),  -- 1-5 score
  last_audit_date     DATE,
  next_audit_due      DATE,

  -- Audit fields
  created_at          TIMESTAMPTZ DEFAULT now(),
  updated_at          TIMESTAMPTZ DEFAULT now(),
  created_by          UUID REFERENCES users(id),
  updated_by          UUID REFERENCES users(id),

  UNIQUE(org_id, code)
);

-- Indexes
CREATE INDEX idx_suppliers_org_active ON suppliers(org_id, is_active, created_at DESC);
CREATE INDEX idx_suppliers_org_code ON suppliers(org_id, code);
CREATE INDEX idx_suppliers_org_name ON suppliers(org_id, name);
CREATE INDEX idx_suppliers_tax_code ON suppliers(tax_code_id);

-- RLS Policies
ALTER TABLE suppliers ENABLE ROW LEVEL SECURITY;

CREATE POLICY suppliers_org_isolation ON suppliers
  FOR ALL
  USING (org_id = current_setting('app.current_org_id')::uuid);

-- Trigger for updated_at
CREATE TRIGGER suppliers_updated_at
  BEFORE UPDATE ON suppliers
  FOR EACH ROW
  EXECUTE FUNCTION update_updated_at_column();
```

**Migration Notes:**
- Lead time and MOQ removed from supplier table (moved to products table per ADR-010)
- Payment terms is NOT NULL (required field)
- Unique constraint on (org_id, code) enforces code uniqueness per org
- RLS policy filters all queries by current user's org_id

### Frontend Components

```
app/(authenticated)/planning/suppliers/
  page.tsx                      // List page (PLAN-001)
  [id]/page.tsx                 // Detail page (PLAN-003)

components/planning/suppliers/
  SupplierListTable.tsx         // Main table with filters, KPIs
  SupplierListKPIs.tsx          // 4 KPI cards
  SupplierFilters.tsx           // Status, Currency, Payment Terms, Search
  SupplierCreateEditModal.tsx   // Create/Edit modal (PLAN-002)
  SupplierDeleteModal.tsx       // Delete confirmation
  SupplierBulkActions.tsx       // Deactivate, Activate, Export
  SupplierRow.tsx               // Table row component
  SupplierCard.tsx              // Mobile card component
```

### Services

```typescript
// lib/services/supplier-service.ts

export async function listSuppliers(params: {
  status?: 'all' | 'active' | 'inactive';
  currency?: string[];
  payment_terms?: string;
  search?: string;
  page?: number;
  limit?: number;
  sort?: string;
  order?: 'asc' | 'desc';
}): Promise<{ data: Supplier[]; meta: PaginationMeta }> {
  // Implementation with Supabase query + RLS
}

export async function getSupplierSummary(): Promise<SupplierSummary> {
  // Aggregate query for KPIs
}

export async function createSupplier(data: CreateSupplierDto): Promise<Supplier> {
  // Validate, generate code if auto, insert with org_id
}

export async function updateSupplier(id: string, data: UpdateSupplierDto): Promise<Supplier> {
  // Validate code immutability, update with updated_by
}

export async function deleteSupplier(id: string): Promise<void> {
  // Check for POs and products, throw error if found
}

export async function bulkDeactivateSuppliers(
  ids: string[],
  reason?: string
): Promise<BulkActionResult> {
  // Check each supplier for open POs, deactivate if none
}

export async function bulkActivateSuppliers(ids: string[]): Promise<BulkActionResult> {
  // Set is_active = true for all inactive suppliers
}

export async function exportSuppliersToExcel(params: {
  supplier_ids?: string[];
  include_products?: boolean;
  include_purchase_history?: boolean;
}): Promise<Blob> {
  // Generate Excel using exceljs or similar
}

export async function getNextSupplierCode(): Promise<string> {
  // Query max code, increment numeric part, return SUP-XXX
}

export async function validateSupplierCode(code: string): Promise<boolean> {
  // Check uniqueness within org
}

export async function canDeactivateSupplier(id: string): Promise<ValidationResult> {
  // Check for open POs
}

export async function canDeleteSupplier(id: string): Promise<ValidationResult> {
  // Check for any POs or products
}
```

### Validation (Zod)

```typescript
// lib/validation/supplier-schema.ts

import { z } from 'zod';

export const supplierSchema = z.object({
  code: z
    .string()
    .min(2, 'Code must be at least 2 characters')
    .max(20, 'Code must be at most 20 characters')
    .regex(/^[A-Z0-9-]+$/, 'Code must contain only uppercase letters, numbers, and hyphens'),
  name: z
    .string()
    .min(2, 'Name must be at least 2 characters')
    .max(100, 'Name must be at most 100 characters'),
  contact_name: z
    .string()
    .max(100, 'Contact name must be at most 100 characters')
    .optional()
    .or(z.literal('')),
  contact_email: z
    .string()
    .email('Invalid email format')
    .optional()
    .or(z.literal('')),
  contact_phone: z
    .string()
    .max(50, 'Phone must be at most 50 characters')
    .optional(),
  address: z
    .string()
    .max(200, 'Address must be at most 200 characters')
    .optional(),
  city: z
    .string()
    .max(100, 'City must be at most 100 characters')
    .optional(),
  postal_code: z
    .string()
    .max(20, 'Postal code must be at most 20 characters')
    .optional(),
  country: z
    .string()
    .length(2, 'Country must be ISO 3166-1 alpha-2 code')
    .optional(),
  currency: z.enum(['PLN', 'EUR', 'USD', 'GBP'], {
    required_error: 'Currency is required',
  }),
  tax_code_id: z
    .string()
    .uuid('Invalid tax code'),
  payment_terms: z
    .string()
    .min(1, 'Payment terms are required')
    .max(100, 'Payment terms must be at most 100 characters'),
  notes: z
    .string()
    .max(1000, 'Notes must be at most 1000 characters')
    .optional(),
  is_active: z
    .boolean()
    .default(true),
});

export type SupplierFormData = z.infer<typeof supplierSchema>;

export const createSupplierSchema = supplierSchema;

export const updateSupplierSchema = supplierSchema.partial({
  code: true,  // Code optional in update (may be locked)
});
```

### Key Business Rules

1. **Supplier Code Uniqueness**: Code must be unique per organization (enforced by UNIQUE constraint on (org_id, code))
2. **Code Immutability**: Cannot change code if supplier has any purchase orders (prevents broken FK references)
3. **Deactivation Rule**: Cannot deactivate supplier with open purchase orders (status NOT IN ('closed', 'cancelled'))
4. **Deletion Rule**: Cannot delete supplier if:
   - Has ANY purchase orders (open or closed)
   - Has ANY products assigned (via supplier_products table)
5. **Currency Cascade**: Supplier's currency becomes default for new purchase orders
6. **Tax Code Cascade**: Supplier's tax code becomes default for PO tax calculations
7. **Active Status**: Inactive suppliers hidden from PO supplier dropdowns but existing POs unaffected
8. **RLS Enforcement**: All queries filtered by org_id from session context
9. **Payment Terms Required**: NOT NULL constraint in DB, must validate on create/update
10. **Auto-Code Generation**: Format SUP-XXX where XXX is zero-padded 3-digit sequence (SUP-001, SUP-002, ..., SUP-999, SUP-1000)

---

## Deliverables

- **API routes**:
  - `GET /api/planning/suppliers` (list with filters)
  - `GET /api/planning/suppliers/summary` (KPIs)
  - `GET /api/planning/suppliers/next-code` (auto-generation)
  - `GET /api/planning/suppliers/validate-code` (uniqueness check)
  - `POST /api/planning/suppliers` (create)
  - `PUT /api/planning/suppliers/:id` (update)
  - `DELETE /api/planning/suppliers/:id` (delete)
  - `POST /api/planning/suppliers/bulk-deactivate` (bulk action)
  - `POST /api/planning/suppliers/bulk-activate` (bulk action)
  - `POST /api/planning/suppliers/export` (Excel export)

- **Components**:
  - `SupplierListTable.tsx` (main table)
  - `SupplierListKPIs.tsx` (4 KPI cards)
  - `SupplierFilters.tsx` (filters bar)
  - `SupplierCreateEditModal.tsx` (modal form)
  - `SupplierDeleteModal.tsx` (confirmation)
  - `SupplierBulkActions.tsx` (bulk action bar)
  - `SupplierRow.tsx` (table row)
  - `SupplierCard.tsx` (mobile card)

- **Services**:
  - `lib/services/supplier-service.ts` (all CRUD + business logic)

- **Validation**:
  - `lib/validation/supplier-schema.ts` (Zod schemas)

- **Tests**:
  - Unit tests: Zod schema validation, business rule functions
  - Integration tests: API endpoint tests with RLS verification
  - E2E tests: Playwright tests for create, edit, delete, bulk actions

---

## Definition of Done

- [ ] All 10 API endpoints implemented and tested
- [ ] Supplier list page with KPIs, filters, search, pagination (responsive)
- [ ] Create/edit modal with full validation (PLAN-002 wireframe)
- [ ] Bulk activate/deactivate with mixed result handling
- [ ] Excel export with 3 sheets (master data, products, summary)
- [ ] Delete validation (block if POs or products exist)
- [ ] RLS policies enforced (org_id filtering on all queries)
- [ ] Supplier code auto-generation (SUP-001 format)
- [ ] Code uniqueness validation (debounced 500ms)
- [ ] Code immutability if supplier has POs (locked field in edit mode)
- [ ] Zod validation schemas with all field rules
- [ ] Service layer with business logic (canDeactivate, canDelete)
- [ ] API tests passing (>80% coverage)
- [ ] E2E smoke test for critical path:
  - Create supplier ‚Üí View in list ‚Üí Edit supplier ‚Üí Deactivate ‚Üí Activate ‚Üí Delete (if no POs)
- [ ] Performance: List page loads in <500ms (P95)
- [ ] Performance: Export 100 suppliers in <2s
- [ ] Performance: Search debounced at 300ms
- [ ] Performance: Code uniqueness check <200ms
- [ ] Mobile responsive (card layout, load more button)
- [ ] Accessibility: WCAG AA compliance (contrast, touch targets 48x48dp, keyboard nav, ARIA)
- [ ] Documentation: API docs updated, inline comments for business rules

---

## Future Phases (Not in MVP)

### Phase 1
- **Supplier-Product Assignments** (Story 03.2) - Link products to suppliers with pricing, lead time, MOQ overrides
- **Supplier Templates** - Save supplier templates for quick creation of similar vendors
- **Bulk Import from Excel** - Upload Excel file with supplier data validation

### Phase 2
- **Supplier Performance Dashboard** - On-time delivery %, quality metrics, cost trends
- **Supplier Comparison Tool** - Compare multiple suppliers for a product
- **Supplier Communication Log** - Track emails, calls, meetings

### Phase 3
- **Supplier Quality Management** - Audit dates, quality ratings (1-5 stars), Approved Supplier List (ASL)
- **EDI Integration** - Automatic supplier data sync via EDIFACT
- **Vendor Managed Inventory (VMI)** - Supplier portal for inventory visibility

**Implementation**: See Epic 03.0 "Future Feature Handling" section.

---

## Version History

| Version | Date | Changes | Author |
|---------|------|---------|--------|
| 1.0 | 2025-12-16 | Initial story creation | ARCHITECT-AGENT |
